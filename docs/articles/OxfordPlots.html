<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Whole-genome dot-plots â€¢ OikScrambling</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Whole-genome dot-plots">
<meta property="og:description" content="OikScrambling">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">OikScrambling</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">4.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/OikScrambling.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/CNEs.html">Conserved non-coding elements</a>
    </li>
    <li>
      <a href="../articles/ChromosomePlots.html">Chromosome-scale feature density plots</a>
    </li>
    <li>
      <a href="../articles/CoalescingCutoffs.html">Modifying coalescent cutoffs</a>
    </li>
    <li>
      <a href="../articles/ColinearityInterruptors.html">Regions interrupting colinearity</a>
    </li>
    <li>
      <a href="../articles/DistanceMeasures.html">Distance Measures</a>
    </li>
    <li>
      <a href="../articles/GenomicFeatures.html">Genomic features of the breakpoints</a>
    </li>
    <li>
      <a href="../articles/Inversions.html">Inversions</a>
    </li>
    <li>
      <a href="../articles/LoadGenomicBreaks.html">Load genomic break data</a>
    </li>
    <li>
      <a href="../articles/OrthogroupSyntenies.html">Orthogroup syntenies</a>
    </li>
    <li>
      <a href="../articles/OxfordPlots.html">Whole-genome dot-plots</a>
    </li>
    <li>
      <a href="../articles/PAC3.html">Region of interest: PAC3</a>
    </li>
    <li>
      <a href="../articles/PWM.html">Motif search and analysis</a>
    </li>
    <li>
      <a href="../articles/ParallelPlots.html">Whole-chromosome parallel plots</a>
    </li>
    <li>
      <a href="../articles/RegionWidths.html">Width of the aligned and mapped regions.</a>
    </li>
    <li>
      <a href="../articles/RegionsOfInterest.html">Regions of interest</a>
    </li>
    <li>
      <a href="../articles/RepeatRegions.html">Repeat regions</a>
    </li>
    <li>
      <a href="../articles/SegmentMovements.html">Segment movement distances</a>
    </li>
    <li>
      <a href="../articles/TFBS.html">Transcription factor binding sites</a>
    </li>
    <li>
      <a href="../articles/TandemSiteDuplications.html">Tandem site duplications</a>
    </li>
    <li>
      <a href="../articles/Translocations.html">Translocations</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/oist/LuscombeU_OikScrambling/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="OxfordPlots_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Whole-genome dot-plots</h1>
                        <h4 data-toc-skip class="author">Charles Plessy</h4>
            
            <h4 data-toc-skip class="date">14 December, 2022</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/oist/LuscombeU_OikScrambling/blob/HEAD/vignettes/OxfordPlots.Rmd" class="external-link"><code>vignettes/OxfordPlots.Rmd</code></a></small>
      <div class="hidden name"><code>OxfordPlots.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_knit.html" class="external-link">opts_knit</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>cache <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette produces alignment line plots of pairs of genomes to illustrate differences in the extent of scrambling in <em>Oikopleura</em> compared to equivalent pairs in other genera.</p>
<p>The core functions used here are maintained in our <em>GenomicBreaks</em> R package, which is fully documented at: <a href="https://oist.github.io/GenomicBreaks" class="external-link uri">https://oist.github.io/GenomicBreaks</a>.</p>
<p>See <code><a href="../articles/ParallelPlots.html">vignette("ParallelPlots", package = "OikScrambling")</a></code> for parallel comparisons of homologous chromosomes in more than one species.</p>
<div class="section level3">
<h3 id="load-pacakges">Load pacakges<a class="anchor" aria-label="anchor" href="#load-pacakges"></a>
</h3>
</div>
</div>
<div class="section level2">
<h2 id="load-r-pacakges-and-data">Load R pacakges and data<a class="anchor" aria-label="anchor" href="#load-r-pacakges-and-data"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/oist/LuscombeU_OikScrambling" class="external-link">'OikScrambling'</a></span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">genomes</span> <span class="op">&lt;-</span> <span class="fu">OikScrambling</span><span class="fu">:::</span><span class="fu"><a href="../reference/loadAllGenomes.html">loadAllGenomes</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"BreakPoints.Rdata"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="oikopleura">Oikopleura<a class="anchor" aria-label="anchor" href="#oikopleura"></a>
</h2>
<div class="section level3">
<h3 id="oki-vs-bar">Oki vs Bar<a class="anchor" aria-label="anchor" href="#oki-vs-bar"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">makeOxfordPlots</span><span class="op">(</span><span class="va">coa</span><span class="op">$</span><span class="va">Oki_Bar</span>, diag <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Oki_Bar_all-1.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># stringDist_GBreaks &lt;- function(x, method = "levenshtein", ignoreCase = FALSE, diag = FALSE, upper = FALSE, ...) {</span>
<span class="co">#   targetS &lt;- getSeq(x)</span>
<span class="co">#   queryS  &lt;- getSeq(x$query)</span>
<span class="co">#   seqs &lt;- Pairs(targetS, queryS)</span>
<span class="co">#   sapply(seqs, \(pair){</span>
<span class="co">#     stringDist(c(first(pair), second(pair)))</span>
<span class="co">#   })</span>
<span class="co"># }</span>

<span class="va">mkOxPlotWindow</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">gb</span>, <span class="va">win</span> <span class="op">=</span> <span class="fl">5e6</span>, <span class="va">size</span> <span class="op">=</span> <span class="fl">2</span>, <span class="va">centre</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'midpoint'</span>, <span class="st">'maxwidth'</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">centre</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.arg.html" class="external-link">match.arg</a></span><span class="op">(</span><span class="va">centre</span><span class="op">)</span>
  <span class="va">gb</span> <span class="op">&lt;-</span> <span class="fu">forceSeqLengths</span><span class="op">(</span><span class="va">gb</span><span class="op">)</span>
  <span class="va">longest_target_seq</span> <span class="op">&lt;-</span> <span class="fu">seqlengths</span><span class="op">(</span><span class="va">gb</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="op">)</span>
  <span class="va">best_query_match</span>   <span class="op">&lt;-</span> <span class="va">gb</span><span class="op">[</span><span class="fu">seqnames</span><span class="op">(</span><span class="va">gb</span><span class="op">)</span> <span class="op">==</span> <span class="va">longest_target_seq</span><span class="op">]</span><span class="op">$</span><span class="va">query</span> |&gt; <span class="fu">seqnames</span><span class="op">(</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="op">)</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">centre</span> <span class="op">==</span> <span class="st">'midpoint'</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">target_centre</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu">seqlengths</span><span class="op">(</span><span class="va">gb</span><span class="op">)</span><span class="op">[</span><span class="va">longest_target_seq</span><span class="op">]</span>     <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>
    <span class="va">query_centre</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu">seqlengths</span><span class="op">(</span><span class="va">gb</span><span class="op">$</span><span class="va">query</span><span class="op">)</span><span class="op">[</span><span class="va">best_query_match</span><span class="op">]</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>
  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
    <span class="va">gb_coa</span> <span class="op">&lt;-</span> <span class="fu">coalesce_contigs</span><span class="op">(</span><span class="va">gb</span><span class="op">)</span>
    <span class="va">maxwidth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="fu">width</span><span class="op">(</span><span class="va">gb_coa</span><span class="op">)</span><span class="op">)</span>
    <span class="va">target_centre</span> <span class="op">&lt;-</span> <span class="va">gb_coa</span><span class="op">[</span><span class="va">maxwidth</span><span class="op">]</span>       |&gt; <span class="fu">resize</span><span class="op">(</span><span class="fl">1</span>, fix <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/stats/start.html" class="external-link">start</a></span><span class="op">(</span><span class="op">)</span>
    <span class="va">query_centre</span>  <span class="op">&lt;-</span> <span class="va">gb_coa</span><span class="op">$</span><span class="va">query</span><span class="op">[</span><span class="va">maxwidth</span><span class="op">]</span> |&gt; <span class="fu">resize</span><span class="op">(</span><span class="fl">1</span>, fix <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/stats/start.html" class="external-link">start</a></span><span class="op">(</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="va">gb</span> <span class="op">&lt;-</span> <span class="va">gb</span> |&gt; <span class="fu">plyranges</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyranges/man/tidyverse-reexports.html" class="external-link">filter</a></span><span class="op">(</span>
    <span class="va">seqnames</span> <span class="op">==</span> <span class="va">longest_target_seq</span>,
    <span class="fu">seqnames</span><span class="op">(</span><span class="va">query</span><span class="op">)</span> <span class="op">==</span> <span class="va">best_query_match</span>,
    <span class="va">start</span> <span class="op">&gt;</span> <span class="va">target_centre</span> <span class="op">-</span> <span class="va">win</span>,
    <span class="va">end</span> <span class="op">&lt;</span> <span class="va">target_centre</span> <span class="op">+</span> <span class="va">win</span>,
    <span class="fu"><a href="https://rdrr.io/r/stats/start.html" class="external-link">start</a></span><span class="op">(</span><span class="va">query</span><span class="op">)</span> <span class="op">&gt;</span> <span class="va">query_centre</span> <span class="op">-</span> <span class="va">win</span>,
    <span class="fu"><a href="https://rdrr.io/r/stats/start.html" class="external-link">end</a></span><span class="op">(</span><span class="va">query</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">query_centre</span> <span class="op">+</span> <span class="va">win</span>
  <span class="op">)</span>
  <span class="co"># score(gb) &lt;- stringDist_GBreaks(gb) / width(gb)</span>
  <span class="fu">makeOxfordPlots</span><span class="op">(</span><span class="va">gb</span>, col <span class="op">=</span> <span class="st">"strand"</span>, size <span class="op">=</span> <span class="va">size</span>, <span class="va">...</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">theme</span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">mkOxPlotWindow</span><span class="op">(</span><span class="va">gbs</span><span class="op">$</span><span class="va">Oki_Bar</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Oki_Bar_win-1.svg" width="700"></p>
</div>
<div class="section level3">
<h3 id="oki-vs-osa">Oki vs Osa<a class="anchor" aria-label="anchor" href="#oki-vs-osa"></a>
</h3>
<p>Dot plot intended for panel A of figure 1.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">makeOxfordPlots</span><span class="op">(</span><span class="va">coa</span><span class="op">$</span><span class="va">Oki_Osa</span>, diag <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme</span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Oki_Osa-1.png" width="700"></p>
<p>The plot below is based on aligned regions (before coalescing). It is displayed to demonstrate that it is visually similar to the one above made on mapped regions (object after coalescing).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">makeOxfordPlots</span><span class="op">(</span><span class="va">gbs</span><span class="op">$</span><span class="va">Oki_Osa</span>, diag <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E78CC4"</span>, <span class="st">"#B2D659"</span>, <span class="st">"#FFDA39"</span>, <span class="st">"#8EA2C6"</span>, <span class="st">"#69BEA4"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">theme</span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Oki_Osa_gbs-1.png" width="700"></p>
<p>Oxford plot colored by strand.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">makeOxfordPlots</span><span class="op">(</span><span class="va">coa</span><span class="op">$</span><span class="va">Oki_Osa</span>, diag <span class="op">=</span> <span class="cn">FALSE</span>, col <span class="op">=</span> <span class="st">"strand"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme</span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"none"</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Oki_Osa_strand-1.png" width="700"></p>
<p>10-Mb square window plot.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">mkOxPlotWindow</span><span class="op">(</span><span class="va">gbs</span><span class="op">$</span><span class="va">Oki_Osa</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Oki_Osa_win-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="osa-vs-bar">Osa vs Bar<a class="anchor" aria-label="anchor" href="#osa-vs-bar"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">makeOxfordPlots</span><span class="op">(</span><span class="va">coa</span><span class="op">$</span><span class="va">Osa_Bar</span>, diag <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Osa_bar-1.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">mkOxPlotWindow</span><span class="op">(</span><span class="va">gbs</span><span class="op">$</span><span class="va">Osa_Bar</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Osa_Bar_win-1.svg" width="700"></p>
</div>
<div class="section level3">
<h3 id="osa-vs-oki">Osa vs Oki<a class="anchor" aria-label="anchor" href="#osa-vs-oki"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">makeOxfordPlots</span><span class="op">(</span><span class="va">coa</span><span class="op">$</span><span class="va">Osa_Oki</span>, diag <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Osa_Oki-1.png" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">mkOxPlotWindow</span><span class="op">(</span><span class="va">gbs</span><span class="op">$</span><span class="va">Osa_Oki</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Osa_Oki_win-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="osa-vs-aom">Osa vs Aom<a class="anchor" aria-label="anchor" href="#osa-vs-aom"></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">makeOxfordPlots</span><span class="op">(</span><span class="va">coa</span><span class="op">$</span><span class="va">Osa_Aom</span>, diag <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Osa_Aom-1.png" width="700"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Osa_Aom_PAR</span> <span class="op">&lt;-</span> <span class="va">gbs</span><span class="op">$</span><span class="va">Osa_Aom</span> |&gt; <span class="fu">plyranges</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyranges/man/tidyverse-reexports.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">seqnames</span> <span class="op">==</span> <span class="st">"PAR"</span><span class="op">)</span>
<span class="fu">seqlevels</span><span class="op">(</span><span class="va">Osa_Aom_PAR</span><span class="op">)</span>       <span class="op">&lt;-</span> <span class="fu">seqlevelsInUse</span><span class="op">(</span><span class="va">Osa_Aom_PAR</span><span class="op">)</span>
<span class="fu">seqlevels</span><span class="op">(</span><span class="va">Osa_Aom_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">seqlevelsInUse</span><span class="op">(</span><span class="va">Osa_Aom_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span>

<span class="fu">makeOxfordPlots</span><span class="op">(</span><span class="va">Osa_Aom_PAR</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Osa_Aom_win_prepare-1.png" width="700"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Let's remove the contigs that have their main match elsewhere.</span>
<span class="va">QTcoverage</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">gb</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu">seqlevels</span><span class="op">(</span><span class="va">gb</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># Not ready for full objects</span>
  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="fu">seqlengths</span><span class="op">(</span><span class="va">gb</span><span class="op">$</span><span class="va">query</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  <span class="va">grl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">gb</span>, <span class="fu">seqnames</span><span class="op">(</span><span class="va">gb</span><span class="op">$</span><span class="va">query</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">grl</span>, \<span class="op">(</span><span class="va">gb</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">width</span><span class="op">(</span><span class="va">gb</span><span class="op">$</span><span class="va">query</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span> <span class="op">/</span> <span class="fu">seqlengths</span><span class="op">(</span><span class="va">gb</span><span class="op">$</span><span class="va">query</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">Osa_Aom_PAR</span><span class="op">[</span><span class="fu">seqnames</span><span class="op">(</span><span class="va">Osa_Aom_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu">seqlevels</span><span class="op">(</span><span class="va">Osa_Aom_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span><span class="op">[</span><span class="fu">QTcoverage</span><span class="op">(</span><span class="va">Osa_Aom_PAR</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">0.5</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
<span class="fu">seqlevels</span><span class="op">(</span><span class="va">Osa_Aom_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">seqlevelsInUse</span><span class="op">(</span><span class="va">Osa_Aom_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span>
<span class="fu">makeOxfordPlots</span><span class="op">(</span><span class="va">Osa_Aom_PAR</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Osa_Aom_win_prepare-2.png" width="700"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Let's remove the smallest ones that barely display on one pixel</span>
<span class="fu">seqlengths</span><span class="op">(</span><span class="va">Osa_Aom_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## contig_12_1 contig_15_1 contig_34_1 contig_38_1 contig_49_1 </span>
<span class="co">##     7097394     6419763     1209792      203373     1316631</span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Osa_Aom_PAR</span><span class="op">[</span><span class="fu">seqnames</span><span class="op">(</span><span class="va">Osa_Aom_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu">seqlevels</span><span class="op">(</span><span class="va">Osa_Aom_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span><span class="op">[</span><span class="fu">seqlengths</span><span class="op">(</span><span class="va">Osa_Aom_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">2e4</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
<span class="fu">seqlevels</span><span class="op">(</span><span class="va">Osa_Aom_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">seqlevelsInUse</span><span class="op">(</span><span class="va">Osa_Aom_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span>
<span class="fu">makeOxfordPlots</span><span class="op">(</span><span class="va">Osa_Aom_PAR</span>, col <span class="op">=</span> <span class="st">"strand"</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Osa_Aom_win_prepare-3.png" width="700"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># And now let's flip by hand the ones that need</span>
<span class="va">grl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">Osa_Aom_PAR</span>, <span class="fu">seqnames</span><span class="op">(</span><span class="va">Osa_Aom_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span><span class="op">)</span>
<span class="va">grl</span><span class="op">[[</span><span class="st">"contig_38_1"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">reverse</span><span class="op">(</span><span class="va">grl</span><span class="op">[[</span><span class="st">"contig_38_1"</span><span class="op">]</span><span class="op">]</span>, query <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">grl</span><span class="op">[[</span><span class="st">"contig_49_1"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">reverse</span><span class="op">(</span><span class="va">grl</span><span class="op">[[</span><span class="st">"contig_49_1"</span><span class="op">]</span><span class="op">]</span>, query <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">Osa_Aom_PAR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">grl</span><span class="op">)</span>
<span class="fu">makeOxfordPlots</span><span class="op">(</span><span class="va">Osa_Aom_PAR</span>, col <span class="op">=</span> <span class="st">"strand"</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Osa_Aom_win_prepare-4.png" width="700"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Finally, let's reorder and merge remaining seqlevels</span>
<span class="fu">seqlevels</span><span class="op">(</span><span class="va">Osa_Aom_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">seqlevels</span><span class="op">(</span><span class="va">Osa_Aom_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span><span class="op">[</span><span class="fu">orderQuerySeqLevels</span><span class="op">(</span><span class="va">Osa_Aom_PAR</span><span class="op">)</span><span class="op">]</span>
<span class="va">Osa_Aom_PAR</span><span class="op">$</span><span class="va">query</span> <span class="op">&lt;-</span> <span class="fu">mergeSeqLevels</span><span class="op">(</span><span class="va">Osa_Aom_PAR</span><span class="op">$</span><span class="va">query</span>, <span class="fu">seqlevels</span><span class="op">(</span><span class="va">Osa_Aom_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span>, <span class="st">"PAR"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">mkOxPlotWindow</span><span class="op">(</span><span class="va">Osa_Aom_PAR</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Osa_Aom_win-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="oki-vs-kum">Oki vs Kum<a class="anchor" aria-label="anchor" href="#oki-vs-kum"></a>
</h3>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">makeOxfordPlots</span><span class="op">(</span><span class="va">coa</span><span class="op">$</span><span class="va">Oki_Kum</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Oki_Kum-1.png" width="700"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Oki_Kum_PAR</span> <span class="op">&lt;-</span> <span class="va">gbs</span><span class="op">$</span><span class="va">Oki_Kum</span> |&gt; <span class="fu">plyranges</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyranges/man/tidyverse-reexports.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">seqnames</span> <span class="op">==</span> <span class="st">"PAR"</span><span class="op">)</span>
<span class="fu">seqlevels</span><span class="op">(</span><span class="va">Oki_Kum_PAR</span><span class="op">)</span>       <span class="op">&lt;-</span> <span class="fu">seqlevelsInUse</span><span class="op">(</span><span class="va">Oki_Kum_PAR</span><span class="op">)</span>
<span class="fu">seqlevels</span><span class="op">(</span><span class="va">Oki_Kum_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">seqlevelsInUse</span><span class="op">(</span><span class="va">Oki_Kum_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span>

<span class="fu">makeOxfordPlots</span><span class="op">(</span><span class="va">Oki_Kum_PAR</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Oki_Kum_win_prepare-1.png" width="700"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Let's remove the contigs that have their main match elsewhere.</span>
<span class="va">QTcoverage</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">gb</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu">seqlevels</span><span class="op">(</span><span class="va">gb</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># Not ready for full objects</span>
  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="fu">seqlengths</span><span class="op">(</span><span class="va">gb</span><span class="op">$</span><span class="va">query</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  <span class="va">grl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">gb</span>, <span class="fu">seqnames</span><span class="op">(</span><span class="va">gb</span><span class="op">$</span><span class="va">query</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">grl</span>, \<span class="op">(</span><span class="va">gb</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">width</span><span class="op">(</span><span class="va">gb</span><span class="op">$</span><span class="va">query</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span> <span class="op">/</span> <span class="fu">seqlengths</span><span class="op">(</span><span class="va">gb</span><span class="op">$</span><span class="va">query</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">Oki_Kum_PAR</span><span class="op">[</span><span class="fu">seqnames</span><span class="op">(</span><span class="va">Oki_Kum_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu">seqlevels</span><span class="op">(</span><span class="va">Oki_Kum_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span><span class="op">[</span><span class="fu">QTcoverage</span><span class="op">(</span><span class="va">Oki_Kum_PAR</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">0.5</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
<span class="fu">seqlevels</span><span class="op">(</span><span class="va">Oki_Kum_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">seqlevelsInUse</span><span class="op">(</span><span class="va">Oki_Kum_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span>
<span class="fu">makeOxfordPlots</span><span class="op">(</span><span class="va">Oki_Kum_PAR</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Oki_Kum_win_prepare-2.png" width="700"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Let's remove the smallest ones that barely display on one pixel</span>
<span class="fu">seqlengths</span><span class="op">(</span><span class="va">Oki_Kum_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## contig_12_1 contig_13_1 contig_18_1 contig_28_1 contig_38_1 contig_41_1 </span>
<span class="co">##     2357322      793615         832     6415228       61242     2611992 </span>
<span class="co">## contig_43_1 contig_61_1 contig_72_1 contig_82_1 contig_85_1 contig_89_1 </span>
<span class="co">##      841236       17591       84743     2322619      428051      241503 </span>
<span class="co">## contig_91_1 </span>
<span class="co">##      126775</span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Oki_Kum_PAR</span><span class="op">[</span><span class="fu">seqnames</span><span class="op">(</span><span class="va">Oki_Kum_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu">seqlevels</span><span class="op">(</span><span class="va">Oki_Kum_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span><span class="op">[</span><span class="fu">seqlengths</span><span class="op">(</span><span class="va">Oki_Kum_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">2e4</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
<span class="fu">seqlevels</span><span class="op">(</span><span class="va">Oki_Kum_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">seqlevelsInUse</span><span class="op">(</span><span class="va">Oki_Kum_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span>
<span class="fu">makeOxfordPlots</span><span class="op">(</span><span class="va">Oki_Kum_PAR</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Oki_Kum_win_prepare-3.png" width="700"></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># And now let's flip by hand the ones that need</span>
<span class="va">grl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">Oki_Kum_PAR</span>, <span class="fu">seqnames</span><span class="op">(</span><span class="va">Oki_Kum_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span><span class="op">)</span>
<span class="va">grl</span><span class="op">[[</span><span class="st">"contig_12_1"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">reverse</span><span class="op">(</span><span class="va">grl</span><span class="op">[[</span><span class="st">"contig_12_1"</span><span class="op">]</span><span class="op">]</span>, query <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">grl</span><span class="op">[[</span><span class="st">"contig_43_1"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">reverse</span><span class="op">(</span><span class="va">grl</span><span class="op">[[</span><span class="st">"contig_43_1"</span><span class="op">]</span><span class="op">]</span>, query <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">Oki_Kum_PAR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">grl</span><span class="op">)</span>
<span class="fu">makeOxfordPlots</span><span class="op">(</span><span class="va">Oki_Kum_PAR</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Oki_Kum_win_prepare-4.png" width="700"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Finally, let's reorder and merge remaining seqlevels</span>
<span class="fu">seqlevels</span><span class="op">(</span><span class="va">Oki_Kum_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">seqlevels</span><span class="op">(</span><span class="va">Oki_Kum_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span><span class="op">[</span><span class="fu">orderQuerySeqLevels</span><span class="op">(</span><span class="va">Oki_Kum_PAR</span><span class="op">)</span><span class="op">]</span>
<span class="va">Oki_Kum_PAR</span><span class="op">$</span><span class="va">query</span> <span class="op">&lt;-</span> <span class="fu">mergeSeqLevels</span><span class="op">(</span><span class="va">Oki_Kum_PAR</span><span class="op">$</span><span class="va">query</span>, <span class="fu">seqlevels</span><span class="op">(</span><span class="va">Oki_Kum_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span>, <span class="st">"PAR"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">mkOxPlotWindow</span><span class="op">(</span><span class="va">Oki_Kum_PAR</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Oki_Kum_win-1.svg" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="ciona">Ciona<a class="anchor" aria-label="anchor" href="#ciona"></a>
</h2>
<div class="section level3">
<h3 id="ciona-intestinalis-plymouth-vs-roscoff">
<em>Ciona intestinalis</em> (Plymouth vs Roscoff)<a class="anchor" aria-label="anchor" href="#ciona-intestinalis-plymouth-vs-roscoff"></a>
</h3>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">makeOxfordPlots</span><span class="op">(</span><span class="va">coa</span><span class="op">$</span><span class="va">Ply_Ros</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Ciona intestinalis Plymouth vs Roscoff"</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Ply_Ros-1.png" width="700"></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">mkOxPlotWindow</span><span class="op">(</span><span class="va">gbs</span><span class="op">$</span><span class="va">Ply_Ros</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Ciona intestinalis Plymouth vs Roscoff"</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Ply_Ros_win-1.svg" width="700"></p>
</div>
<div class="section level3">
<h3 id="ciona-intestinalis-plymouth-vs-ciona-robusta">
<em>Ciona intestinalis</em> (Plymouth) vs <em>Ciona robusta</em><a class="anchor" aria-label="anchor" href="#ciona-intestinalis-plymouth-vs-ciona-robusta"></a>
</h3>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">makeOxfordPlots</span><span class="op">(</span><span class="va">coa</span><span class="op">$</span><span class="va">Ply_Rob</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Ciona intestinalis Plymouth vs Ciona robusta"</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Ply_Rob-1.png" width="700"></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">mkOxPlotWindow</span><span class="op">(</span><span class="va">gbs</span><span class="op">$</span><span class="va">Ply_Rob</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Ciona intestinalis Plymouth vs Ciona robusta"</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Ply_Rob_win-1.svg" width="700"></p>
</div>
<div class="section level3">
<h3 id="troubleshoot-of-grid-pattern">Troubleshoot of grid pattern<a class="anchor" aria-label="anchor" href="#troubleshoot-of-grid-pattern"></a>
</h3>
<p>We see horizontal patterns what are they? I think they may be pericentromeric regions.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">makeOxfordPlots</span><span class="op">(</span><span class="va">coa</span><span class="op">$</span><span class="va">Ply_Rob</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Ciona intestinalis Plymouth vs Ciona robusta"</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Ply_Rob_point_plot-1.png" width="700"></p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">coa</span><span class="op">$</span><span class="va">Ply_Rob</span> |&gt;
  <span class="fu">plyranges</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyranges/man/tidyverse-reexports.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu">seqnames</span><span class="op">(</span><span class="va">query</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BJTB01000010.1"</span>, <span class="st">"BJTB01000011.1"</span>, <span class="st">"BJTB01000012.1"</span>, <span class="st">"BJTB01000013.1"</span>, <span class="st">"BJTB01000014.1"</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu">plyranges</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyranges/man/tidyverse-reexports.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">seqnames</span>        <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BNJZ01000005.1"</span>, <span class="st">"BNJZ01000006.1"</span>, <span class="st">"BNJZ01000007.1"</span>, <span class="st">"BNJZ01000008.1"</span>, <span class="st">"BNJZ01000009.1"</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu">makeOxfordPlots</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"C. int. P vs C. rob., subset near BJTB01000012.1 and BNJZ01000007.1"</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Ply_Rob_subset-1.png" width="700"></p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">coa</span><span class="op">$</span><span class="va">Ply_Rob</span> |&gt;
  <span class="fu">plyranges</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyranges/man/tidyverse-reexports.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu">seqnames</span><span class="op">(</span><span class="va">query</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BJTB01000011.1"</span>, <span class="st">"BJTB01000012.1"</span>, <span class="st">"BJTB01000013.1"</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu">plyranges</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyranges/man/tidyverse-reexports.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">seqnames</span>        <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BNJZ01000006.1"</span>, <span class="st">"BNJZ01000007.1"</span>, <span class="st">"BNJZ01000008.1"</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu">makeOxfordPlots</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"C. int. P vs C. rob., subset near (closer) BJTB01000012.1 and BNJZ01000007.1"</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Ply_Rob_subset2-1.png" width="700"></p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">coa</span><span class="op">$</span><span class="va">Ply_Rob</span> |&gt;
  <span class="fu">plyranges</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyranges/man/tidyverse-reexports.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu">seqnames</span><span class="op">(</span><span class="va">query</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BJTB01000002.1"</span>, <span class="st">"BJTB01000003.1"</span>, <span class="st">"BJTB01000004.1"</span>, <span class="st">"BJTB01000005.1"</span>, <span class="st">"BJTB01000006.1"</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu">plyranges</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyranges/man/tidyverse-reexports.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">seqnames</span>        <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BNJZ01000010.1"</span>, <span class="st">"BNJZ01000011.1"</span>, <span class="st">"BNJZ01000012.1"</span>, <span class="st">"BNJZ01000013.1"</span>, <span class="st">"BNJZ01000014.1"</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu">makeOxfordPlots</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"C. int. P vs C. rob., subset near BJTB01000004.1 and BNJZ01000012.1"</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Ply_Rob_subset3-1.png" width="700"></p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">coa</span><span class="op">$</span><span class="va">Ply_Rob</span> |&gt;
  <span class="fu">plyranges</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyranges/man/tidyverse-reexports.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu">seqnames</span><span class="op">(</span><span class="va">query</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BJTB01000003.1"</span>, <span class="st">"BJTB01000004.1"</span>, <span class="st">"BJTB01000005.1"</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu">plyranges</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyranges/man/tidyverse-reexports.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">seqnames</span>        <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BNJZ01000011.1"</span>, <span class="st">"BNJZ01000012.1"</span>, <span class="st">"BNJZ01000013.1"</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu">makeOxfordPlots</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"C. int. P vs C. rob., subset near (closer) BJTB01000004.1 and BNJZ01000012.1"</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Ply_Rob_subset4-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="ciona-intestinalis-plymouth-vs-ciona-savignyi">
<em>Ciona intestinalis</em> (Plymouth) vs <em>Ciona savignyi</em><a class="anchor" aria-label="anchor" href="#ciona-intestinalis-plymouth-vs-ciona-savignyi"></a>
</h3>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">makeOxfordPlots</span><span class="op">(</span><span class="va">coa</span><span class="op">$</span><span class="va">Ply_Sav</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Ciona intestinalis Plymouth vs Ciona savignyi"</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Ply_Sav-1.png" width="700"></p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Ply_Sav_chr1</span> <span class="op">&lt;-</span> <span class="va">gbs</span><span class="op">$</span><span class="va">Ply_Sav</span> |&gt; <span class="fu">plyranges</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyranges/man/tidyverse-reexports.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">seqnames</span> <span class="op">==</span> <span class="st">"BNJZ01000001.1"</span><span class="op">)</span>
<span class="fu">seqlevels</span><span class="op">(</span><span class="va">Ply_Sav_chr1</span><span class="op">)</span>       <span class="op">&lt;-</span> <span class="fu">seqlevelsInUse</span><span class="op">(</span><span class="va">Ply_Sav_chr1</span><span class="op">)</span>
<span class="fu">seqlevels</span><span class="op">(</span><span class="va">Ply_Sav_chr1</span><span class="op">$</span><span class="va">query</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">seqlevelsInUse</span><span class="op">(</span><span class="va">Ply_Sav_chr1</span><span class="op">$</span><span class="va">query</span><span class="op">)</span>
<span class="va">Ply_Sav_chr1</span><span class="op">$</span><span class="va">query</span> <span class="op">&lt;-</span> <span class="fu">forceSeqLengths</span><span class="op">(</span><span class="va">Ply_Sav_chr1</span><span class="op">$</span><span class="va">query</span><span class="op">)</span>

<span class="fu">makeOxfordPlots</span><span class="op">(</span><span class="va">Ply_Sav_chr1</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Ply_Sav_win_prepare-1.png" width="700"></p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Let's remove the contigs that have their main match elsewhere.</span>
<span class="va">QTcoverage</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">gb</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu">seqlevels</span><span class="op">(</span><span class="va">gb</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># Not ready for full objects</span>
  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="fu">seqlengths</span><span class="op">(</span><span class="va">gb</span><span class="op">$</span><span class="va">query</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  <span class="va">grl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">gb</span>, <span class="fu">seqnames</span><span class="op">(</span><span class="va">gb</span><span class="op">$</span><span class="va">query</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">grl</span>, \<span class="op">(</span><span class="va">gb</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">width</span><span class="op">(</span><span class="va">gb</span><span class="op">$</span><span class="va">query</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span> <span class="op">/</span> <span class="fu">seqlengths</span><span class="op">(</span><span class="va">gb</span><span class="op">$</span><span class="va">query</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">Ply_Sav_chr1</span><span class="op">[</span><span class="fu">seqnames</span><span class="op">(</span><span class="va">Ply_Sav_chr1</span><span class="op">$</span><span class="va">query</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu">seqlevels</span><span class="op">(</span><span class="va">Ply_Sav_chr1</span><span class="op">$</span><span class="va">query</span><span class="op">)</span><span class="op">[</span><span class="fu">QTcoverage</span><span class="op">(</span><span class="va">Ply_Sav_chr1</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
<span class="fu">seqlevels</span><span class="op">(</span><span class="va">Ply_Sav_chr1</span><span class="op">$</span><span class="va">query</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">seqlevelsInUse</span><span class="op">(</span><span class="va">Ply_Sav_chr1</span><span class="op">$</span><span class="va">query</span><span class="op">)</span>
<span class="fu">makeOxfordPlots</span><span class="op">(</span><span class="va">Ply_Sav_chr1</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Ply_Sav_win_prepare-2.png" width="700"></p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Let's remove the smallest ones that barely display on one pixel</span>
<span class="fu">seqlengths</span><span class="op">(</span><span class="va">Ply_Sav_chr1</span><span class="op">$</span><span class="va">query</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##   R1063    R113   R1167   R1383     R14   R1490   R1596    R162    R173   R1779 </span>
<span class="co">##   24606  277504   10138    7422 1702960    3223    8495  276690  455223   32296 </span>
<span class="co">##   R1942   R2368   R2407   R2517    R268     R27    R281   R2872     R30     R31 </span>
<span class="co">##   10471    6428    9904    5720  550239 2366314  114725    8506 3493700  766944 </span>
<span class="co">##    R347    R352    R417    R489    R491      R5     R51     R62     R64    R650 </span>
<span class="co">##  180004   46220   61968  180871   28116 2728683 1639093  608627  540266   23432 </span>
<span class="co">##    R767     R98 </span>
<span class="co">##   42085  434095</span></code></pre>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Ply_Sav_chr1</span><span class="op">[</span><span class="fu">seqnames</span><span class="op">(</span><span class="va">Ply_Sav_chr1</span><span class="op">$</span><span class="va">query</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu">seqlevels</span><span class="op">(</span><span class="va">Ply_Sav_chr1</span><span class="op">$</span><span class="va">query</span><span class="op">)</span><span class="op">[</span><span class="fu">seqlengths</span><span class="op">(</span><span class="va">Ply_Sav_chr1</span><span class="op">$</span><span class="va">query</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">2e4</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
<span class="fu">seqlevels</span><span class="op">(</span><span class="va">Ply_Sav_chr1</span><span class="op">$</span><span class="va">query</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">seqlevelsInUse</span><span class="op">(</span><span class="va">Ply_Sav_chr1</span><span class="op">$</span><span class="va">query</span><span class="op">)</span>
<span class="fu">makeOxfordPlots</span><span class="op">(</span><span class="va">Ply_Sav_chr1</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Ply_Sav_win_prepare-3.png" width="700"></p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Finally, let's reorder and merge remaining seqlevels</span>
<span class="fu">seqlevels</span><span class="op">(</span><span class="va">Ply_Sav_chr1</span><span class="op">$</span><span class="va">query</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">seqlevels</span><span class="op">(</span><span class="va">Ply_Sav_chr1</span><span class="op">$</span><span class="va">query</span><span class="op">)</span><span class="op">[</span><span class="fu">orderQuerySeqLevels</span><span class="op">(</span><span class="va">Ply_Sav_chr1</span><span class="op">)</span><span class="op">]</span>
<span class="va">Ply_Sav_chr1</span><span class="op">$</span><span class="va">query</span> <span class="op">&lt;-</span> <span class="fu">mergeSeqLevels</span><span class="op">(</span><span class="va">Ply_Sav_chr1</span><span class="op">$</span><span class="va">query</span>, <span class="fu">seqlevels</span><span class="op">(</span><span class="va">Ply_Sav_chr1</span><span class="op">$</span><span class="va">query</span><span class="op">)</span>, <span class="st">"Merged matching contigs"</span><span class="op">)</span>
<span class="fu">makeOxfordPlots</span><span class="op">(</span><span class="va">Ply_Sav_chr1</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Ply_Sav_win_prepare-4.png" width="700"></p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">mkOxPlotWindow</span><span class="op">(</span><span class="va">Ply_Sav_chr1</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Ciona intestinalis Plymouth vs Ciona savignyi"</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Ply_Sav_win-1.svg" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="drosophila">Drosophila<a class="anchor" aria-label="anchor" href="#drosophila"></a>
</h2>
<div class="section level3">
<h3 id="vs-drosophila-mauritania">vs Drosophila mauritania<a class="anchor" aria-label="anchor" href="#vs-drosophila-mauritania"></a>
</h3>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">makeOxfordPlots</span><span class="op">(</span><span class="va">coa</span><span class="op">$</span><span class="va">Dme_Dma</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Dmel vs Dmau"</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Dmel_Dmau-1.png" width="700"></p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Force strand flipping for aesthetic purpose</span>
<span class="fu">mkOxPlotWindow</span><span class="op">(</span><span class="va">gbs</span><span class="op">$</span><span class="va">Dme_Dma</span> |&gt; <span class="fu">forceSeqLengths</span><span class="op">(</span><span class="op">)</span> |&gt; <span class="fu">reverse</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Drosophila melanogaster vs Drosophila mauritania"</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Dmel_Dmau_win-1.svg" width="700"></p>
</div>
<div class="section level3">
<h3 id="vs-drosophila-yakuba">vs Drosophila yakuba<a class="anchor" aria-label="anchor" href="#vs-drosophila-yakuba"></a>
</h3>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">makeOxfordPlots</span><span class="op">(</span><span class="va">coa</span><span class="op">$</span><span class="va">Dme_Dya</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Dmel vs Dyak"</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Dmel_Dyak-1.png" width="700"></p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">mkOxPlotWindow</span><span class="op">(</span><span class="va">gbs</span><span class="op">$</span><span class="va">Dme_Dya</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Drosophila melanogaster vs Drosophila yakuba"</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Dmel_Dyak_win-1.svg" width="700"></p>
</div>
<div class="section level3">
<h3 id="vs-drosophila-subpulchrella">vs Drosophila subpulchrella<a class="anchor" aria-label="anchor" href="#vs-drosophila-subpulchrella"></a>
</h3>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">makeOxfordPlots</span><span class="op">(</span><span class="va">coa</span><span class="op">$</span><span class="va">Dme_Dsu</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Dmel vs Dsub"</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Dmel_Dsub-1.png" width="700"></p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Blacklist 3R as the algorithm does not find an nicely square window on it.</span>
<span class="fu">mkOxPlotWindow</span><span class="op">(</span><span class="va">gbs</span><span class="op">$</span><span class="va">Dme_Dsu</span> |&gt; <span class="fu">plyranges</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyranges/man/tidyverse-reexports.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">seqnames</span> <span class="op">!=</span> <span class="st">"3R"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Drosophila melanogaster vs Drosophila subpulchrella"</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Dmel_Dsub_win-1.svg" width="700"></p>
</div>
<div class="section level3">
<h3 id="vs-drosophila-buskii">vs Drosophila buskii<a class="anchor" aria-label="anchor" href="#vs-drosophila-buskii"></a>
</h3>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">makeOxfordPlots</span><span class="op">(</span><span class="va">coa</span><span class="op">$</span><span class="va">Dme_Dbu</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Dmel vs Dbus"</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Dmel_Dbus-1.png" width="700"></p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">mkOxPlotWindow</span><span class="op">(</span><span class="va">gbs</span><span class="op">$</span><span class="va">Dme_Dbu</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Drosophila melanogaster vs Drosophila buskii"</span><span class="op">)</span></code></pre></div>
<p><img src="OxfordPlots_files/figure-html/Dmel_Dbus_win-1.svg" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="mammals">Mammals<a class="anchor" aria-label="anchor" href="#mammals"></a>
</h2>
<div class="section level3">
<h3 id="human-versus-mouse">Human versus mouse<a class="anchor" aria-label="anchor" href="#human-versus-mouse"></a>
</h3>
<p>Chromosome 18 was chosen because it is small and it has the same name in both species. Region was centered on the alignment with the longest width, as otherwise the window out of target.</p>
<p>Still, most of the region is not aligned. The syntenic regions only look contiguous because the dots need to be thick to be easy to see.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hgmm</span> <span class="op">&lt;-</span> <span class="fu">load_genomic_breaks</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="op">(</span><span class="st">"extdata/hg38_mm10/hg38_chr18__mm10_chr18.gff3"</span><span class="op">)</span>, package <span class="op">=</span> <span class="st">"BreakpointsData"</span><span class="op">)</span><span class="op">)</span>
<span class="fu">mkOxPlotWindow</span><span class="op">(</span><span class="va">hgmm</span>, centre <span class="op">=</span> <span class="st">'maxwidth'</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Homo sapiens vs Mus musculus"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></code></pre>
<pre><code><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></code></pre>
<pre><code><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></code></pre>
<pre><code><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></code></pre>
<p><img src="OxfordPlots_files/figure-html/hg38_mm10-1.svg" width="700"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Aleksandra Bliznina, Michael Mansfield, Charles Plessy.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
