<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Scaffolding of the KUM-M3 genome • OikScrambling</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Scaffolding of the KUM-M3 genome">
<meta property="og:description" content="OikScrambling">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">OikScrambling</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">5.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/OikScrambling.html">Get started</a>
</li>
<li>
  <a href="../articles/LoadGenomicBreaks.html">Data load</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Supplemental material
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/OxfordPlots.html">Figure 1B DNA line plots</a>
    </li>
    <li>
      <a href="../articles/ParallelPlots.html">Figure 1C chromosome parallel plots</a>
    </li>
    <li>
      <a href="../articles/DistanceMeasures.html">Figure 1D scrambling index</a>
    </li>
    <li>
      <a href="../articles/OrthogroupSyntenies.html">Figure 2A orthogroup dot plots and synteny block histograms</a>
    </li>
    <li>
      <a href="../articles/ChromosomePlots.html">Figure 5 genome-wide feature patterns</a>
    </li>
    <li>
      <a href="../articles/SquareWindowPlots.html">Figure 7A–D DNA line plots</a>
    </li>
    <li>
      <a href="../articles/ScalingBreakpoints.html">Figure 7E breakpoint number barplots</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/AomScaffolding.html">Scaffolding of the AOM-5 genome</a>
    </li>
    <li>
      <a href="../articles/BergenScaffolding.html">Scaffolding of the OdB3 genome</a>
    </li>
    <li>
      <a href="../articles/CNEs.html">Conserved non-coding elements</a>
    </li>
    <li>
      <a href="../articles/ChromosomePlots.html">Chromosome-scale feature density plots</a>
    </li>
    <li>
      <a href="../articles/CoalescingCutoffs.html">Modifying coalescent cutoffs</a>
    </li>
    <li>
      <a href="../articles/ColinearityInterruptors.html">Regions interrupting colinearity</a>
    </li>
    <li>
      <a href="../articles/DistanceMeasures.html">Distance Measures</a>
    </li>
    <li>
      <a href="../articles/GenomicFeatures.html">Genomic features of the breakpoints</a>
    </li>
    <li>
      <a href="../articles/GenomicHeatmaps.html">Genomic features of the breakpoints (heatmaps)</a>
    </li>
    <li>
      <a href="../articles/Inversions.html">Inversions</a>
    </li>
    <li>
      <a href="../articles/KumeScaffolding.html">Scaffolding of the KUM-M3 genome</a>
    </li>
    <li>
      <a href="../articles/LoadGenomicBreaks.html">Load genomic break data</a>
    </li>
    <li>
      <a href="../articles/OperonConservation.html">Operon conservation analysis</a>
    </li>
    <li>
      <a href="../articles/OrthogroupSyntenies.html">Orthogroup syntenies</a>
    </li>
    <li>
      <a href="../articles/OxfordPlots.html">Alignment line plots, whole genomes</a>
    </li>
    <li>
      <a href="../articles/PAC3.html">Region of interest: PAC3</a>
    </li>
    <li>
      <a href="../articles/PWM.html">Motif search and analysis</a>
    </li>
    <li>
      <a href="../articles/ParallelPlots.html">Whole-chromosome parallel plots</a>
    </li>
    <li>
      <a href="../articles/RegionWidths.html">Width of the aligned and mapped regions.</a>
    </li>
    <li>
      <a href="../articles/RegionsOfInterest.html">Regions of interest</a>
    </li>
    <li>
      <a href="../articles/RepeatRegions.html">Repeat regions</a>
    </li>
    <li>
      <a href="../articles/ScalingBreakpoints.html">Scaling breakpoints</a>
    </li>
    <li>
      <a href="../articles/SegmentMovements.html">Segment movement distances</a>
    </li>
    <li>
      <a href="../articles/SquareWindowPlots.html">Alignment line plots, 10×10 Mbp windows</a>
    </li>
    <li>
      <a href="../articles/TFBS.html">Transcription factor binding sites</a>
    </li>
    <li>
      <a href="../articles/TandemSiteDuplications.html">Tandem site duplications</a>
    </li>
    <li>
      <a href="../articles/Translocations.html">Translocations</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/oist/LuscombeU_OikScrambling/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Scaffolding of the KUM-M3 genome</h1>
                        <h4 data-toc-skip class="author">Charles
Plessy</h4>
                        <h4 data-toc-skip class="author">Michael
Mansfield</h4>
            
            <h4 data-toc-skip class="date">14 November, 2023</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/oist/LuscombeU_OikScrambling/blob/HEAD/vignettes/KumeScaffolding.Rmd" class="external-link"><code>vignettes/KumeScaffolding.Rmd</code></a></small>
      <div class="hidden name"><code>KumeScaffolding.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html" class="external-link">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>cache <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                      dev    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'png'</span>, <span class="st">'svg'</span><span class="op">)</span>,</span>
<span>                      fig.ext<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'png'</span>, <span class="st">'svg'</span><span class="op">)</span>,</span>
<span>                      fig.width  <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                      fig.height <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette produces a scaffolding guide to be used with the KUM-M3
genome for plotting purposes.</p>
<div class="section level3">
<h3 id="load-r-pacakges-and-data">Load R pacakges and data<a class="anchor" aria-label="anchor" href="#load-r-pacakges-and-data"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/oist/LuscombeU_OikScrambling" class="external-link">'OikScrambling'</a></span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://patchwork.data-imaginist.com" class="external-link">'patchwork'</a></span><span class="op">)</span>     <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">genomes</span> <span class="op">&lt;-</span> <span class="fu">OikScrambling</span><span class="fu">:::</span><span class="fu"><a href="../reference/loadAllGenomes.html">loadAllGenomes</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in runHook(".onLoad", env, package.lib, package): input string</span></span>
<span><span class="co">## 'Génoscope' cannot be translated from 'ANSI_X3.4-1968' to UTF-8, but is valid</span></span>
<span><span class="co">## UTF-8</span></span>
<span></span>
<span><span class="co">## Warning in runHook(".onLoad", env, package.lib, package): input string</span></span>
<span><span class="co">## 'Génoscope' cannot be translated from 'ANSI_X3.4-1968' to UTF-8, but is valid</span></span>
<span><span class="co">## UTF-8</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"BreakPoints.Rdata"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="scaffolding">Scaffolding<a class="anchor" aria-label="anchor" href="#scaffolding"></a>
</h2>
<div class="section level3">
<h3 id="helper-functions">Helper functions<a class="anchor" aria-label="anchor" href="#helper-functions"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Helper function to flip many contigs at once.</span></span>
<span><span class="va">flipContigsForOxfordPlot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">gb</span>, <span class="va">flip_which</span><span class="op">=</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">grl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">gb</span>, <span class="fu">seqnames</span><span class="op">(</span><span class="va">gb</span><span class="op">$</span><span class="va">query</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">grl</span> <span class="op">&lt;-</span> <span class="fu">endoapply</span><span class="op">(</span><span class="va">grl</span>, <span class="kw">function</span><span class="op">(</span><span class="va">s</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span><span class="op">(</span> <span class="op">!</span> <span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu">seqnames</span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">query</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu">seqnames</span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">query</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">flip_which</span> <span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">s</span> <span class="op">&lt;-</span> <span class="fu">GenomicBreaks</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/reverse-methods.html" class="external-link">reverse</a></span><span class="op">(</span><span class="va">s</span>, query<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>        <span class="va">s</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">s</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="va">ogb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">grl</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">ogb</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Let's remove the contigs that have their main match elsewhere.</span></span>
<span><span class="va">QTcoverage</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">gb</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu">seqlevels</span><span class="op">(</span><span class="va">gb</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># Not ready for full objects</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="fu">seqlengths</span><span class="op">(</span><span class="va">gb</span><span class="op">$</span><span class="va">query</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">grl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">gb</span>, <span class="fu">seqnames</span><span class="op">(</span><span class="va">gb</span><span class="op">$</span><span class="va">query</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">grl</span>, \<span class="op">(</span><span class="va">gb</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">width</span><span class="op">(</span><span class="va">gb</span><span class="op">$</span><span class="va">query</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span> <span class="op">/</span> <span class="fu">seqlengths</span><span class="op">(</span><span class="va">gb</span><span class="op">$</span><span class="va">query</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="scaffolding-of-kume-chromosomes">Scaffolding of Kume chromosomes<a class="anchor" aria-label="anchor" href="#scaffolding-of-kume-chromosomes"></a>
</h2>
<p>The Kume draft assembly contains long contigs that can be scaffolded
into chromosomes. Some sequences may be missing between these contigs,
but the absence of large gaps in the plots at the junction between
contigs suggest that this is not a problem for the use we make of this
scaffolding.</p>
<div class="section level3">
<h3 id="chromosome-1">Chromosome 1<a class="anchor" aria-label="anchor" href="#chromosome-1"></a>
</h3>
<p>The best match for chr1 in the Kume assembly is
<code>contig_3_1</code>. It maps roughly in the 8,000,000 – 13,000,000
region.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bestMatch</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">gb</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="fu">width</span><span class="op">(</span><span class="va">gb</span><span class="op">$</span><span class="va">query</span><span class="op">)</span>, <span class="fu">seqnames</span><span class="op">(</span><span class="va">gb</span><span class="op">$</span><span class="va">query</span><span class="op">)</span>, <span class="va">sum</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">coa</span><span class="op">$</span><span class="va">Oki_Kum</span> <span class="op">|&gt;</span> <span class="fu">plyranges</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">seqnames</span> <span class="op">==</span> <span class="st">"chr1"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">bestMatch</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "contig_3_1"</span></span></code></pre>
<p>The next best match, <code>contig_27_1</code> is most of chr1’s short
arm.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coa</span><span class="op">$</span><span class="va">Oki_Kum</span> <span class="op">|&gt;</span> <span class="fu">plyranges</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">seqnames</span> <span class="op">==</span> <span class="st">"chr1"</span>, <span class="fu">seqnames</span><span class="op">(</span><span class="va">query</span><span class="op">)</span><span class="op">!=</span><span class="st">"contig_3_1"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">bestMatch</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "contig_27_1"</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coa</span><span class="op">$</span><span class="va">Oki_Kum</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/plotApairOfChrs.html" class="external-link">plotApairOfChrs</a></span><span class="op">(</span>chrQ <span class="op">=</span> <span class="st">"contig_27_1"</span><span class="op">)</span></span></code></pre></div>
<p><img src="KumeScaffolding_files/figure-html/Kum_chr1_assembly_2-1.png" width="960"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Oki_Kum_Chr1</span> <span class="op">&lt;-</span> <span class="va">gbs</span><span class="op">$</span><span class="va">Oki_Kum</span> <span class="op">|&gt;</span> <span class="fu">plyranges</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">seqnames</span> <span class="op">==</span> <span class="st">"chr1"</span><span class="op">)</span></span>
<span><span class="fu">seqlevels</span><span class="op">(</span><span class="va">Oki_Kum_Chr1</span><span class="op">)</span>       <span class="op">&lt;-</span> <span class="fu">seqlevelsInUse</span><span class="op">(</span><span class="va">Oki_Kum_Chr1</span><span class="op">)</span></span>
<span><span class="fu">seqlevels</span><span class="op">(</span><span class="va">Oki_Kum_Chr1</span><span class="op">$</span><span class="va">query</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">seqlevelsInUse</span><span class="op">(</span><span class="va">Oki_Kum_Chr1</span><span class="op">$</span><span class="va">query</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/makeOxfordPlots.html" class="external-link">makeOxfordPlots</a></span><span class="op">(</span><span class="va">Oki_Kum_Chr1</span>, col<span class="op">=</span><span class="st">'strand'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Everything from KUM-M3 that matches Oki's Chr1"</span><span class="op">)</span></span></code></pre></div>
<p><img src="KumeScaffolding_files/figure-html/Kum_chr1_assembly_3-1.png" width="960"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scafs</span><span class="op">$</span><span class="va">Kum_Oki</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Chr1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  contig <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"contig_27_1"</span>, <span class="st">"contig_90_1"</span>, <span class="st">"contig_3_1"</span>, <span class="st">"contig_88_1"</span>, <span class="st">"contig_87_1"</span>, <span class="st">"contig_63_1"</span><span class="op">)</span>,</span>
<span>  orientation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">contigsToMerge_start</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="fu">seqlengths</span><span class="op">(</span><span class="va">gbs</span><span class="op">$</span><span class="va">Oki_Kum</span><span class="op">$</span><span class="va">query</span><span class="op">)</span><span class="op">[</span><span class="va">scafs</span><span class="op">$</span><span class="va">Kum_Oki</span><span class="op">$</span><span class="va">Chr1</span><span class="op">$</span><span class="va">contig</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>    <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">contigsToMerge_end</span>    <span class="op">&lt;-</span>     <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="fu">seqlengths</span><span class="op">(</span><span class="va">coa</span><span class="op">$</span><span class="va">Oki_Kum</span><span class="op">$</span><span class="va">query</span><span class="op">)</span><span class="op">[</span><span class="va">scafs</span><span class="op">$</span><span class="va">Kum_Oki</span><span class="op">$</span><span class="va">Chr1</span><span class="op">$</span><span class="va">contig</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">contigsToMerge_oldPos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="fu">IRanges</span><span class="op">(</span><span class="va">contigsToMerge_start</span>, <span class="va">contigsToMerge_end</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">contigsToMerge_oldPos</span><span class="op">)</span>  <span class="op">&lt;-</span> <span class="va">scafs</span><span class="op">$</span><span class="va">Kum_Oki</span><span class="op">$</span><span class="va">Chr1</span><span class="op">$</span><span class="va">contig</span></span>
<span><span class="va">contigsToMerge_oldPos</span></span></code></pre></div>
<pre><code><span><span class="co">## GRanges object with 6 ranges and 0 metadata columns:</span></span>
<span><span class="co">##               seqnames            ranges strand</span></span>
<span><span class="co">##                  &lt;Rle&gt;         &lt;IRanges&gt;  &lt;Rle&gt;</span></span>
<span><span class="co">##   contig_27_1     chr1         1-4780084      *</span></span>
<span><span class="co">##   contig_90_1     chr1   4780085-7534138      *</span></span>
<span><span class="co">##    contig_3_1     chr1  7534139-12219121      *</span></span>
<span><span class="co">##   contig_88_1     chr1 12219122-13349956      *</span></span>
<span><span class="co">##   contig_87_1     chr1 13349957-13492925      *</span></span>
<span><span class="co">##   contig_63_1     chr1 13492926-13839560      *</span></span>
<span><span class="co">##   -------</span></span>
<span><span class="co">##   seqinfo: 1 sequence from an unspecified genome; no seqlengths</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">annot</span> <span class="op">&lt;-</span> <span class="fu">genoPlotR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/genoPlotR/man/annotation.html" class="external-link">annotation</a></span><span class="op">(</span>x1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/start.html" class="external-link">start</a></span><span class="op">(</span><span class="va">contigsToMerge_oldPos</span><span class="op">)</span>, x2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/start.html" class="external-link">end</a></span><span class="op">(</span><span class="va">contigsToMerge_oldPos</span><span class="op">)</span>, text<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">contigsToMerge_oldPos</span><span class="op">)</span>, rot<span class="op">=</span><span class="fl">30</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gbs</span><span class="op">$</span><span class="va">Oki_Kum</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/swap.html" class="external-link">swap</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/scaffoldByFlipAndMerge.html" class="external-link">scaffoldByFlipAndMerge</a></span><span class="op">(</span><span class="va">scafs</span><span class="op">$</span><span class="va">Kum_Oki</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/plotApairOfChrs.html" class="external-link">plotApairOfChrs</a></span><span class="op">(</span>dna_seg_scale<span class="op">=</span><span class="cn">TRUE</span>, annotations <span class="op">=</span> <span class="va">annot</span><span class="op">)</span></span></code></pre></div>
<p><img src="KumeScaffolding_files/figure-html/Kum_chr1_assembly_4-1.png" width="960"></p>
</div>
<div class="section level3">
<h3 id="chromosome-2">Chromosome 2<a class="anchor" aria-label="anchor" href="#chromosome-2"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Oki_Kum_Chr2</span> <span class="op">&lt;-</span> <span class="va">gbs</span><span class="op">$</span><span class="va">Oki_Kum</span> <span class="op">|&gt;</span> <span class="fu">plyranges</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">seqnames</span> <span class="op">==</span> <span class="st">"chr2"</span><span class="op">)</span></span>
<span><span class="fu">seqlevels</span><span class="op">(</span><span class="va">Oki_Kum_Chr2</span><span class="op">)</span>       <span class="op">&lt;-</span> <span class="fu">seqlevelsInUse</span><span class="op">(</span><span class="va">Oki_Kum_Chr2</span><span class="op">)</span></span>
<span><span class="fu">seqlevels</span><span class="op">(</span><span class="va">Oki_Kum_Chr2</span><span class="op">$</span><span class="va">query</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">seqlevelsInUse</span><span class="op">(</span><span class="va">Oki_Kum_Chr2</span><span class="op">$</span><span class="va">query</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/makeOxfordPlots.html" class="external-link">makeOxfordPlots</a></span><span class="op">(</span><span class="va">Oki_Kum_Chr2</span>, col<span class="op">=</span><span class="st">'strand'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Everything from KUM-M3 that matches Oki's Chr2"</span><span class="op">)</span></span></code></pre></div>
<p><img src="KumeScaffolding_files/figure-html/Oki_Kum_sc_chr2_1-1.png" width="960"></p>
<p>Let’s remove the contigs that have their main match elsewhere.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Oki_Kum_Chr2</span><span class="op">[</span><span class="fu">seqnames</span><span class="op">(</span><span class="va">Oki_Kum_Chr2</span><span class="op">$</span><span class="va">query</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu">seqlevels</span><span class="op">(</span><span class="va">Oki_Kum_Chr2</span><span class="op">$</span><span class="va">query</span><span class="op">)</span><span class="op">[</span><span class="fu">QTcoverage</span><span class="op">(</span><span class="va">Oki_Kum_Chr2</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">0.5</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="fu">seqlevels</span><span class="op">(</span><span class="va">Oki_Kum_Chr2</span><span class="op">$</span><span class="va">query</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">seqlevelsInUse</span><span class="op">(</span><span class="va">Oki_Kum_Chr2</span><span class="op">$</span><span class="va">query</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/makeOxfordPlots.html" class="external-link">makeOxfordPlots</a></span><span class="op">(</span><span class="va">Oki_Kum_Chr2</span>, col<span class="op">=</span><span class="st">'strand'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Main hits from KUM-M3 to OKI's Chr2"</span><span class="op">)</span></span></code></pre></div>
<p><img src="KumeScaffolding_files/figure-html/Oki_Kum_sc_chr2_2-1.png" width="960"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scafs</span><span class="op">$</span><span class="va">Kum_Oki</span><span class="op">[[</span><span class="st">"Chr2"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  contig <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"contig_36_1"</span>, <span class="st">"contig_16_1"</span>, <span class="st">"contig_24_1"</span>, <span class="st">"contig_79_1"</span>, <span class="st">"contig_37_1"</span>, <span class="st">"contig_81_1"</span><span class="op">)</span>,</span>
<span>  orientation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">contigsToMerge_start</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="fu">seqlengths</span><span class="op">(</span><span class="va">gbs</span><span class="op">$</span><span class="va">Oki_Kum</span><span class="op">$</span><span class="va">query</span><span class="op">)</span><span class="op">[</span><span class="va">scafs</span><span class="op">$</span><span class="va">Kum_Oki</span><span class="op">$</span><span class="va">Chr2</span><span class="op">$</span><span class="va">contig</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>    <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">contigsToMerge_end</span>    <span class="op">&lt;-</span>     <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="fu">seqlengths</span><span class="op">(</span><span class="va">coa</span><span class="op">$</span><span class="va">Oki_Kum</span><span class="op">$</span><span class="va">query</span><span class="op">)</span><span class="op">[</span><span class="va">scafs</span><span class="op">$</span><span class="va">Kum_Oki</span><span class="op">$</span><span class="va">Chr2</span><span class="op">$</span><span class="va">contig</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">contigsToMerge_oldPos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></span><span class="op">(</span><span class="st">"chr2"</span>, <span class="fu">IRanges</span><span class="op">(</span><span class="va">contigsToMerge_start</span>, <span class="va">contigsToMerge_end</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">contigsToMerge_oldPos</span><span class="op">)</span>  <span class="op">&lt;-</span> <span class="va">scafs</span><span class="op">$</span><span class="va">Kum_Oki</span><span class="op">$</span><span class="va">Chr2</span><span class="op">$</span><span class="va">contig</span></span>
<span><span class="va">contigsToMerge_oldPos</span></span></code></pre></div>
<pre><code><span><span class="co">## GRanges object with 6 ranges and 0 metadata columns:</span></span>
<span><span class="co">##               seqnames            ranges strand</span></span>
<span><span class="co">##                  &lt;Rle&gt;         &lt;IRanges&gt;  &lt;Rle&gt;</span></span>
<span><span class="co">##   contig_36_1     chr2          1-319811      *</span></span>
<span><span class="co">##   contig_16_1     chr2    319812-5523357      *</span></span>
<span><span class="co">##   contig_24_1     chr2   5523358-9335672      *</span></span>
<span><span class="co">##   contig_79_1     chr2  9335673-12065686      *</span></span>
<span><span class="co">##   contig_37_1     chr2 12065687-12853372      *</span></span>
<span><span class="co">##   contig_81_1     chr2 12853373-15214355      *</span></span>
<span><span class="co">##   -------</span></span>
<span><span class="co">##   seqinfo: 1 sequence from an unspecified genome; no seqlengths</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">annot</span> <span class="op">&lt;-</span> <span class="fu">genoPlotR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/genoPlotR/man/annotation.html" class="external-link">annotation</a></span><span class="op">(</span>x1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/start.html" class="external-link">start</a></span><span class="op">(</span><span class="va">contigsToMerge_oldPos</span><span class="op">)</span>, x2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/start.html" class="external-link">end</a></span><span class="op">(</span><span class="va">contigsToMerge_oldPos</span><span class="op">)</span>, text<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">contigsToMerge_oldPos</span><span class="op">)</span>, rot<span class="op">=</span><span class="fl">30</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gbs</span><span class="op">$</span><span class="va">Oki_Kum</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/swap.html" class="external-link">swap</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/scaffoldByFlipAndMerge.html" class="external-link">scaffoldByFlipAndMerge</a></span><span class="op">(</span><span class="va">scafs</span><span class="op">$</span><span class="va">Kum_Oki</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/plotApairOfChrs.html" class="external-link">plotApairOfChrs</a></span><span class="op">(</span>chrT <span class="op">=</span> <span class="st">'Chr2'</span>, dna_seg_scale<span class="op">=</span><span class="cn">TRUE</span>, annotations <span class="op">=</span> <span class="va">annot</span><span class="op">)</span></span></code></pre></div>
<p><img src="KumeScaffolding_files/figure-html/Kum_chr2_contigs_to_merge-1.png" width="960"></p>
</div>
<div class="section level3">
<h3 id="par">PAR<a class="anchor" aria-label="anchor" href="#par"></a>
</h3>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Oki_Kum_PAR</span> <span class="op">&lt;-</span> <span class="va">gbs</span><span class="op">$</span><span class="va">Oki_Kum</span> <span class="op">|&gt;</span> <span class="fu">plyranges</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">seqnames</span> <span class="op">==</span> <span class="st">"PAR"</span><span class="op">)</span></span>
<span><span class="fu">seqlevels</span><span class="op">(</span><span class="va">Oki_Kum_PAR</span><span class="op">)</span>       <span class="op">&lt;-</span> <span class="fu">seqlevelsInUse</span><span class="op">(</span><span class="va">Oki_Kum_PAR</span><span class="op">)</span></span>
<span><span class="fu">seqlevels</span><span class="op">(</span><span class="va">Oki_Kum_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">seqlevelsInUse</span><span class="op">(</span><span class="va">Oki_Kum_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/makeOxfordPlots.html" class="external-link">makeOxfordPlots</a></span><span class="op">(</span><span class="va">Oki_Kum_PAR</span>, col<span class="op">=</span><span class="st">'strand'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Everything from KUM-M3 that matches OKI's PAR"</span><span class="op">)</span></span></code></pre></div>
<p><img src="KumeScaffolding_files/figure-html/Oki_Kum_sc_PAR_1-1.png" width="960"></p>
<p>Let’s remove the contigs that have their main match elsewhere.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Oki_Kum_PAR</span><span class="op">[</span><span class="fu">seqnames</span><span class="op">(</span><span class="va">Oki_Kum_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu">seqlevels</span><span class="op">(</span><span class="va">Oki_Kum_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span><span class="op">[</span><span class="fu">QTcoverage</span><span class="op">(</span><span class="va">Oki_Kum_PAR</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">0.5</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="fu">seqlevels</span><span class="op">(</span><span class="va">Oki_Kum_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">seqlevelsInUse</span><span class="op">(</span><span class="va">Oki_Kum_PAR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/makeOxfordPlots.html" class="external-link">makeOxfordPlots</a></span><span class="op">(</span><span class="va">Oki_Kum_PAR</span>, col<span class="op">=</span><span class="st">'strand'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Main hits from KUM-M3 to OKI's PAR"</span><span class="op">)</span></span></code></pre></div>
<p><img src="KumeScaffolding_files/figure-html/Oki_Kum_sc_PAR_2-1.png" width="960"></p>
<p>Let’s flip things around a little to get things as linear as they can
be:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/makeOxfordPlots.html" class="external-link">makeOxfordPlots</a></span><span class="op">(</span> <span class="fu">flipContigsForOxfordPlot</span><span class="op">(</span><span class="va">Oki_Kum_PAR</span>, flip_which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'contig_12_1'</span>, <span class="st">'contig_43_1'</span><span class="op">)</span><span class="op">)</span>, col<span class="op">=</span><span class="st">'strand'</span><span class="op">)</span>  <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"KUM-M3 contigs scaffolded and reoriented to PAR"</span><span class="op">)</span></span></code></pre></div>
<p><img src="KumeScaffolding_files/figure-html/Oki_Kum_sc_PAR_3-1.png" width="960"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scafs</span><span class="op">$</span><span class="va">Kum_Oki</span><span class="op">[[</span><span class="st">"PAR"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  contig <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'contig_13_1'</span>, <span class="st">'contig_12_1'</span>, <span class="st">'contig_41_1'</span>, <span class="st">'contig_43_1'</span>, <span class="st">'contig_82_1'</span>, <span class="st">'contig_89_1'</span>, <span class="st">'contig_85_1'</span>, <span class="st">'contig_28_1'</span>, <span class="st">'contig_91_1'</span><span class="op">)</span>,</span>
<span>  orientation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">contigsToMerge_start</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="fu">seqlengths</span><span class="op">(</span><span class="va">gbs</span><span class="op">$</span><span class="va">Oki_Kum</span><span class="op">$</span><span class="va">query</span><span class="op">)</span><span class="op">[</span><span class="va">scafs</span><span class="op">$</span><span class="va">Kum_Oki</span><span class="op">$</span><span class="va">PAR</span><span class="op">$</span><span class="va">contig</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>    <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">contigsToMerge_end</span>    <span class="op">&lt;-</span>     <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="fu">seqlengths</span><span class="op">(</span><span class="va">coa</span><span class="op">$</span><span class="va">Oki_Kum</span><span class="op">$</span><span class="va">query</span><span class="op">)</span><span class="op">[</span><span class="va">scafs</span><span class="op">$</span><span class="va">Kum_Oki</span><span class="op">$</span><span class="va">PAR</span><span class="op">$</span><span class="va">contig</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">contigsToMerge_oldPos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></span><span class="op">(</span><span class="st">"chr2"</span>, <span class="fu">IRanges</span><span class="op">(</span><span class="va">contigsToMerge_start</span>, <span class="va">contigsToMerge_end</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">contigsToMerge_oldPos</span><span class="op">)</span>  <span class="op">&lt;-</span> <span class="va">scafs</span><span class="op">$</span><span class="va">Kum_Oki</span><span class="op">$</span><span class="va">PAR</span><span class="op">$</span><span class="va">contig</span></span>
<span><span class="va">contigsToMerge_oldPos</span></span></code></pre></div>
<pre><code><span><span class="co">## GRanges object with 9 ranges and 0 metadata columns:</span></span>
<span><span class="co">##               seqnames            ranges strand</span></span>
<span><span class="co">##                  &lt;Rle&gt;         &lt;IRanges&gt;  &lt;Rle&gt;</span></span>
<span><span class="co">##   contig_13_1     chr2          1-793614      *</span></span>
<span><span class="co">##   contig_12_1     chr2    793615-3150936      *</span></span>
<span><span class="co">##   contig_41_1     chr2   3150937-5762928      *</span></span>
<span><span class="co">##   contig_43_1     chr2   5762929-6604164      *</span></span>
<span><span class="co">##   contig_82_1     chr2   6604165-8926783      *</span></span>
<span><span class="co">##   contig_89_1     chr2   8926784-9168286      *</span></span>
<span><span class="co">##   contig_85_1     chr2   9168287-9596337      *</span></span>
<span><span class="co">##   contig_28_1     chr2  9596338-16011565      *</span></span>
<span><span class="co">##   contig_91_1     chr2 16011566-16138340      *</span></span>
<span><span class="co">##   -------</span></span>
<span><span class="co">##   seqinfo: 1 sequence from an unspecified genome; no seqlengths</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">annot</span> <span class="op">&lt;-</span> <span class="fu">genoPlotR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/genoPlotR/man/annotation.html" class="external-link">annotation</a></span><span class="op">(</span>x1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/start.html" class="external-link">start</a></span><span class="op">(</span><span class="va">contigsToMerge_oldPos</span><span class="op">)</span>, x2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/start.html" class="external-link">end</a></span><span class="op">(</span><span class="va">contigsToMerge_oldPos</span><span class="op">)</span>, text<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">contigsToMerge_oldPos</span><span class="op">)</span>, rot<span class="op">=</span><span class="fl">30</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gbs</span><span class="op">$</span><span class="va">Oki_Kum</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/swap.html" class="external-link">swap</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/scaffoldByFlipAndMerge.html" class="external-link">scaffoldByFlipAndMerge</a></span><span class="op">(</span><span class="va">scafs</span><span class="op">$</span><span class="va">Kum_Oki</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/plotApairOfChrs.html" class="external-link">plotApairOfChrs</a></span><span class="op">(</span>chrT <span class="op">=</span> <span class="st">'PAR'</span>, dna_seg_scale<span class="op">=</span><span class="cn">TRUE</span>, annotations <span class="op">=</span> <span class="va">annot</span><span class="op">)</span></span></code></pre></div>
<p><img src="KumeScaffolding_files/figure-html/Kum_PAR_contigs_to_merge-1.png" width="960"></p>
</div>
<div class="section level3">
<h3 id="xsr">XSR<a class="anchor" aria-label="anchor" href="#xsr"></a>
</h3>
<p>XSR is already complete.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Oki_Kum_XSR</span> <span class="op">&lt;-</span> <span class="va">gbs</span><span class="op">$</span><span class="va">Oki_Kum</span> <span class="op">|&gt;</span> <span class="fu">plyranges</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">seqnames</span> <span class="op">==</span> <span class="st">"XSR"</span><span class="op">)</span></span>
<span><span class="fu">seqlevels</span><span class="op">(</span><span class="va">Oki_Kum_XSR</span><span class="op">)</span>       <span class="op">&lt;-</span> <span class="fu">seqlevelsInUse</span><span class="op">(</span><span class="va">Oki_Kum_XSR</span><span class="op">)</span></span>
<span><span class="fu">seqlevels</span><span class="op">(</span><span class="va">Oki_Kum_XSR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">seqlevelsInUse</span><span class="op">(</span><span class="va">Oki_Kum_XSR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/makeOxfordPlots.html" class="external-link">makeOxfordPlots</a></span><span class="op">(</span><span class="va">Oki_Kum_XSR</span>, col<span class="op">=</span><span class="st">'strand'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Everything from KUM-M3 that matches OKI's XSR"</span><span class="op">)</span></span></code></pre></div>
<p><img src="KumeScaffolding_files/figure-html/Oki_Kum_sc_XSR_1-1.png" width="960"></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scafs</span><span class="op">$</span><span class="va">Kum_Oki</span><span class="op">[[</span><span class="st">"XSR"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  contig <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'contig_42_1'</span><span class="op">)</span>,</span>
<span>  orientation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="ysr">YSR<a class="anchor" aria-label="anchor" href="#ysr"></a>
</h3>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Oki_Kum_YSR</span> <span class="op">&lt;-</span> <span class="va">gbs</span><span class="op">$</span><span class="va">Oki_Kum</span> <span class="op">|&gt;</span> <span class="fu">plyranges</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">seqnames</span> <span class="op">==</span> <span class="st">"YSR"</span><span class="op">)</span></span>
<span><span class="fu">seqlevels</span><span class="op">(</span><span class="va">Oki_Kum_YSR</span><span class="op">)</span>       <span class="op">&lt;-</span> <span class="fu">seqlevelsInUse</span><span class="op">(</span><span class="va">Oki_Kum_YSR</span><span class="op">)</span></span>
<span><span class="fu">seqlevels</span><span class="op">(</span><span class="va">Oki_Kum_YSR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">seqlevelsInUse</span><span class="op">(</span><span class="va">Oki_Kum_YSR</span><span class="op">$</span><span class="va">query</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/makeOxfordPlots.html" class="external-link">makeOxfordPlots</a></span><span class="op">(</span><span class="va">Oki_Kum_YSR</span>, col<span class="op">=</span><span class="st">'strand'</span><span class="op">)</span></span></code></pre></div>
<p><img src="KumeScaffolding_files/figure-html/Oki_Kum_sc_ysr-1.png" width="960"></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scafs</span><span class="op">$</span><span class="va">Kum_Oki</span><span class="op">[[</span><span class="st">"YSR"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  contig <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'contig_29_1'</span><span class="op">)</span>,</span>
<span>  orientation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="bringing-it-together">Bringing it together<a class="anchor" aria-label="anchor" href="#bringing-it-together"></a>
</h3>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Store the results in the package for re-use in other vignettes</span></span>
<span><span class="co"># usethis::use_data(scafs, overwrite = TRUE)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">scafs</span><span class="op">$</span><span class="va">Kum_Oki</span>, <span class="fu">OikScrambling</span><span class="fu">::</span><span class="va"><a href="../reference/scafs.html">scafs</a></span><span class="op">$</span><span class="va">Kum_Oki</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scaf_Kum_Oki</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/scaffoldByFlipAndMerge.html" class="external-link">scaffoldByFlipAndMerge</a></span><span class="op">(</span><span class="va">gbs</span><span class="op">$</span><span class="va">Oki_Kum</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/swap.html" class="external-link">swap</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">scafs</span><span class="op">$</span><span class="va">Kum_Oki</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/swap.html" class="external-link">swap</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">scaf_Kum_Oki</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/makeOxfordPlots.html" class="external-link">makeOxfordPlots</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="KumeScaffolding_files/figure-html/Oki_Kum_sc_all_1-1.png" width="960"></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Original plot for comparison</span></span>
<span><span class="va">gbs</span><span class="op">$</span><span class="va">Oki_Kum</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/makeOxfordPlots.html" class="external-link">makeOxfordPlots</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="KumeScaffolding_files/figure-html/Oki_Kum_sc_all_1-2.png" width="960"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Aleksandra Bliznina, Michael Mansfield, Charles Plessy.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
