<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Width of the aligned and mapped regions. • OikScrambling</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Width of the aligned and mapped regions.">
<meta property="og:description" content="OikScrambling">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">OikScrambling</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">5.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/OikScrambling.html">Get started</a>
</li>
<li>
  <a href="../articles/LoadGenomicBreaks.html">Data load</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Supplemental material
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/OxfordPlots.html">Figure 1A DNA line plots</a>
    </li>
    <li>
      <a href="../articles/ParallelPlots.html">Figure 1B chromosome parallel plots</a>
    </li>
    <li>
      <a href="../articles/DistanceMeasures.html">Table 1 scrambling index</a>
    </li>
    <li>
      <a href="../articles/ChromosomePlots.html">Figure 5 genome-wide feature patterns</a>
    </li>
    <li>
      <a href="../articles/SquareWindowPlots.html">Figure 7 DNA line plots</a>
    </li>
    <li>
      <a href="../articles/ScalingBreakpoints.html">Figure 7 breakpoint number barplots</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/CNEs.html">Conserved non-coding elements</a>
    </li>
    <li>
      <a href="../articles/ChromosomePlots.html">Chromosome-scale feature density plots</a>
    </li>
    <li>
      <a href="../articles/CoalescingCutoffs.html">Modifying coalescent cutoffs</a>
    </li>
    <li>
      <a href="../articles/ColinearityInterruptors.html">Regions interrupting colinearity</a>
    </li>
    <li>
      <a href="../articles/DistanceMeasures.html">Distance Measures</a>
    </li>
    <li>
      <a href="../articles/GenomicFeatures.html">Genomic features of the breakpoints</a>
    </li>
    <li>
      <a href="../articles/GenomicHeatmaps.html">Genomic features of the breakpoints (heatmaps)</a>
    </li>
    <li>
      <a href="../articles/Inversions.html">Inversions</a>
    </li>
    <li>
      <a href="../articles/LoadGenomicBreaks.html">Load genomic break data</a>
    </li>
    <li>
      <a href="../articles/OperonConservation.html">Operon conservation analysis</a>
    </li>
    <li>
      <a href="../articles/OrthogroupSyntenies.html">Orthogroup syntenies</a>
    </li>
    <li>
      <a href="../articles/OxfordPlots.html">Alignment line plots, whole genomes</a>
    </li>
    <li>
      <a href="../articles/PAC3.html">Region of interest: PAC3</a>
    </li>
    <li>
      <a href="../articles/PWM.html">Motif search and analysis</a>
    </li>
    <li>
      <a href="../articles/ParallelPlots.html">Whole-chromosome parallel plots</a>
    </li>
    <li>
      <a href="../articles/RegionWidths.html">Width of the aligned and mapped regions.</a>
    </li>
    <li>
      <a href="../articles/RegionsOfInterest.html">Regions of interest</a>
    </li>
    <li>
      <a href="../articles/RepeatRegions.html">Repeat regions</a>
    </li>
    <li>
      <a href="../articles/ScalingBreakpoints.html">Scaling breakpoints</a>
    </li>
    <li>
      <a href="../articles/SegmentMovements.html">Segment movement distances</a>
    </li>
    <li>
      <a href="../articles/SquareWindowPlots.html">Alignment line plots, 10×10 Mbp windows</a>
    </li>
    <li>
      <a href="../articles/TFBS.html">Transcription factor binding sites</a>
    </li>
    <li>
      <a href="../articles/TandemSiteDuplications.html">Tandem site duplications</a>
    </li>
    <li>
      <a href="../articles/Translocations.html">Translocations</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/oist/LuscombeU_OikScrambling/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Width of the aligned and mapped regions.</h1>
                        <h4 data-toc-skip class="author">Charles
Plessy</h4>
            
            <h4 data-toc-skip class="date">13 October, 2023</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/oist/LuscombeU_OikScrambling/blob/HEAD/vignettes/RegionWidths.Rmd" class="external-link"><code>vignettes/RegionWidths.Rmd</code></a></small>
      <div class="hidden name"><code>RegionWidths.Rmd</code></div>

    </div>

    
    
<style type="text/css">
pre, code {white-space:pre !important; overflow-x:auto}
</style>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html" class="external-link">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>cache <span class="op">=</span> <span class="cn">TRUE</span>, cache.lazy <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="load-r-pacakges-and-data">Load R pacakges and data<a class="anchor" aria-label="anchor" href="#load-r-pacakges-and-data"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/oist/LuscombeU_OikScrambling" class="external-link">'OikScrambling'</a></span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">'ggplot2'</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">'patchwork'</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">genomes</span> <span class="op">&lt;-</span> <span class="fu">OikScrambling</span><span class="fu">:::</span><span class="fu"><a href="../reference/loadAllGenomes.html">loadAllGenomes</a></span><span class="op">(</span>compat <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in runHook(".onLoad", env, package.lib, package): input string 'Génoscope' cannot be translated from 'ANSI_X3.4-1968' to UTF-8, but is valid UTF-8</span></span>
<span></span>
<span><span class="co">## Warning in runHook(".onLoad", env, package.lib, package): input string 'Génoscope' cannot be translated from 'ANSI_X3.4-1968' to UTF-8, but is valid UTF-8</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"BreakPoints.Rdata"</span><span class="op">)</span></span>
<span><span class="va">ces</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"CEs.Rds"</span><span class="op">)</span></span></code></pre></div>
<p>See
<code><a href="../articles/LoadGenomicBreaks.html">vignette("LoadGenomicBreaks", package = "OikScrambling")</a></code>
for how the different GBreaks objects are prepared.</p>
</div>
<div class="section level2">
<h2 id="precompute-widths">Precompute widths<a class="anchor" aria-label="anchor" href="#precompute-widths"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">widths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/SimpleList-class.html" class="external-link">SimpleList</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">makeWidthsDF</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">objList</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">objList</span><span class="op">)</span>, \<span class="op">(</span><span class="va">name</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">DF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">mcols</a></span><span class="op">(</span><span class="va">objList</span><span class="op">[[</span><span class="va">name</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">DF</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html" class="external-link">DataFrame</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">DF</span><span class="op">$</span><span class="va">Arm</span><span class="op">)</span>   <span class="op">)</span> <span class="va">DF</span><span class="op">$</span><span class="va">Arm</span>     <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">DF</span><span class="op">$</span><span class="va">flag</span><span class="op">)</span><span class="op">)</span>   <span class="va">DF</span><span class="op">$</span><span class="va">flag</span>    <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">DF</span><span class="op">$</span><span class="va">nonCoa</span><span class="op">)</span><span class="op">)</span> <span class="va">DF</span><span class="op">$</span><span class="va">nonCoa</span>  <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>    <span class="va">DF</span><span class="op">$</span><span class="va">name</span>  <span class="op">&lt;-</span> <span class="va">name</span></span>
<span>    <span class="va">DF</span><span class="op">$</span><span class="va">width</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/start.html" class="external-link">width</a></span><span class="op">(</span><span class="va">objList</span><span class="op">[[</span><span class="va">name</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">DF</span><span class="op">$</span><span class="va">chr</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomeInfoDb/man/seqinfo.html" class="external-link">seqnames</a></span><span class="op">(</span><span class="va">objList</span><span class="op">[[</span><span class="va">name</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>pat <span class="op">=</span> <span class="st">"Chr"</span>,    rep <span class="op">=</span> <span class="st">"chr"</span><span class="op">)</span>    <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>pat <span class="op">=</span> <span class="st">"BNJZ.*"</span>, rep <span class="op">=</span> <span class="st">"Ply"</span><span class="op">)</span>    <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>pat <span class="op">=</span> <span class="st">"BNKA.*"</span>, rep <span class="op">=</span> <span class="st">"Ros"</span><span class="op">)</span>    <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>pat <span class="op">=</span> <span class="st">"BJTB.*"</span>, rep <span class="op">=</span> <span class="st">"Rob"</span><span class="op">)</span>    <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>pat <span class="op">=</span> <span class="st">"^R.*"</span>,   rep <span class="op">=</span> <span class="st">"Sav"</span><span class="op">)</span>    <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>pat <span class="op">=</span> <span class="st">"^2L$"</span>,   rep <span class="op">=</span> <span class="st">"Dro"</span><span class="op">)</span>    <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>pat <span class="op">=</span> <span class="st">"^2R$"</span>,   rep <span class="op">=</span> <span class="st">"Dro"</span><span class="op">)</span>    <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>pat <span class="op">=</span> <span class="st">"^3L$"</span>,   rep <span class="op">=</span> <span class="st">"Dro"</span><span class="op">)</span>    <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>pat <span class="op">=</span> <span class="st">"^3R$"</span>,   rep <span class="op">=</span> <span class="st">"Dro"</span><span class="op">)</span>    <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>pat <span class="op">=</span> <span class="st">"^4$"</span>,    rep <span class="op">=</span> <span class="st">"Dro"</span><span class="op">)</span>    <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>pat <span class="op">=</span> <span class="st">"^X$"</span>,    rep <span class="op">=</span> <span class="st">"Dro"</span><span class="op">)</span>    <span class="op">|&gt;</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>pat <span class="op">=</span> <span class="st">"^Y$"</span>,    rep <span class="op">=</span> <span class="st">"Dro"</span><span class="op">)</span>   </span>
<span></span>
<span>    <span class="va">DF</span><span class="op">$</span><span class="va">query</span> <span class="op">&lt;-</span> <span class="va">DF</span><span class="op">$</span><span class="va">score</span> <span class="op">&lt;-</span> <span class="va">DF</span><span class="op">$</span><span class="va">rep</span> <span class="op">&lt;-</span> <span class="va">DF</span><span class="op">$</span><span class="va">repOvlp</span> <span class="op">&lt;-</span> <span class="va">DF</span><span class="op">$</span><span class="va">transcripts</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>    <span class="va">DF</span><span class="op">$</span><span class="va">dist</span>  <span class="op">&lt;-</span> <span class="fu">OikScrambling</span><span class="fu">:::</span><span class="fu"><a href="../reference/compDistance.html">compDistance</a></span><span class="op">(</span><span class="va">DF</span><span class="op">$</span><span class="va">name</span><span class="op">)</span></span>
<span>    <span class="va">DF</span><span class="op">$</span><span class="va">distS</span> <span class="op">&lt;-</span> <span class="fu">OikScrambling</span><span class="fu">:::</span><span class="fu"><a href="../reference/compDistance.html">compDistance</a></span><span class="op">(</span><span class="va">DF</span><span class="op">$</span><span class="va">name</span>, short <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="va">DF</span><span class="op">$</span><span class="va">genus</span> <span class="op">&lt;-</span> <span class="fu">OikScrambling</span><span class="fu">:::</span><span class="fu"><a href="../reference/compGenus.html">compGenus</a></span><span class="op">(</span><span class="va">DF</span><span class="op">$</span><span class="va">name</span><span class="op">)</span></span>
<span>    <span class="va">DF</span><span class="op">$</span><span class="va">class</span> <span class="op">&lt;-</span> <span class="fu">OikScrambling</span><span class="fu">:::</span><span class="fu"><a href="../reference/compDistClass.html">compDistClass</a></span><span class="op">(</span><span class="va">DF</span><span class="op">$</span><span class="va">name</span><span class="op">)</span></span>
<span>    <span class="va">DF</span></span>
<span>  <span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/do.call.html" class="external-link">do.call</a></span><span class="op">(</span>what<span class="op">=</span><span class="va">rbind</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">isol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">gbs</span>, \<span class="op">(</span><span class="va">gb</span><span class="op">)</span> <span class="va">gb</span><span class="op">[</span><span class="va">gb</span><span class="op">$</span><span class="va">nonCoa</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/SimpleList-class.html" class="external-link">SimpleList</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">widths</span><span class="op">$</span><span class="va">gbs</span>     <span class="op">&lt;-</span> <span class="fu">makeWidthsDF</span><span class="op">(</span><span class="va">gbs</span><span class="op">)</span>     <span class="op">|&gt;</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">widths</span><span class="op">$</span><span class="va">isol</span>    <span class="op">&lt;-</span> <span class="fu">makeWidthsDF</span><span class="op">(</span><span class="va">isol</span><span class="op">)</span>    <span class="op">|&gt;</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">widths</span><span class="op">$</span><span class="va">unal</span>    <span class="op">&lt;-</span> <span class="fu">makeWidthsDF</span><span class="op">(</span><span class="va">unal</span><span class="op">)</span>    <span class="op">|&gt;</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">widths</span><span class="op">$</span><span class="va">coa</span>     <span class="op">&lt;-</span> <span class="fu">makeWidthsDF</span><span class="op">(</span><span class="va">coa</span><span class="op">)</span>     <span class="op">|&gt;</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">widths</span><span class="op">$</span><span class="va">unmap</span>   <span class="op">&lt;-</span> <span class="fu">makeWidthsDF</span><span class="op">(</span><span class="va">unmap</span><span class="op">)</span>   <span class="op">|&gt;</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">widths</span><span class="op">$</span><span class="va">bri</span>     <span class="op">&lt;-</span> <span class="fu">makeWidthsDF</span><span class="op">(</span><span class="va">bri</span><span class="op">)</span>     <span class="op">|&gt;</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">widths</span><span class="op">$</span><span class="va">tra</span>     <span class="op">&lt;-</span> <span class="fu">makeWidthsDF</span><span class="op">(</span><span class="va">tra</span><span class="op">)</span>     <span class="op">|&gt;</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">widths</span><span class="op">$</span><span class="va">tra2</span>    <span class="op">&lt;-</span> <span class="fu">makeWidthsDF</span><span class="op">(</span><span class="va">tra2</span><span class="op">)</span>    <span class="op">|&gt;</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">widths</span><span class="op">$</span><span class="va">coa2</span>    <span class="op">&lt;-</span> <span class="fu">makeWidthsDF</span><span class="op">(</span><span class="va">coa2</span><span class="op">)</span>    <span class="op">|&gt;</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">names_table</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  pairnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Factor-class.html" class="external-link">levels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">gbs</span><span class="op">$</span><span class="va">name</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  class     <span class="op">=</span> <span class="fu">OikScrambling</span><span class="fu">:::</span><span class="fu"><a href="../reference/compDistClass.html">compDistClass</a></span><span class="op">(</span><span class="va">pairnames</span><span class="op">)</span>,</span>
<span>  distS     <span class="op">=</span> <span class="fu">OikScrambling</span><span class="fu">:::</span><span class="fu"><a href="../reference/compDistance.html">compDistance</a></span><span class="op">(</span><span class="va">pairnames</span>, short <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  target    <span class="op">=</span> <span class="va">pairnames</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>pat<span class="op">=</span><span class="st">"_.*"</span>, rep<span class="op">=</span><span class="st">""</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  query     <span class="op">=</span> <span class="va">pairnames</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>pat<span class="op">=</span><span class="st">".*_"</span>, rep<span class="op">=</span><span class="st">""</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plot-all-width-distributions">Plot all width distributions<a class="anchor" aria-label="anchor" href="#plot-all-width-distributions"></a>
</h2>
<p>This is useful to verify by eye that collections of distributions in
the same distance group resemble each other.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gg_freq_poly</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">tibble</span>, <span class="va">bins</span> <span class="op">=</span> <span class="fl">30</span>, <span class="va">binwidth</span> <span class="op">=</span> <span class="fl">30</span>, <span class="va">scale</span> <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tibble</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">scale</span> <span class="op">==</span> <span class="st">"log"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> </span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_freqpoly</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="va">bins</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_freqpoly</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="va">binwidth</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">p</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">w_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">gbs</span>     <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span><span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>what <span class="op">=</span> <span class="st">"aligned"</span><span class="op">)</span>,</span>
<span>              <span class="va">widths</span><span class="op">$</span><span class="va">isol</span>    <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span><span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>what <span class="op">=</span> <span class="st">"isolated"</span><span class="op">)</span>,</span>
<span>              <span class="va">widths</span><span class="op">$</span><span class="va">unal</span>    <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span><span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>what <span class="op">=</span> <span class="st">"unaligned"</span><span class="op">)</span>,</span>
<span>              <span class="va">widths</span><span class="op">$</span><span class="va">coa</span>     <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span><span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>what <span class="op">=</span> <span class="st">"mapped"</span><span class="op">)</span>,</span>
<span>              <span class="va">widths</span><span class="op">$</span><span class="va">bri</span>     <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span><span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>what <span class="op">=</span> <span class="st">"bridge"</span><span class="op">)</span>,</span>
<span>              <span class="va">widths</span><span class="op">$</span><span class="va">unmap</span>   <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span><span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>what <span class="op">=</span> <span class="st">"unmaped"</span><span class="op">)</span>,</span>
<span>              <span class="va">widths</span><span class="op">$</span><span class="va">coa2</span>    <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span><span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>what <span class="op">=</span> <span class="st">"doublecoalesced"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">widths_all_tibble</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">gbs</span>     <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>what <span class="op">=</span> <span class="st">"aligned"</span><span class="op">)</span>,</span>
<span>                           <span class="va">widths</span><span class="op">$</span><span class="va">isol</span>    <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>what <span class="op">=</span> <span class="st">"isolated"</span><span class="op">)</span>,</span>
<span>                           <span class="va">widths</span><span class="op">$</span><span class="va">unal</span>    <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>what <span class="op">=</span> <span class="st">"unaligned"</span><span class="op">)</span>,</span>
<span>                           <span class="va">widths</span><span class="op">$</span><span class="va">coa</span>     <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>what <span class="op">=</span> <span class="st">"mapped"</span><span class="op">)</span>,</span>
<span>                           <span class="va">widths</span><span class="op">$</span><span class="va">bri</span>     <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>what <span class="op">=</span> <span class="st">"bridge"</span><span class="op">)</span>,</span>
<span>                           <span class="va">widths</span><span class="op">$</span><span class="va">unmap</span>   <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>what <span class="op">=</span> <span class="st">"unmaped"</span><span class="op">)</span>,</span>
<span>                           <span class="va">widths</span><span class="op">$</span><span class="va">coa2</span>    <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>what <span class="op">=</span> <span class="st">"doublecoalesced"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths_all_tibble</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">what</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of alignment width before and after collapsing"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Showing all individual distributions, to demonstrate we can pool some.</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">class</span> <span class="op">+</span> <span class="va">genus</span> <span class="op">+</span> <span class="va">distS</span> <span class="op">+</span> <span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 22514 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/width_after_processing_steps-1.png" width="1152"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Aggregating by distance class</span></span>
<span><span class="va">p_droso</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths_all_tibble</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">genus</span> <span class="op">==</span> <span class="st">"Drosophila"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">what</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">genus</span> <span class="op">+</span> <span class="va">class</span>, nrow <span class="op">=</span> <span class="fl">1</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span></span>
<span><span class="va">p_ciona</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths_all_tibble</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">genus</span> <span class="op">==</span> <span class="st">"Ciona"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">what</span><span class="op">)</span>      <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">genus</span> <span class="op">+</span> <span class="va">class</span>, nrow <span class="op">=</span> <span class="fl">1</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span></span>
<span><span class="va">p_oikop</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths_all_tibble</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">genus</span> <span class="op">==</span> <span class="st">"Oikopleura"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">what</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">genus</span> <span class="op">+</span> <span class="va">class</span>, nrow <span class="op">=</span> <span class="fl">1</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">layout</span> <span class="op">&lt;-</span> <span class="st">"</span></span>
<span><span class="st">AAAA</span></span>
<span><span class="st">BBB#</span></span>
<span><span class="st">CCC#</span></span>
<span><span class="st">"</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://patchwork.data-imaginist.com" class="external-link">"patchwork"</a></span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">p_droso</span> <span class="op">/</span> <span class="va">p_ciona</span> <span class="op">/</span> <span class="va">p_oikop</span><span class="op">)</span> <span class="op">+</span>   <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">layout</span>, guides <span class="op">=</span> <span class="st">'collect'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 914 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 10307 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 7561 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/width_after_processing_steps_by_class_and_genus-1.png" width="1152"></p>
</div>
<div class="section level2">
<h2 id="saving-width-distributions-and-some-statistics">Saving width distributions and some statistics<a class="anchor" aria-label="anchor" href="#saving-width-distributions-and-some-statistics"></a>
</h2>
<p>Below, I take the <code>widths_all_tibble</code> and perform some
statistical operations on it for later. Click below to view.</p>
<div class="section level3">
<h3 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a>
</h3>
<details><summary>
Click here to view the full table with many summary statistics for width
distributions.
</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">t_CI</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">vector</span>, <span class="va">conf.level</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">vector</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">3</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="cn">NA_character_</span><span class="op">)</span></span>
<span>  <span class="va">conf_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">vector</span>, conf.level <span class="op">=</span> <span class="va">conf.level</span><span class="op">)</span></span>
<span>  <span class="va">conf_str</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">conf_test</span><span class="op">$</span><span class="va">conf.int</span>,<span class="fl">2</span><span class="op">)</span>, collapse<span class="op">=</span><span class="st">','</span><span class="op">)</span></span>
<span>  <span class="va">conf_str</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Note that because the Wilcox test involves ranking (and therefore sorting),</span></span>
<span><span class="co"># this test is computationally demanding for large data frames.</span></span>
<span><span class="co"># It works the same as the function above - just slower.</span></span>
<span><span class="va">wilcox_CI</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">vector</span>, <span class="va">conf.level</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">vector</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">3</span><span class="op">)</span></span>
<span>     <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="cn">NA_character_</span><span class="op">)</span></span>
<span>  <span class="va">conf_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test</a></span><span class="op">(</span><span class="va">vector</span>, conf.level <span class="op">=</span> <span class="va">conf.level</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">conf_str</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">conf_test</span><span class="op">$</span><span class="va">conf.int</span>, <span class="fl">2</span><span class="op">)</span>, collapse<span class="op">=</span><span class="st">','</span><span class="op">)</span></span>
<span>  <span class="va">conf_str</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">stats_to_compute</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n         <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                         t_CI      <span class="op">=</span> <span class="op">~</span><span class="fu">t_CI</span><span class="op">(</span><span class="va">.</span>, conf.level<span class="op">=</span><span class="fl">0.95</span><span class="op">)</span>,</span>
<span>                         wilcox_CI <span class="op">=</span> <span class="op">~</span><span class="fu">wilcox_CI</span><span class="op">(</span><span class="va">.</span>, conf.level<span class="op">=</span><span class="fl">0.95</span><span class="op">)</span>,</span>
<span>                         min       <span class="op">=</span> <span class="va">min</span>,</span>
<span>                         q25       <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">.</span>, <span class="fl">0.25</span><span class="op">)</span>,</span>
<span>                         median    <span class="op">=</span> <span class="va">median</span>,</span>
<span>                         q75       <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">.</span>, <span class="fl">0.75</span><span class="op">)</span>,</span>
<span>                         max       <span class="op">=</span> <span class="va">max</span>,</span>
<span>                         mean      <span class="op">=</span> <span class="va">mean</span>,</span>
<span>                         sd        <span class="op">=</span> <span class="va">sd</span><span class="op">)</span></span>
<span></span>
<span><span class="va">old.o</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>max.print <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span></span>
<span></span>
<span><span class="va">widths_all_tibble</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">class</span>, <span class="va">what</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="va">width</span>, <span class="va">stats_to_compute</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## `summarise()` has grouped output by 'name', 'class'. You can override using the `.groups` argument.</span></span></code></pre>
<pre><code><span><span class="co">##        name          class            what width_n          width_t_CI width_wilcox_CI width_min width_q25 width_median width_q75 width_max  width_mean    width_sd</span></span>
<span><span class="co">## 1   Bar_Aom   intermediate         aligned   24717     1538.64,1610.24       844,872.5        51    368.00        634.0   1447.00     54452   1574.4417   2871.3143</span></span>
<span><span class="co">## 2   Bar_Aom   intermediate          bridge   20520        302.15,327.1         191,197         0     38.00        178.0    309.00     38380    314.6256    911.6882</span></span>
<span><span class="co">## 3   Bar_Aom   intermediate doublecoalesced    3452    11606.52,14764.2       3836,4392        58    562.75       2251.5   8361.50   1199960  13185.3589  47312.1501</span></span>
<span><span class="co">## 4   Bar_Aom   intermediate        isolated    1853      862.03,1000.66       559.5,621        58    271.00        481.0    960.00     19742    931.3475   1521.3645</span></span>
<span><span class="co">## 5   Bar_Aom   intermediate          mapped    4197    9887.49,11733.47   3636.5,4119.5        58    547.00       2104.0   7894.00    677793  10810.4818  30499.4833</span></span>
<span><span class="co">## 6   Bar_Aom   intermediate       unaligned   24170       611.96,681.74       210.5,217         1     48.00        194.0    351.00     79613    646.8544   2767.3868</span></span>
<span><span class="co">## 7   Bar_Aom   intermediate         unmaped    4129     2035.51,2410.29       526.5,629         1     82.00        272.0   1330.00     79613   2222.9002   6141.9161</span></span>
<span><span class="co">## 8   Bar_Kum        distant         aligned   31557       957.75,991.34         617,635        51    250.00        469.0   1052.00     43546    974.5433   1522.0555</span></span>
<span><span class="co">## 9   Bar_Kum        distant          bridge   23028       408.46,440.56     289.5,296.5         0    144.00        258.0    441.00    135099    424.5125   1242.4483</span></span>
<span><span class="co">## 10  Bar_Kum        distant doublecoalesced    7849     4903.46,5419.47   2151.5,2342.5        51    316.00       1354.0   4436.00    216498   5161.4630  11660.5964</span></span>
<span><span class="co">## 11  Bar_Kum        distant        isolated    4346       653.68,717.84       408,449.5        51    177.00        302.0    764.75     16862    685.7561   1078.6911</span></span>
<span><span class="co">## 12  Bar_Kum        distant          mapped    8529      4530.09,4973.8   2005.5,2181.5        51    296.00       1227.0   4188.00    138044   4751.9448  10452.2655</span></span>
<span><span class="co">## 13  Bar_Kum        distant       unaligned   31373        704.7,796.64         323,331         1    147.00        273.0    521.00    273024    750.6715   4154.0813</span></span>
<span><span class="co">## 14  Bar_Kum        distant         unmaped    8515     1455.44,1780.07         502,540         1    144.00        351.0    975.00    273024   1617.7504   7640.8206</span></span>
<span><span class="co">## 15  Bar_Nor same_or_sister         aligned   15184     2880.98,3022.93   1814.5,1908.5        40    526.00       1305.5   3380.25     55611   2951.9559   4462.0282</span></span>
<span><span class="co">## 16  Bar_Nor same_or_sister          bridge    8996        378.79,417.1         274,297         0      2.00        124.0    406.00     17680    397.9464    926.7815</span></span>
<span><span class="co">## 17  Bar_Nor same_or_sister doublecoalesced    4319    10271.06,12273.5       2512,2848        40    529.00       1517.0   5440.00    569531  11272.2790  33562.3130</span></span>
<span><span class="co">## 18  Bar_Nor same_or_sister        isolated    3882     1262.66,1415.56         780,845        40    312.00        633.0   1366.50     44180   1339.1121   2429.5923</span></span>
<span><span class="co">## 19  Bar_Nor same_or_sister          mapped    6188     7355.49,8288.48     2419,2720.5        40    488.00       1373.5   5444.75    240933   7821.9819  18719.2179</span></span>
<span><span class="co">## 20  Bar_Nor same_or_sister       unaligned   12425       755.51,822.08       359.5,383         1     24.00        225.0    734.00     56097    788.7979   1892.7856</span></span>
<span><span class="co">## 21  Bar_Nor same_or_sister         unmaped    5214      1122.1,1264.13       557,629.5         1     16.00        325.0   1250.00     56097   1193.1124   2615.7709</span></span>
<span><span class="co">## 22  Bar_Oki        distant         aligned   32265       924.88,956.96     597.5,614.5        51    245.00        454.0   1014.00     43420    940.9199   1469.8924</span></span>
<span><span class="co">## 23  Bar_Oki        distant          bridge   23772       413.37,438.69     288.5,295.5         0    142.00        256.0    443.00     59129    426.0277    995.8294</span></span>
<span><span class="co">## 24  Bar_Oki        distant doublecoalesced    7849     4896.93,5417.11     2145.5,2338        54    306.00       1347.0   4450.00    218004   5157.0210  11754.6679</span></span>
<span><span class="co">## 25  Bar_Oki        distant        isolated    4321       645.66,714.44       390,427.5        54    172.00        296.0    714.00     21112    680.0470   1153.0032</span></span>
<span><span class="co">## 26  Bar_Oki        distant          mapped    8493     4540.11,4993.94     2005.5,2179        54    291.00       1218.0   4177.00    218004   4767.0211  10667.9952</span></span>
<span><span class="co">## 27  Bar_Oki        distant       unaligned   32076       703.97,795.69     322.5,330.5         1    146.00        272.0    520.00    269200    749.8278   4190.4617</span></span>
<span><span class="co">## 28  Bar_Oki        distant         unmaped    8484       1472.9,1809.5     503.5,539.5         1    148.00        358.0    968.00    269200   1641.2007   7908.2528</span></span>
<span><span class="co">## 29  Bar_Osa   intermediate         aligned   24851      1523.3,1593.59       844.5,873        52    367.00        634.0   1449.00     49546   1558.4455   2826.8737</span></span>
<span><span class="co">## 30  Bar_Osa   intermediate          bridge   20778        303.39,328.1     188.5,194.5         0     37.00        174.0    305.00     32212    315.7473    908.4853</span></span>
<span><span class="co">## 31  Bar_Osa   intermediate doublecoalesced    3373   12040.47,14823.71     3990.5,4583        59    585.00       2310.0   8781.00    714822  13432.0910  41221.5092</span></span>
<span><span class="co">## 32  Bar_Osa   intermediate        isolated    1732       814.98,929.84         571,634        59    279.75        478.0    968.25     16143    872.4094   1218.6145</span></span>
<span><span class="co">## 33  Bar_Osa   intermediate          mapped    4073   10180.46,12058.44       3738,4238        59    572.00       2153.0   8140.00    562164  11119.4513  30566.1990</span></span>
<span><span class="co">## 34  Bar_Osa   intermediate       unaligned   24266       616.12,690.07       208,214.5         1     47.00        189.0    346.00    106962    653.0948   2938.6433</span></span>
<span><span class="co">## 35  Bar_Osa   intermediate         unmaped    4008     2110.15,2524.29       516.5,607         1     83.00        277.0   1249.50    106962   2317.2161   6686.5554</span></span>
<span><span class="co">## 36  Cbr_Cel        distant         aligned   47012       523.92,534.98       413,419.5        53    210.00        363.0    622.00     23152    529.4498    611.7579</span></span>
<span><span class="co">## 37  Cbr_Cel        distant          bridge   43326     1114.48,1175.78       623.5,639         0    160.00        494.0   1077.00    248393   1145.1281   3254.9048</span></span>
<span><span class="co">## 38  Cbr_Cel        distant doublecoalesced    3546   19066.68,23080.29      9597,11187        70    953.00       4744.0  22150.50   2037825  21073.4873  60950.6693</span></span>
<span><span class="co">## 39  Cbr_Cel        distant        isolated     993       520.53,582.69       428,476.5        70    238.00        401.0    658.00      4860    551.6113    499.0966</span></span>
<span><span class="co">## 40  Cbr_Cel        distant          mapped    3686    18298.4,22127.16      9262,10799        70    910.50       4530.5  21520.00   2037825  20212.7811  59280.8720</span></span>
<span><span class="co">## 41  Cbr_Cel        distant       unaligned   46608     1674.24,1800.27       708,726.5         1    189.00        555.0   1257.00    540635   1737.2543   6941.2578</span></span>
<span><span class="co">## 42  Cbr_Cel        distant         unmaped    3675     7856.75,9207.81     4321.5,4771         1   1059.00       3163.0   8405.00    540635   8532.2808  20887.2596</span></span>
<span><span class="co">## 43  Cbr_Cni          close         aligned   51726     1418.23,1450.18     1037,1055.5        48    451.00        885.0   1639.00     42453   1434.2038   1854.0210</span></span>
<span><span class="co">## 44  Cbr_Cni          close          bridge   41711       527.58,550.53     386.5,394.5         0    116.00        324.0    621.00     74381    539.0541   1195.3952</span></span>
<span><span class="co">## 45  Cbr_Cni          close doublecoalesced    6677   13734.59,15563.37     3214.5,3861        52    376.00       1146.0   9736.00    619682  14648.9759  38114.9360</span></span>
<span><span class="co">## 46  Cbr_Cni          close        isolated    5576       579.87,620.17       456.5,480        52    236.00        390.0    713.00     30395    600.0187    767.5146</span></span>
<span><span class="co">## 47  Cbr_Cni          close          mapped   10015     9185.2,10119.87   2706.5,3085.5        52    350.50       1051.0   7105.00    527175   9652.5324  23859.0372</span></span>
<span><span class="co">## 48  Cbr_Cni          close       unaligned   49877        622.3,650.97       398.5,407         1    120.00        336.0    674.00     95699    636.6340   1633.0832</span></span>
<span><span class="co">## 49  Cbr_Cni          close         unmaped    9394      930.55,1042.82         489,525         1     52.00        341.0    974.75     95699    986.6839   2775.6234</span></span>
<span><span class="co">## 50  Cbr_Cre   intermediate         aligned   44819       724.89,741.84         545,554        54    267.00        477.0    829.00     25357    733.3664    915.6811</span></span>
<span><span class="co">## 51  Cbr_Cre   intermediate          bridge   41373     1145.76,1206.59     697.5,711.5         0    290.00        605.0   1106.00    248371   1176.1738   3156.3155</span></span>
<span><span class="co">## 52  Cbr_Cre   intermediate doublecoalesced    3274   22486.72,27520.38   10373,12213.5        70   1006.50       5313.0  24194.00   1794548  25003.5464  73448.7989</span></span>
<span><span class="co">## 53  Cbr_Cre   intermediate        isolated    1013       644.12,727.14         540,605        70    266.00        476.0    879.00      7030    685.6328    673.3018</span></span>
<span><span class="co">## 54  Cbr_Cre   intermediate          mapped    3446   21350.32,25968.65   10091,11802.5        70    988.00       5078.5  23458.25   1794548  23659.4855  69137.1135</span></span>
<span><span class="co">## 55  Cbr_Cre   intermediate       unaligned   44593     1585.87,1691.14       763.5,780         1    308.00        648.0   1239.00    285240   1638.5042   5670.9042</span></span>
<span><span class="co">## 56  Cbr_Cre   intermediate         unmaped    3434     6561.56,7651.59       3659,4063         1    916.25       2630.0   7107.25    285240   7106.5754  16289.4619</span></span>
<span><span class="co">## 57  Cni_Cbr          close         aligned   51324      1431.4,1463.42   1048.5,1067.5        43    456.00        891.0   1656.00     39397   1447.4074   1850.4720</span></span>
<span><span class="co">## 58  Cni_Cbr          close          bridge   41487       623.34,656.79       385.5,394         0    101.00        323.0    618.00     85250    640.0672   1738.2862</span></span>
<span><span class="co">## 59  Cni_Cbr          close doublecoalesced    6479   15081.78,17064.17   3471.5,4222.5        43    380.00       1125.0  10826.50    525245  16072.9728  40698.9749</span></span>
<span><span class="co">## 60  Cni_Cbr          close        isolated    5492       571.77,605.96       457.5,481        43    234.00        394.0    713.00     12227    588.8616    646.2795</span></span>
<span><span class="co">## 61  Cni_Cbr          close          mapped    9837     9757.63,10744.8   2882.5,3301.5        43    354.00       1040.0   7658.00    487247  10251.2150  24974.2632</span></span>
<span><span class="co">## 62  Cni_Cbr          close       unaligned   49573     1047.92,1112.46       442,452.5         1    136.00        362.0    760.00    165349   1080.1929   3665.8063</span></span>
<span><span class="co">## 63  Cni_Cbr          close         unmaped    9504      2693.7,2986.84       1136,1240         1    153.00        684.0   2449.50    165349   2840.2713   7289.6177</span></span>
<span><span class="co">## 64  Cni_Cin        distant         aligned   41207       501.66,512.98       390.5,397        52    190.00        334.0    600.00     16541    507.3222    586.1596</span></span>
<span><span class="co">## 65  Cni_Cin        distant          bridge   38347     1444.19,1565.89       669,687.5         0    190.00        532.0   1161.00    522515   1505.0371   6079.4902</span></span>
<span><span class="co">## 66  Cni_Cin        distant doublecoalesced    2811   25278.56,30673.32   12221,14210.5        55   1198.00       6294.0  27444.00   1433591  27975.9431  72935.1950</span></span>
<span><span class="co">## 67  Cni_Cin        distant        isolated     638        472.9,548.19     404.5,466.5        55    211.00        346.5    675.25      4665    510.5439    484.1822</span></span>
<span><span class="co">## 68  Cni_Cin        distant          mapped    2860    24839.14,30139.1     12026,13958        55   1163.00       6199.0  26778.50   1433591  27489.1199  72275.8818</span></span>
<span><span class="co">## 69  Cni_Cin        distant       unaligned   40942     2451.15,2746.36         764,787         1    213.00        592.0   1379.00   1062215   2598.7560  15238.1718</span></span>
<span><span class="co">## 70  Cni_Cin        distant         unmaped    2853   15188.36,18940.35     6952.5,7869         1   1555.00       5117.0  13941.00   1062215  17064.3575  51103.4333</span></span>
<span><span class="co">## 71  Cni_Cre   intermediate         aligned   44877        718.3,735.08         542,551        54    267.00        476.0    823.00     26910    726.6916    907.0093</span></span>
<span><span class="co">## 72  Cni_Cre   intermediate          bridge   41389     1281.45,1383.01     694.5,708.5         0    286.00        610.0   1091.00    456231   1332.2298   5271.0991</span></span>
<span><span class="co">## 73  Cni_Cre   intermediate doublecoalesced    3292   23984.77,29573.74 10398.5,12151.5        66    905.50       4619.5  24288.25   2187342  26779.2527  81775.6460</span></span>
<span><span class="co">## 74  Cni_Cre   intermediate        isolated    1093        652.41,732.4       548,610.5        66    278.00        503.0    872.00      7539    692.4071    673.9110</span></span>
<span><span class="co">## 75  Cni_Cre   intermediate          mapped    3488   22598.78,27717.39    9891.5,11617        66    879.75       4410.5  23256.25   2187342  25158.0849  77092.2783</span></span>
<span><span class="co">## 76  Cni_Cre   intermediate       unaligned   44650     2013.55,2226.93         762,778         1    306.00        654.0   1228.00   1210598   2120.2391  11502.1956</span></span>
<span><span class="co">## 77  Cni_Cre   intermediate         unmaped    3480   10172.19,12545.63     4457.5,4991         1    959.00       2977.5   8936.25   1210598  11358.9124  35705.8170</span></span>
<span><span class="co">## 78  Dme_Dbu        distant         aligned   47893        610.2,623.09       463.5,472        48    205.00        397.0    731.00     16014    616.6455    719.1531</span></span>
<span><span class="co">## 79  Dme_Dbu        distant          bridge   41934     1570.08,1628.57    999.5,1023.5         0    395.00        783.0   1684.00    174913   1599.3246   3055.7262</span></span>
<span><span class="co">## 80  Dme_Dbu        distant doublecoalesced    5877    15727.3,17388.08     7514,8553.5        54    716.00       3233.0  17797.00    615658  16557.6888  32472.8670</span></span>
<span><span class="co">## 81  Dme_Dbu        distant        isolated    2086       638.88,695.17         519,565        54    245.00        462.0    849.75      5460    667.0240    655.5648</span></span>
<span><span class="co">## 82  Dme_Dbu        distant          mapped    5959   15413.96,17007.28     7325.5,8328        54    701.00       3134.0  17379.50    532037  16210.6196  31370.6132</span></span>
<span><span class="co">## 83  Dme_Dbu        distant       unaligned   47867     2115.49,2325.33     1100,1125.5         1    424.00        853.0   1868.00   1031382   2220.4080  11711.7224</span></span>
<span><span class="co">## 84  Dme_Dbu        distant         unmaped    5951     5780.24,7400.13     2069.5,2221         1    772.50       1602.0   3679.50   1031382   6590.1850  31872.2350</span></span>
<span><span class="co">## 85  Dme_Dma same_or_sister         aligned    9732   10954.29,11804.24       5294,5971        49    404.00       1953.0  13037.50    291858  11379.2660  21387.8094</span></span>
<span><span class="co">## 86  Dme_Dma same_or_sister          bridge    7026      884.17,1011.76       270.5,296         0     25.00        183.0    479.00     67561    947.9668   2727.8052</span></span>
<span><span class="co">## 87  Dme_Dma same_or_sister doublecoalesced    2272   29884.44,73666.11         623,729        56    240.00        458.5   1274.25  15422642  51775.2720 532092.2108</span></span>
<span><span class="co">## 88  Dme_Dma same_or_sister        isolated    2008        492.3,638.59       369,398.5        56    199.00        333.5    574.25     60697    565.4417   1671.3122</span></span>
<span><span class="co">## 89  Dme_Dma same_or_sister          mapped    2706   32527.05,54245.63       667,793.5        56    237.25        465.0   1472.75   8110313  43386.3385 288086.3839</span></span>
<span><span class="co">## 90  Dme_Dma same_or_sister       unaligned    9138     2583.15,3115.67       521.5,592         1     71.00        276.0   1299.00    545408   2849.4082  12984.5839</span></span>
<span><span class="co">## 91  Dme_Dma same_or_sister         unmaped    2616     6516.25,8298.34     2456,2975.5         1    266.75       1311.0   5929.50    545408   7407.2924  23241.7218</span></span>
<span><span class="co">## 92  Dme_Dsu   intermediate         aligned   68750        1168.64,1187     931.5,942.5        50    553.00        843.0   1333.00     33370   1177.8198   1227.9791</span></span>
<span><span class="co">## 93  Dme_Dsu   intermediate          bridge   67758       327.89,343.23     221.5,223.5         0    148.00        207.0    298.00     76314    335.5584   1018.9091</span></span>
<span><span class="co">## 94  Dme_Dsu   intermediate doublecoalesced     878 103687.77,132644.64   45163.5,67214        77    665.75       7701.0 134819.75   1457965 118166.2050 218585.3124</span></span>
<span><span class="co">## 95  Dme_Dsu   intermediate        isolated     379       639.68,784.97       522.5,637        77    264.50        498.0    895.50      7094    712.3245    719.2297</span></span>
<span><span class="co">## 96  Dme_Dsu   intermediate          mapped     992  92498.83,116597.69   39379,60320.5        77    661.50       7251.5 122432.00   1338161 104548.2621 193394.2339</span></span>
<span><span class="co">## 97  Dme_Dsu   intermediate       unaligned   68626       665.01,916.59     223.5,225.5         1    149.00        209.0    303.00   2615430    790.8018  16812.8419</span></span>
<span><span class="co">## 98  Dme_Dsu   intermediate         unmaped     984   23497.61,40593.44     1173,1914.5         1    313.75        693.5   4526.00   2615430  32045.5264 136638.9172</span></span>
<span><span class="co">## 99  Dme_Dya          close         aligned   23059     4475.07,4642.76     3052,3167.5        60    919.00       2264.0   5468.00     92398   4558.9142   6495.6166</span></span>
<span><span class="co">## 100 Dme_Dya          close          bridge   21243        480.45,527.1         213,218         0    123.00        191.0    309.00     75233    503.7723   1734.2930</span></span>
<span><span class="co">## 101 Dme_Dya          close doublecoalesced    1582   56273.14,90367.16      764.5,1000        63    243.25        500.0   1919.25   6070020  73320.1492 345677.1415</span></span>
<span><span class="co">## 102 Dme_Dya          close        isolated    1314       536.32,649.82       390.5,436        63    203.00        335.0    646.00     25871    593.0723   1048.5917</span></span>
<span><span class="co">## 103 Dme_Dya          close          mapped    1816    51540.18,76021.1    913.5,1292.5        63    247.75        531.0   2852.50   4893795  63780.6382 265960.8921</span></span>
<span><span class="co">## 104 Dme_Dya          close       unaligned   22743     1251.61,1518.29       232,238.5         1    129.00        202.0    360.00    859148   1384.9524  10259.1500</span></span>
<span><span class="co">## 105 Dme_Dya          close         unmaped    1776   10099.58,13319.72       4087,5246         1    407.50       2005.5  10593.00    859148  11709.6492  34595.6295</span></span>
<span><span class="co">## 106 Oki_Aom        distant         aligned   32398      970.18,1004.75         599,616        55    257.25        459.0   1014.00     38135    987.4651   1587.6967</span></span>
<span><span class="co">## 107 Oki_Aom        distant          bridge   23534       556.31,599.03       329.5,340         0     91.00        278.0    548.00     81689    577.6661   1671.8453</span></span>
<span><span class="co">## 108 Oki_Aom        distant doublecoalesced    8176     5354.77,5893.45     2325,2534.5        64    324.75       1434.0   4868.50    216565   5624.1087  12423.8043</span></span>
<span><span class="co">## 109 Oki_Aom        distant        isolated    4586         723.3,801.8       432.5,474        55    184.00        322.0    803.75     23204    762.5497   1355.7858</span></span>
<span><span class="co">## 110 Oki_Aom        distant          mapped    8864     4909.98,5375.83     2150.5,2340        55    310.75       1291.5   4535.00    216565   5142.9025  11187.1566</span></span>
<span><span class="co">## 111 Oki_Aom        distant       unaligned   32175      925.18,1015.58         400,413         1    129.00        313.0    710.00    189661    970.3809   4136.8088</span></span>
<span><span class="co">## 112 Oki_Aom        distant         unmaped    8848     1839.99,2144.46     786.5,848.5         1    176.00        497.0   1577.50    189661   1992.2255   7305.3661</span></span>
<span><span class="co">## 113 Oki_Bar        distant         aligned   30841     1005.87,1041.09       652,671.5        51    261.00        494.0   1118.00     43759   1023.4778   1577.7563</span></span>
<span><span class="co">## 114 Oki_Bar        distant          bridge   22308        589.8,629.34       359.5,370         0    165.00        302.0    583.00     51342    609.5723   1506.3415</span></span>
<span><span class="co">## 115 Oki_Bar        distant doublecoalesced    7876     5494.42,6064.46   2353.5,2569.5        54    316.00       1438.0   4926.75    216563   5779.4397  12903.7318</span></span>
<span><span class="co">## 116 Oki_Bar        distant        isolated    4435       691.58,762.42       423,463.5        54    184.50        316.0    775.00     21231    726.9998   1203.0890</span></span>
<span><span class="co">## 117 Oki_Bar        distant          mapped    8533     5044.56,5541.03       2182,2374        54    302.00       1312.0   4580.00    168062   5292.7949  11697.6288</span></span>
<span><span class="co">## 118 Oki_Bar        distant       unaligned   30684      969.67,1068.66       426,439.5         1    172.00        333.0    744.00    283076   1019.1656   4423.5389</span></span>
<span><span class="co">## 119 Oki_Bar        distant         unmaped    8515     1906.94,2244.26       780,845.5         1    182.00        503.0   1572.50    283076   2075.6006   7939.4455</span></span>
<span><span class="co">## 120 Oki_Kum same_or_sister         aligned   15086        3444.82,3615     2263.5,2378        44    601.00       1598.0   4234.00     72046   3529.9073   5331.9172</span></span>
<span><span class="co">## 121 Oki_Kum same_or_sister          bridge    9662       554.25,637.24       311.5,332         0      7.00        180.0    497.00     49765    595.7452   2080.8174</span></span>
<span><span class="co">## 122 Oki_Kum same_or_sister doublecoalesced    1625   32119.88,41848.39  8992.5,12752.5        48    427.00       2193.0  27502.00   1365817  36984.1342  99970.3102</span></span>
<span><span class="co">## 123 Oki_Kum same_or_sister        isolated    2993     1640.94,1904.58       726.5,808        44    321.00        597.0   1305.00     58461   1772.7618   3677.9126</span></span>
<span><span class="co">## 124 Oki_Kum same_or_sister          mapped    5424   10370.48,11387.73     5736,6459.5        44    542.75       2506.0  12995.25    262072  10879.1062  19107.8473</span></span>
<span><span class="co">## 125 Oki_Kum same_or_sister       unaligned   12386        790.2,882.38         309,329         1     25.00        211.0    614.00     53783    836.2917   2616.6886</span></span>
<span><span class="co">## 126 Oki_Kum same_or_sister         unmaped    4119      1018.53,1216.1     305.5,364.5         1      8.00        121.0    794.00     53783   1117.3146   3233.7276</span></span>
<span><span class="co">## 127 Oki_Nor        distant         aligned   30055      974.05,1006.36     656.5,675.5        52    261.00        502.0   1122.00     43752    990.2015   1428.7816</span></span>
<span><span class="co">## 128 Oki_Nor        distant          bridge   21180       616.65,658.38     369.5,381.5         0    171.00        305.0    607.00     83492    637.5155   1549.4677</span></span>
<span><span class="co">## 129 Oki_Nor        distant doublecoalesced    8280     5027.56,5504.15   2359.5,2552.5        54    365.75       1530.0   4800.25    216563   5265.8556  11061.6823</span></span>
<span><span class="co">## 130 Oki_Nor        distant        isolated    4578       769.55,842.95         498,544        54    190.00        357.0    926.25     17200    806.2532   1266.6301</span></span>
<span><span class="co">## 131 Oki_Nor        distant          mapped    8875     4662.56,5086.86     2202.5,2381        54    340.50       1408.0   4490.50    216563   4874.7136  10195.7615</span></span>
<span><span class="co">## 132 Oki_Nor        distant       unaligned   29897     1065.36,1166.48     462.5,478.5         1    178.00        348.0    824.00    280268   1115.9183   4460.4825</span></span>
<span><span class="co">## 133 Oki_Nor        distant         unmaped    8854     2082.17,2403.95    951.5,1028.5         1    194.00        596.0   1929.75    280268   2243.0576   7723.0016</span></span>
<span><span class="co">## 134 Oki_Osa        distant         aligned   30852     1042.47,1080.36       642.5,662        56    273.00        487.0   1098.25     38135   1061.4169   1697.9866</span></span>
<span><span class="co">## 135 Oki_Osa        distant          bridge   22009       554.32,592.64     333.5,344.5         0     75.00        284.0    559.00     47969    573.4841   1450.1810</span></span>
<span><span class="co">## 136 Oki_Osa        distant doublecoalesced    8132     5358.65,5881.01   2385.5,2593.5        67    338.75       1489.0   4944.25    164824   5619.8308  12014.8889</span></span>
<span><span class="co">## 137 Oki_Osa        distant        isolated    4646        780.7,861.56       471.5,518        61    195.00        345.5    888.75     24353    821.1334   1405.6672</span></span>
<span><span class="co">## 138 Oki_Osa        distant          mapped    8843     4903.95,5356.97     2195,2380.5        61    324.00       1358.0   4561.00    164824   5130.4588  10866.2362</span></span>
<span><span class="co">## 139 Oki_Osa        distant       unaligned   30636      937.76,1034.33       403,416.5         1    114.00        318.0    722.00    211398    986.0471   4311.6897</span></span>
<span><span class="co">## 140 Oki_Osa        distant         unmaped    8821     1834.91,2152.56     757.5,819.5         1    167.00        475.0   1543.00    211398   1993.7338   7609.5710</span></span>
<span><span class="co">## 141 Osa_Aom same_or_sister         aligned   15261     3005.27,3189.26       1625,1709        44    501.00       1142.0   3015.00    112674   3097.2689   5797.9303</span></span>
<span><span class="co">## 142 Osa_Aom same_or_sister          bridge   10311       327.61,359.27       263,276.5         0     12.00        186.0    392.00     31147    343.4384    820.0688</span></span>
<span><span class="co">## 143 Osa_Aom same_or_sister doublecoalesced    2256   18388.65,27235.22   3626.5,4766.5        46    467.75       1569.0  10310.00   2627520  22811.9331 107135.4024</span></span>
<span><span class="co">## 144 Osa_Aom same_or_sister        isolated    2791     1152.21,1353.59         619,670        46    297.50        546.0   1015.50     37928   1252.9022   2712.9315</span></span>
<span><span class="co">## 145 Osa_Aom same_or_sister          mapped    4950    9581.21,10947.52       3444,4108        46    487.25       1441.0   8766.75    394294  10264.3665  24517.1044</span></span>
<span><span class="co">## 146 Osa_Aom same_or_sister       unaligned   13147       536.81,588.57       281.5,297         1     34.00        219.0    539.50     37950    562.6859   1513.9013</span></span>
<span><span class="co">## 147 Osa_Aom same_or_sister         unmaped    4063       876.8,1021.52         375,431         1     10.00        200.0    868.00     37950    949.1605   2352.5788</span></span>
<span><span class="co">## 148 Osa_Bar   intermediate         aligned   24430     1555.18,1626.72     870.5,900.5        50    372.00        651.0   1500.00     49309   1590.9494   2852.6515</span></span>
<span><span class="co">## 149 Osa_Bar   intermediate          bridge   20349       374.78,396.54       276.5,283         0    121.00        257.0    400.00     34004    385.6573    791.8057</span></span>
<span><span class="co">## 150 Osa_Bar   intermediate doublecoalesced    3358   12551.79,15470.77     4230,4939.5        59    596.25       2474.0   9656.25    735649  14011.2802  43135.7029</span></span>
<span><span class="co">## 151 Osa_Bar   intermediate        isolated    1757       837.18,973.65       570.5,635        59    282.00        487.0    962.00     19831    905.4104   1458.2906</span></span>
<span><span class="co">## 152 Osa_Bar   intermediate          mapped    4081    10494.2,12399.52     3967,4547.5        59    588.00       2321.0   8849.00    541207  11446.8598  31041.5565</span></span>
<span><span class="co">## 153 Osa_Bar   intermediate       unaligned   24028          628,681.41       293,300.5         1    128.00        267.0    437.25     79670    654.7069   2111.8623</span></span>
<span><span class="co">##  [ reached 'max' / getOption("max.print") -- omitted 78 rows ]</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">widths_all_tibble</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">what</span>, <span class="va">class</span>, <span class="va">genus</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="va">width</span>, <span class="va">stats_to_compute</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## `summarise()` has grouped output by 'what', 'class'. You can override using the `.groups` argument.</span></span></code></pre>
<pre><code><span><span class="co">##               what           class          genus width_n          width_t_CI width_wilcox_CI width_min width_q25 width_median width_q75 width_max  width_mean    width_sd</span></span>
<span><span class="co">## 1          aligned  same_or_sister     Drosophila    9732   10954.29,11804.24       5294,5971        49    404.00       1953.0  13037.50    291858  11379.2660  21387.8094</span></span>
<span><span class="co">## 2          aligned  same_or_sister          Ciona   40659     2534.44,2612.26     1669.5,1716        43    498.00       1251.0   2974.00     97390   2573.3486   4003.2243</span></span>
<span><span class="co">## 3          aligned  same_or_sister     Oikopleura   45531     3144.09,3240.23     1908,1965.5        40    536.00       1328.0   3549.50    112674   3192.1570   5233.1119</span></span>
<span><span class="co">## 4          aligned           close Caenorhabditis  103050     1429.47,1452.09   1045.5,1058.5        43    453.00        888.0   1649.00     42453   1440.7798   1852.2570</span></span>
<span><span class="co">## 5          aligned           close     Drosophila   23059     4475.07,4642.76     3052,3167.5        60    919.00       2264.0   5468.00     92398   4558.9142   6495.6166</span></span>
<span><span class="co">## 6          aligned           close          Ciona  176589     1497.75,1517.72     1055,1067.5        47    366.00        823.0   1784.00     83419   1507.7380   2140.7792</span></span>
<span><span class="co">## 7          aligned    intermediate Caenorhabditis   89696       724.06,735.99       545,551.5        54    267.00        477.0    826.00     26910    730.0269    911.3537</span></span>
<span><span class="co">## 8          aligned    intermediate     Drosophila   68750        1168.64,1187     931.5,942.5        50    553.00        843.0   1333.00     33370   1177.8198   1227.9791</span></span>
<span><span class="co">## 9          aligned    intermediate     Oikopleura   98495     1547.95,1582.22     876.5,891.5        50    371.00        650.0   1497.50     54452   1565.0848   2743.5154</span></span>
<span><span class="co">## 10         aligned         distant Caenorhabditis   88219       515.15,523.07       403.5,408        52    201.00        349.0    611.50     23152    519.1140    600.0351</span></span>
<span><span class="co">## 11         aligned         distant     Drosophila   47893        610.2,623.09       463.5,472        48    205.00        397.0    731.00     16014    616.6455    719.1531</span></span>
<span><span class="co">## 12         aligned         distant          Ciona  138664        243.89,247.2       179,179.5        60    137.00        170.0    221.00     25919    245.5469    314.0168</span></span>
<span><span class="co">## 13         aligned         distant     Oikopleura  250472      995.75,1008.06       630,636.5        51    259.00        474.0   1065.00     43759   1001.9047   1572.4288</span></span>
<span><span class="co">## 14         aligned different_genus           &lt;NA&gt;    4474       320.97,361.86         227,243        78    156.00        193.0    356.75     30669    341.4119    697.5420</span></span>
<span><span class="co">## 15          bridge  same_or_sister     Drosophila    7026      884.17,1011.76       270.5,296         0     25.00        183.0    479.00     67561    947.9668   2727.8052</span></span>
<span><span class="co">## 16          bridge  same_or_sister          Ciona   32958       364.42,391.57     231.5,237.5         0     30.00        195.5    340.00     97102    377.9965   1257.6133</span></span>
<span><span class="co">## 17          bridge  same_or_sister     Oikopleura   28969       428.39,460.65     284.5,295.5         0      6.00        169.0    431.00     49765    444.5169   1400.7196</span></span>
<span><span class="co">## 18          bridge           close Caenorhabditis   83198       579.29,599.56         387,393         0    109.00        324.0    619.00     85250    589.4247   1491.8728</span></span>
<span><span class="co">## 19          bridge           close     Drosophila   21243        480.45,527.1         213,218         0    123.00        191.0    309.00     75233    503.7723   1734.2930</span></span>
<span><span class="co">## 20          bridge           close          Ciona  162242       378.06,390.49       226.5,229         0     51.00        201.0    343.00     90560    384.2791   1277.3452</span></span>
<span><span class="co">## 21          bridge    intermediate Caenorhabditis   82762     1224.61,1283.82         698,708         0    288.00        608.0   1097.75    456231   1254.2169   4345.2261</span></span>
<span><span class="co">## 22          bridge    intermediate     Drosophila   67758       327.89,343.23     221.5,223.5         0    148.00        207.0    298.00     76314    335.5584   1018.9091</span></span>
<span><span class="co">## 23          bridge    intermediate     Oikopleura   80917       352.82,364.58       236,239.5         0     58.00        222.0    369.00     38380    358.6999    853.0667</span></span>
<span><span class="co">## 24          bridge         distant Caenorhabditis   81673     1281.22,1347.01       647,658.5         0    176.00        511.0   1114.00    522515   1314.1121   4796.4155</span></span>
<span><span class="co">## 25          bridge         distant     Drosophila   41934     1570.08,1628.57    999.5,1023.5         0    395.00        783.0   1684.00    174913   1599.3246   3055.7262</span></span>
<span><span class="co">## 26          bridge         distant          Ciona  130475      1026.7,1052.15         599,607         0    293.00        465.0    979.00    175994   1039.4208   2345.1046</span></span>
<span><span class="co">## 27          bridge         distant     Oikopleura  180723       512.66,524.69         329,332         0    146.00        286.0    511.00    135099    518.6746   1304.3395</span></span>
<span><span class="co">## 28          bridge different_genus           &lt;NA&gt;    1766     1652.73,2053.32        992,1121         0    372.00        775.0   1817.00     81648   1853.0238   4291.6322</span></span>
<span><span class="co">## 29 doublecoalesced  same_or_sister     Drosophila    2272   29884.44,73666.11         623,729        56    240.00        458.5   1274.25  15422642  51775.2720 532092.2108</span></span>
<span><span class="co">## 30 doublecoalesced  same_or_sister          Ciona    4224   25242.83,30881.69   1803.5,2091.5        50    491.00       1135.0   4150.50   1322492  28062.2607  93465.4230</span></span>
<span><span class="co">## 31 doublecoalesced  same_or_sister     Oikopleura    8200   17889.71,21195.14     3340,3847.5        40    496.75       1606.0   8502.50   2627520  19542.4283  76347.1262</span></span>
<span><span class="co">## 32 doublecoalesced           close Caenorhabditis   13156    14676.7,16023.81     3427,3922.5        43    378.00       1134.0  10147.50    619682  15350.2587  39413.6205</span></span>
<span><span class="co">## 33 doublecoalesced           close     Drosophila    1582   56273.14,90367.16      764.5,1000        63    243.25        500.0   1919.25   6070020  73320.1492 345677.1415</span></span>
<span><span class="co">## 34 doublecoalesced           close          Ciona    9517   32836.42,36892.14     3058,3590.5        52    466.00       1304.0  10497.00   1394106  34864.2812 100921.6066</span></span>
<span><span class="co">## 35 doublecoalesced    intermediate Caenorhabditis    6566   24013.26,27774.41 10631.5,11907.5        66    960.25       4979.0  24232.25   2187342  25893.8335  77734.3638</span></span>
<span><span class="co">## 36 doublecoalesced    intermediate     Drosophila     878 103687.77,132644.64   45163.5,67214        77    665.75       7701.0 134819.75   1457965 118166.2050 218585.3124</span></span>
<span><span class="co">## 37 doublecoalesced    intermediate     Oikopleura   14683   11896.19,13162.07     4135,4423.5        50    612.00       2400.0   8719.50   1199960  12529.1297  39127.8040</span></span>
<span><span class="co">## 38 doublecoalesced         distant Caenorhabditis    6357    22488.2,25763.17   11019.5,12195        55   1051.00       5394.0  24273.00   2037825  24125.6822  66599.7874</span></span>
<span><span class="co">## 39 doublecoalesced         distant     Drosophila    5877    15727.3,17388.08     7514,8553.5        54    716.00       3233.0  17797.00    615658  16557.6888  32472.8670</span></span>
<span><span class="co">## 40 doublecoalesced         distant          Ciona    8179    20048.5,21449.54 12801.5,13788.5        61   2215.00       8371.0  25468.50    526016  20749.0219  32319.1280</span></span>
<span><span class="co">## 41 doublecoalesced         distant     Oikopleura   64372     5287.56,5469.02   2349.5,2420.5        51    327.00       1439.0   4730.00    218004   5378.2904  11744.8510</span></span>
<span><span class="co">## 42 doublecoalesced different_genus           &lt;NA&gt;    2704     1584.88,1965.09     654.5,733.5        78    189.00        469.5   1252.00     81983   1774.9852   5041.5504</span></span>
<span><span class="co">## 43        isolated  same_or_sister     Drosophila    2008        492.3,638.59       369,398.5        56    199.00        333.5    574.25     60697    565.4417   1671.3122</span></span>
<span><span class="co">## 44        isolated  same_or_sister          Ciona    4830     1135.75,1228.97       830.5,883        45    350.00        697.0   1381.00     35993   1182.3617   1652.3764</span></span>
<span><span class="co">## 45        isolated  same_or_sister     Oikopleura    9666     1389.58,1507.41       725,763.5        40    312.00        594.0   1239.50     58461   1448.4957   2954.8151</span></span>
<span><span class="co">## 46        isolated           close Caenorhabditis   11068       581.25,607.71       460.5,477        43    235.00        392.0    713.00     30395    594.4825    709.9395</span></span>
<span><span class="co">## 47        isolated           close     Drosophila    1314       536.32,649.82       390.5,436        63    203.00        335.0    646.00     25871    593.0723   1048.5917</span></span>
<span><span class="co">## 48        isolated           close          Ciona    7994       789.28,830.11     601.5,630.5        50    259.00        512.0    967.75     14541    809.6955    931.1006</span></span>
<span><span class="co">## 49        isolated    intermediate Caenorhabditis    2106       660.37,717.93     553.5,598.5        66    271.25        488.5    874.00      7539    689.1486    673.4665</span></span>
<span><span class="co">## 50        isolated    intermediate     Drosophila     379       639.68,784.97       522.5,637        77    264.50        498.0    895.50      7094    712.3245    719.2297</span></span>
<span><span class="co">## 51        isolated    intermediate     Oikopleura    7663       930.69,996.17       625,658.5        50    289.00        511.0   1041.00     21037    963.4338   1462.0853</span></span>
<span><span class="co">## 52        isolated         distant Caenorhabditis    1631       511.58,559.52       426,464.5        55    226.00        384.0    667.50      4860    535.5469    493.5742</span></span>
<span><span class="co">## 53        isolated         distant     Drosophila    2086       638.88,695.17         519,565        54    245.00        462.0    849.75      5460    667.0240    655.5648</span></span>
<span><span class="co">## 54        isolated         distant          Ciona    1386       582.66,684.67         400,451        61    173.00        275.5    708.25     12900    633.6652    967.9353</span></span>
<span><span class="co">## 55        isolated         distant     Oikopleura   36058       742.77,768.87     454.5,469.5        51    185.00        324.0    822.00     24353    755.8199   1264.6923</span></span>
<span><span class="co">## 56        isolated different_genus           &lt;NA&gt;    1933       402.17,472.71       330.5,361        78    169.00        251.0    550.00     30669    437.4397    790.7655</span></span>
<span><span class="co">## 57          mapped  same_or_sister     Drosophila    2706   32527.05,54245.63       667,793.5        56    237.25        465.0   1472.75   8110313  43386.3385 288086.3839</span></span>
<span><span class="co">## 58          mapped  same_or_sister          Ciona    7701   14397.07,16011.39     3100,3677.5        45    532.00       1461.0   9053.00    443768  15204.2322  36134.0852</span></span>
<span><span class="co">## 59          mapped  same_or_sister     Oikopleura   16562      9236.61,9869.7     3755.5,4081        40    502.00       1591.0   8854.25    394294   9553.1524  20783.1448</span></span>
<span><span class="co">## 60          mapped           close Caenorhabditis   19852     9609.48,10288.9     2849,3126.5        43    352.00       1044.0   7384.25    527175   9949.1897  24419.2368</span></span>
<span><span class="co">## 61          mapped           close     Drosophila    1816    51540.18,76021.1    913.5,1292.5        63    247.75        531.0   2852.50   4893795  63780.6382 265960.8921</span></span>
<span><span class="co">## 62          mapped           close          Ciona   14347   21986.59,23820.35       3930,4585        50    446.00       1392.0  13495.50    730624  22903.4749  56028.4109</span></span>
<span><span class="co">## 63          mapped    intermediate Caenorhabditis    6934   22689.03,26137.62   10252,11447.5        66    937.00       4731.5  23335.75   2187342  24413.3238  73245.4207</span></span>
<span><span class="co">## 64          mapped    intermediate     Drosophila     992  92498.83,116597.69   39379,60320.5        77    661.50       7251.5 122432.00   1338161 104548.2621 193394.2339</span></span>
<span><span class="co">## 65          mapped    intermediate     Oikopleura   17578   10009.24,10832.49       3847,4098        50    595.00       2231.5   8118.75    677793  10420.8637  27842.3288</span></span>
<span><span class="co">## 66          mapped         distant Caenorhabditis    6546   21807.96,24975.79 10728.5,11877.5        55   1026.25       5201.5  23638.50   2037825  23391.8720  65371.9749</span></span>
<span><span class="co">## 67          mapped         distant     Drosophila    5959   15413.96,17007.28     7325.5,8328        54    701.00       3134.0  17379.50    532037  16210.6196  31370.6132</span></span>
<span><span class="co">## 68          mapped         distant          Ciona    8189   20019.71,21418.06 12785.5,13770.5        61   2203.00       8358.0  25455.00    526016  20718.8846  32276.7284</span></span>
<span><span class="co">## 69          mapped         distant     Oikopleura   69749     4862.84,5020.76   2181.5,2245.5        51    311.00       1311.0   4411.00    218004   4941.7983  10639.7762</span></span>
<span><span class="co">## 70          mapped different_genus           &lt;NA&gt;    2708     1582.66,1962.34         653,731        78    189.00        469.5   1243.00     81983   1772.4952   5038.1306</span></span>
<span><span class="co">## 71       unaligned  same_or_sister     Drosophila    9138     2583.15,3115.67       521.5,592         1     71.00        276.0   1299.00    545408   2849.4082  12984.5839</span></span>
<span><span class="co">## 72       unaligned  same_or_sister          Ciona   36133       640.21,686.43         262,269         1     71.00        220.0    444.00    169778    663.3193   2240.8260</span></span>
<span><span class="co">## 73       unaligned  same_or_sister     Oikopleura   37958       705.33,746.63       316.5,328         1     27.00        220.5    622.75     56097    725.9802   2053.0616</span></span>
<span><span class="co">## 74       unaligned           close Caenorhabditis   99450       840.06,875.41       420,426.5         1    128.00        349.0    711.00    165349    857.7356   2843.4470</span></span>
<span><span class="co">## 75       unaligned           close     Drosophila   22743     1251.61,1518.29       232,238.5         1    129.00        202.0    360.00    859148   1384.9524  10259.1500</span></span>
<span><span class="co">## 76       unaligned           close          Ciona  168424       592.73,619.35       239.5,242         1     75.00        212.0    382.00    222284    606.0407   2786.3012</span></span>
<span><span class="co">## 77       unaligned    intermediate Caenorhabditis   89243        1820,1939.05       765,776.5         1    307.00        651.0   1234.00   1210598   1879.5255   9072.9767</span></span>
<span><span class="co">## 78       unaligned    intermediate     Drosophila   68626       665.01,916.59     223.5,225.5         1    149.00        209.0    303.00   2615430    790.8018  16812.8419</span></span>
<span><span class="co">## 79       unaligned    intermediate     Oikopleura   96501       649.84,681.14     257.5,261.5         1     72.00        233.0    410.00    106962    665.4904   2480.1362</span></span>
<span><span class="co">## 80       unaligned         distant Caenorhabditis   87550     2063.33,2216.93       736,750.5         1    201.00        571.0   1305.00   1062215   2140.1281  11593.9599</span></span>
<span><span class="co">## 81       unaligned         distant     Drosophila   47867     2115.49,2325.33     1100,1125.5         1    424.00        853.0   1868.00   1031382   2220.4080  11711.7224</span></span>
<span><span class="co">## 82       unaligned         distant          Ciona  138550     1507.32,1563.34         673,683         1    301.00        497.0   1147.00    340903   1535.3326   5319.4596</span></span>
<span><span class="co">## 83       unaligned         distant     Oikopleura  248924       864.59,895.56     380.5,384.5         1    154.00        309.0    639.00    283076    880.0764   3941.8615</span></span>
<span><span class="co">## 84       unaligned different_genus           &lt;NA&gt;    4443    51033.47,56289.1 31315.5,35664.5         1   1059.00      12496.0  72354.50   1318064  53661.2845  89344.3051</span></span>
<span><span class="co">## 85         unmaped  same_or_sister     Drosophila    2616     6516.25,8298.34     2456,2975.5         1    266.75       1311.0   5929.50    545408   7407.2924  23241.7218</span></span>
<span><span class="co">## 86         unmaped  same_or_sister          Ciona    6304     1718.19,1933.18    905.5,1002.5         1     24.00        521.0   1977.50    169778   1825.6851   4353.8685</span></span>
<span><span class="co">## 87         unmaped  same_or_sister     Oikopleura   13396      1049.23,1142.4     434.5,471.5         1      9.00        209.0    989.25     56097   1095.8156   2750.6950</span></span>
<span><span class="co">## 88         unmaped           close Caenorhabditis   18898     1838.96,1998.78     735.5,779.5         1     89.00        473.0   1517.00    165349   1918.8722   5604.5425</span></span>
<span><span class="co">## 89         unmaped           close     Drosophila    1776   10099.58,13319.72       4087,5246         1    407.50       2005.5  10593.00    859148  11709.6492  34595.6295</span></span>
<span><span class="co">## 90         unmaped           close          Ciona   13298     2842.81,3131.98       1138,1230         1     82.00        595.0   2508.75    222284   2987.3928   8505.9641</span></span>
<span><span class="co">## 91         unmaped    intermediate Caenorhabditis    6914     8589.35,9904.43       4090,4416         1    934.25       2774.5   7995.25   1210598   9246.8896  27890.7597</span></span>
<span><span class="co">## 92         unmaped    intermediate     Drosophila     984   23497.61,40593.44     1173,1914.5         1    313.75        693.5   4526.00   2615430  32045.5264 136638.9172</span></span>
<span><span class="co">## 93         unmaped    intermediate     Oikopleura   17332     1951.06,2110.28       647.5,699         1     92.00        321.0   1489.00    106962   2030.6699   5347.2715</span></span>
<span><span class="co">## 94         unmaped         distant Caenorhabditis    6528   11351.82,13170.47   5358.5,5799.5         1   1237.75       3847.0  10231.50   1062215  12261.1434  37478.3028</span></span>
<span><span class="co">## 95         unmaped         distant     Drosophila    5951     5780.24,7400.13     2069.5,2221         1    772.50       1602.0   3679.50   1031382   6590.1850  31872.2350</span></span>
<span><span class="co">## 96         unmaped         distant          Ciona    8137     9082.69,9868.25       5618,5949         1   1916.00       4319.0   9995.00    340903   9475.4708  18074.6835</span></span>
<span><span class="co">## 97         unmaped         distant     Oikopleura   69607      1748.1,1853.14     675.5,694.5         1    160.00        430.0   1319.00    283076   1800.6193   7069.6154</span></span>
<span><span class="co">## 98         unmaped different_genus           &lt;NA&gt;    2679   83929.15,91617.44 66459.5,73084.5         1  19851.50      55753.0 119267.50   1318064  87773.2912 101470.9185</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="va">old.o</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/detach.html" class="external-link">detach</a></span><span class="op">(</span><span class="st">'package:dplyr'</span><span class="op">)</span></span></code></pre></div>
</details>
</div>
</div>
<div class="section level2">
<h2 id="width-distribution-of-aligned-and-mapped-regions">Width distribution of aligned and mapped regions<a class="anchor" aria-label="anchor" href="#width-distribution-of-aligned-and-mapped-regions"></a>
</h2>
<div class="section level3">
<h3 id="aligned-regions">Aligned regions<a class="anchor" aria-label="anchor" href="#aligned-regions"></a>
</h3>
<div class="section level4">
<h4 id="whole-genomes">Whole genomes<a class="anchor" aria-label="anchor" href="#whole-genomes"></a>
</h4>
<p><em>Aligned</em> means “before coalescing” and <em>mapped</em> means
“after coalescing”.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">gbs</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">genus</span> <span class="op">+</span> <span class="va">class</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of aligned region widths"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">names_table</span><span class="op">$</span><span class="va">class</span><span class="op">)</span></span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_before_coalescing-1.png" width="960"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">gbs</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">genus</span> <span class="op">==</span> <span class="st">"Oikopleura"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of aligned region widths"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">names_table</span><span class="op">$</span><span class="va">query</span><span class="op">)</span></span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_before_coalescing-2.png" width="960"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">gbs</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">class</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">genus</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of aligned region widths"</span><span class="op">)</span></span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_before_coalescing2-1.png" width="576"></p>
</div>
<div class="section level4">
<h4 id="faceted-by-arms">Faceted by arms<a class="anchor" aria-label="anchor" href="#faceted-by-arms"></a>
</h4>
<p>The distribution of widths is not the same on long and short
arms.</p>
<p>Note that for this reason, it would be unwise to filter by width on
some operations such as coalescing.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">gbs</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">chr</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of aligned region widths"</span><span class="op">)</span></span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/widths_gbs_by_arm-1.png" width="700"></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">gbs</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">chr</span> <span class="op">==</span> <span class="st">"chr1"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of aligned region widths on chr1"</span><span class="op">)</span></span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/widths_gbs_by_arm-2.png" width="700"></p>
<p>Width distribution per arm follows similar pattern on chr2 (first
graph). Pairs at a similar evolutionary distance show similar profile,
with the exception of Osa_Aom, where the number of alignments on short
arms is higher. Nevertheless, the trend of widths being longer on long
arms stay true, so we can average them in the plot below.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">gbs</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">chr</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="st">"chr2"</span>, <span class="st">"PAR"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, nrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of alignment widths before collapsing, split by distance group"</span><span class="op">)</span></span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/widths_gbs2_by_arm-1.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="unaligned-regions">Unaligned regions<a class="anchor" aria-label="anchor" href="#unaligned-regions"></a>
</h3>
<p>Unaligned regions show no difference of width between arms, except
perhaps at the “same population” level.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">unal</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">chr</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of unaligned region widths"</span><span class="op">)</span></span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/widths_unaligned-1.png" width="700"></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">unal</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">chr</span> <span class="op">==</span> <span class="st">"chr1"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of unaligned region widths"</span><span class="op">)</span></span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/widths_unaligned-2.png" width="700"></p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">unal</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">chr</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="st">"chr2"</span>, <span class="st">"PAR"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of unaligned region widths"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">300</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="st">"Width (vertical bar at 300 bp)"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Scale for <span style="color: #00BB00;">x</span> is already present.</span></span>
<span><span class="co">## Adding another scale for <span style="color: #00BB00;">x</span>, which will replace the existing scale.</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/widths_unaligned-3.png" width="700"></p>
<p>Interestingly, only in Oikopleura do the width distributions from
pairs of different distance peak at the same size. Could that be because
the genome is very compact?</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">unal</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">chr</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="st">"chr2"</span>, <span class="st">"PAR"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of unaligned region widths"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">300</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="st">"Width (vertical bar at 300 bp)"</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">names_table</span><span class="op">$</span><span class="va">query</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Scale for <span style="color: #00BB00;">x</span> is already present.</span></span>
<span><span class="co">## Adding another scale for <span style="color: #00BB00;">x</span>, which will replace the existing scale.</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/widths_unaligned2-1.png" width="700"></p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">unal</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">class</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">genus</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of unaligned region widths"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">300</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="st">"Width (vertical bar at 300 bp)"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Scale for <span style="color: #00BB00;">x</span> is already present.</span></span>
<span><span class="co">## Adding another scale for <span style="color: #00BB00;">x</span>, which will replace the existing scale.</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/widths_unaligned2-2.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="mapped-coalesced-regions">Mapped (coalesced) regions<a class="anchor" aria-label="anchor" href="#mapped-coalesced-regions"></a>
</h3>
<p>After coalescing, some width distribution become clearly bimodal. The
distributions are hard to compare between genera and between
evolutionary distance groups, and even within group for the “same
population” <em>Oikopleura</em>.</p>
<p>The plots below display the data in details for the reader to make
their opinion about the above statement.</p>
<div class="section level4">
<h4 id="whole-data">Whole data<a class="anchor" aria-label="anchor" href="#whole-data"></a>
</h4>
<div class="section level5">
<h5 id="width-distributions-">Width distributions.<a class="anchor" aria-label="anchor" href="#width-distributions-"></a>
</h5>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using after_stat(density) to make more meaningful comparisons between genus</span></span>
<span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">genus</span> <span class="op">+</span> <span class="va">class</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of mapped region widths"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">names_table</span><span class="op">$</span><span class="va">query</span><span class="op">)</span></span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_after_coalescing-1.png" width="1152"></p>
<p>Faceting by genus only. Why is North / North (“intermediate”) not
bimodal?</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">class</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">genus</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of mapped region widths"</span><span class="op">)</span></span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_after_coalescing2-1.png" width="768"></p>
<p>What is in the first peak of the bimodal distributions ?</p>
</div>
<div class="section level5">
<h5 id="empirical-cumulative-distributions">Empirical cumulative distributions<a class="anchor" aria-label="anchor" href="#empirical-cumulative-distributions"></a>
</h5>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, col <span class="op">=</span> <span class="va">genus</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_ecdf.html" class="external-link">stat_ecdf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>,<span class="fl">5e6</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">class</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 15 rows containing non-finite values (`stat_ecdf()`).</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/width_after_coalescing_ecdf-1.png" width="1152"></p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, col <span class="op">=</span> <span class="va">class</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_ecdf.html" class="external-link">stat_ecdf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>,<span class="fl">5e6</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">genus</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 15 rows containing non-finite values (`stat_ecdf()`).</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/width_after_coalescing_ecdf-2.png" width="1152"></p>
</div>
<div class="section level5">
<h5 id="cumulative-sums-">Cumulative sums.<a class="anchor" aria-label="anchor" href="#cumulative-sums-"></a>
</h5>
<p>Note: there is a bug: the lines jump between replicates instead of
plotting them separately</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">widths</span><span class="op">$</span><span class="va">coa</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">width</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cumsum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">width</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">class</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">width</span>, y <span class="op">=</span> <span class="va">cumsum</span>, col <span class="op">=</span> <span class="va">genus</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_after_coalescing_cumsum-1.png" width="1152"></p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">widths</span><span class="op">$</span><span class="va">coa</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">width</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cumsum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">width</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">genus</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">width</span>, y <span class="op">=</span> <span class="va">cumsum</span>, col <span class="op">=</span> <span class="va">class</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_after_coalescing_cumsum-2.png" width="1152"></p>
</div>
</div>
<div class="section level4">
<h4 id="by-arm">By arm<a class="anchor" aria-label="anchor" href="#by-arm"></a>
</h4>
<p>When faceted by chromosome and arm type, bimodality is also observed.
There is a small peak under 500 bp, found on all arms except YSR. The
second peak shows two different distributions for long and short
arms.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">chr</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of alignment widths after collapsing, split by arm."</span><span class="op">)</span></span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_after_coalescing3-1.png" width="700"></p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">flag</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">chr</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of alignment widths after collapsing, split by flag."</span><span class="op">)</span></span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_after_coalescing3-2.png" width="700"></p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of alignment widths on chr1 after collapsing, split by genome pair"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_after_coalescing3-3.png" width="700"></p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">chr</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="st">"chr2"</span>, <span class="st">"PAR"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of alignment widths after collapsing, split by distance group"</span><span class="op">)</span></span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_after_coalescing3-4.png" width="700"></p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">chr</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="st">"chr2"</span>, <span class="st">"PAR"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">flag</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">class</span> <span class="op">+</span> <span class="va">flag</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of alignment widths after collapsing, split by distance group"</span><span class="op">)</span></span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_after_coalescing3-5.png" width="700"></p>
<p>Therefore, if the first peak represented events that we do not want
to consider breaking synteny (either alignment artefacts or
insertion/transpositions of short mobile elements), we could re-coalesce
once after removing the shortest intervals. We tried some width cutoffs
on the coalescing step, but at 500 bp, the coverage of the genome by the
resulting mapped regions is already decreasing
(<code><a href="../articles/CoalescingCutoffs.html">vignette("CoalescingCutoffs", package = "OikScrambling")</a></code>).</p>
</div>
<div class="section level4">
<h4 id="non-coalesced-mapped-regions">Non-coalesced mapped regions<a class="anchor" aria-label="anchor" href="#non-coalesced-mapped-regions"></a>
</h4>
<p>The mapped regions that are found identical in the aligned set are
those that were not coalesced… Are they the small peak ?</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">widths</span><span class="op">$</span><span class="va">coa</span><span class="op">$</span><span class="va">nonCoa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">coa</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">nonCoa</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="focus-on-oki-north-comparisons">Focus on Oki – North comparisons<a class="anchor" aria-label="anchor" href="#focus-on-oki-north-comparisons"></a>
</h4>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_all</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"Oki – North"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of mapped region widths (vline at 600)"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">600</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_coa_map</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"Oki – North"</span>, <span class="va">Arm</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"short"</span>, <span class="st">"long"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"FALSE = collapsed, TRUE = non-collapsed"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">600</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">nonCoa</span> <span class="op">+</span> <span class="va">Arm</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_all</span> <span class="op">+</span> <span class="va">p_coa_map</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">'collect'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/mapped_region_widths_Oki_vs_North-1.png" width="700"></p>
<p>The short-width mapped peak is made of aligned regions that can not
be coalesced.</p>
<p>We know from
<code><a href="../articles/RepeatRegions.html">vignette("RepeatRegions", package = "OikScrambling")</a></code> that
these short mapped regions are not repeats.</p>
</div>
</div>
<div class="section level3">
<h3 id="unmapped-regions">Unmapped regions<a class="anchor" aria-label="anchor" href="#unmapped-regions"></a>
</h3>
<p>Unmapped regions are a bit longer on the short arm in Oki – North
comparisons…</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">unmap</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">chr</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of unmapped regions width after collapsing, split by arm."</span><span class="op">)</span></span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_of_unmapped_regions-1.png" width="700"></p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">unmap</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of unmapped regions width after collapsing, split by genome pair"</span><span class="op">)</span></span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_of_unmapped_regions-2.png" width="700"></p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">unmap</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">chr</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="st">"chr2"</span>, <span class="st">"PAR"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, nrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of unmapped region widths after collapsing, split by distance group"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">300</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="st">"Width (vertical bar at 300 bp)"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Scale for <span style="color: #00BB00;">x</span> is already present.</span></span>
<span><span class="co">## Adding another scale for <span style="color: #00BB00;">x</span>, which will replace the existing scale.</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/width_of_unmapped_regions-3.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="bridge-regions">Bridge regions<a class="anchor" aria-label="anchor" href="#bridge-regions"></a>
</h3>
<p>Note the short peak when comparing pairs within the same
population.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">bri</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">chr</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of widths of bridge regions, split by arm."</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 22514 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/width_of_unAlmapped_regions-1.png" width="700"></p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">bri</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of widths of bridge regions, split by genome pair"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></span>
<span><span class="co">## Removed 22514 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/width_of_unAlmapped_regions-2.png" width="700"></p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">bri</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">chr</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="st">"chr2"</span>, <span class="st">"PAR"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, nrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of widths of bridge regions, split by distance group"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">300</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="st">"Width (vertical bar at 300 bp)"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Scale for <span style="color: #00BB00;">x</span> is already present.</span></span>
<span><span class="co">## Adding another scale for <span style="color: #00BB00;">x</span>, which will replace the existing scale.</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 5425 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/width_of_unAlmapped_regions-3.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="translocated-regions">Translocated regions<a class="anchor" aria-label="anchor" href="#translocated-regions"></a>
</h3>
<div class="section level4">
<h4 id="whole-region">Whole region<a class="anchor" aria-label="anchor" href="#whole-region"></a>
</h4>
<p>Reminder: here we measure the distance between the two colinear pairs
that are separated by the translocated pair.</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">tra</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">chr</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of widths of translocated regions, split by arm."</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 216 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/width_of_translocated_regions-1.png" width="700"></p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">tra</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of widths of translocated regions, split by genome pair"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></span>
<span><span class="co">## Removed 216 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/width_of_translocated_regions-2.png" width="700"></p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">tra</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">chr</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="st">"chr2"</span>, <span class="st">"PAR"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, nrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of widths of translocated regions, split by distance group"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">300</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="st">"Width (vertical bar at 300 bp)"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Scale for <span style="color: #00BB00;">x</span> is already present.</span></span>
<span><span class="co">## Adding another scale for <span style="color: #00BB00;">x</span>, which will replace the existing scale.</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 125 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/width_of_translocated_regions-3.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="whole-region-after-removal">Whole region, after removal<a class="anchor" aria-label="anchor" href="#whole-region-after-removal"></a>
</h4>
<p>Small peak in <em>“same pop”</em> disapears by design. Total number
in the main peak also decreases, because they may pass the size filter
on the <em>query</em> genome.</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">tra2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">chr</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of widths of translocated regions (after removal), split by arm."</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 10 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/width_of_translocated_regions_rem-1.png" width="700"></p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">tra2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of widths of translocated regions (after removal), split by genome pair"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></span>
<span><span class="co">## Removed 10 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/width_of_translocated_regions_rem-2.png" width="700"></p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">tra2</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">chr</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="st">"chr2"</span>, <span class="st">"PAR"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, nrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of widths of translocated regions (after removal), split by distance group"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">300</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="st">"Width (vertical bar at 300 bp)"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Scale for <span style="color: #00BB00;">x</span> is already present.</span></span>
<span><span class="co">## Adding another scale for <span style="color: #00BB00;">x</span>, which will replace the existing scale.</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 2 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/width_of_translocated_regions_rem-3.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="aligned-before-removal">Aligned, before removal<a class="anchor" aria-label="anchor" href="#aligned-before-removal"></a>
</h4>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">widths</span><span class="op">$</span><span class="va">tra_coa_aln</span>   <span class="op">&lt;-</span> <span class="fu">makeWidthsDF</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">coa</span>, \<span class="op">(</span><span class="va">gb</span><span class="op">)</span> <span class="va">gb</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/flagTranslocations.html" class="external-link">flagTranslocations</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/filterTranslocations.html" class="external-link">filterTranslocations</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">tra_coa_aln</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">chr</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of widths of translocated regions (aligned), split by arm."</span><span class="op">)</span></span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_of_translocated_regions_coa_aligned-1.png" width="700"></p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">tra_coa_aln</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of widths of translocated regions (aligned), split by genome pair"</span><span class="op">)</span></span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_of_translocated_regions_coa_aligned-2.png" width="700"></p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">tra_coa_aln</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">chr</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="st">"chr2"</span>, <span class="st">"PAR"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, nrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of widths of translocated regions (aligned), split by distance group"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">300</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="st">"Width (vertical bar at 300 bp)"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Scale for <span style="color: #00BB00;">x</span> is already present.</span></span>
<span><span class="co">## Adding another scale for <span style="color: #00BB00;">x</span>, which will replace the existing scale.</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/width_of_translocated_regions_coa_aligned-3.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="aligned-after-removal">Aligned, after removal<a class="anchor" aria-label="anchor" href="#aligned-after-removal"></a>
</h4>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">widths</span><span class="op">$</span><span class="va">tra_coa2_aln</span>   <span class="op">&lt;-</span> <span class="fu">makeWidthsDF</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">coa2</span>, \<span class="op">(</span><span class="va">gb</span><span class="op">)</span> <span class="va">gb</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/flagTranslocations.html" class="external-link">flagTranslocations</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/filterTranslocations.html" class="external-link">filterTranslocations</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">tra_coa2_aln</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">chr</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of widths of translocated regions (aligned, after removal), split by arm."</span><span class="op">)</span></span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_of_translocated_regions_coa2_aligned-1.png" width="700"></p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">tra_coa2_aln</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of widths of translocated regions (aligned, after removal), split by genome pair"</span><span class="op">)</span></span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_of_translocated_regions_coa2_aligned-2.png" width="700"></p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">tra_coa2_aln</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">chr</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="st">"chr2"</span>, <span class="st">"PAR"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, nrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of widths of translocated regions (aligned, after removal), split by distance group"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">300</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="st">"Width (vertical bar at 300 bp)"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Scale for <span style="color: #00BB00;">x</span> is already present.</span></span>
<span><span class="co">## Adding another scale for <span style="color: #00BB00;">x</span>, which will replace the existing scale.</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/width_of_translocated_regions_coa2_aligned-3.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="double-coalesced-regions">Double-coalesced regions<a class="anchor" aria-label="anchor" href="#double-coalesced-regions"></a>
</h3>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">chr</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of alignment widths after double-collapsing, split by arm."</span><span class="op">)</span></span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/re_coalesce-1.png" width="700"></p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of widthsof alignment widths after double-collapsing, split by genome pair"</span><span class="op">)</span></span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/re_coalesce-2.png" width="700"></p>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa2</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">chr</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="st">"chr2"</span>, <span class="st">"PAR"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, nrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of alignment widths after double-collapsing, split by distance group"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">500</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="st">"Width (vertical bar at 500 bp)"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Scale for <span style="color: #00BB00;">x</span> is already present.</span></span>
<span><span class="co">## Adding another scale for <span style="color: #00BB00;">x</span>, which will replace the existing scale.</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/re_coalesce-3.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="compound-pictures">Compound pictures<a class="anchor" aria-label="anchor" href="#compound-pictures"></a>
</h2>
<div class="section level3">
<h3 id="aligned-unaligned-and-mapped">“aligned”, “unaligned” and “mapped”<a class="anchor" aria-label="anchor" href="#aligned-unaligned-and-mapped"></a>
</h3>
<div class="section level4">
<h4 id="facet-by-genus">Facet by genus<a class="anchor" aria-label="anchor" href="#facet-by-genus"></a>
</h4>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_ali</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">gbs</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">genus</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">class</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">genus</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Aligned"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_una</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">unal</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">genus</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">class</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">genus</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Not aligned"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_map</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">genus</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">class</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">genus</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Mapped"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Patchwork</span></span>
<span><span class="op">(</span><span class="va">p_ali</span> <span class="op">|</span> <span class="va">p_una</span> <span class="op">|</span> <span class="va">p_map</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">3</span>, guides <span class="op">=</span> <span class="st">'collect'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/compound1-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="oik-only-color-by-distance">Oik only, color by distance<a class="anchor" aria-label="anchor" href="#oik-only-color-by-distance"></a>
</h4>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_isol</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">isol</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">genus</span> <span class="op">==</span> <span class="st">"Oikopleura"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">class</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Isolated alignments"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_unma</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">unmap</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">genus</span> <span class="op">==</span> <span class="st">"Oikopleura"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">class</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Unmapped"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_coar</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">genus</span> <span class="op">==</span> <span class="st">"Oikopleura"</span>, <span class="op">!</span><span class="va">nonCoa</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">class</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Colinear regions"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_brid</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">bri</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">genus</span> <span class="op">==</span> <span class="st">"Oikopleura"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">class</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Bridge regions"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_coal</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">gbs</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">genus</span> <span class="op">==</span> <span class="st">"Oikopleura"</span>, <span class="op">!</span><span class="va">nonCoa</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">class</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Colinear alignments"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Patchwork</span></span>
<span><span class="op">(</span><span class="va">p_isol</span> <span class="op">|</span> <span class="va">p_unma</span> <span class="op">|</span> <span class="va">p_coar</span> <span class="op">|</span> <span class="va">p_brid</span> <span class="op">|</span> <span class="va">p_coal</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">1</span>, guides <span class="op">=</span> <span class="st">'collect'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 7561 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/compound1_oik-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="oik-only-color-by-alignment-class">Oik only, color by alignment class<a class="anchor" aria-label="anchor" href="#oik-only-color-by-alignment-class"></a>
</h4>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="va">widths</span><span class="op">$</span><span class="va">isol</span>  <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">genus</span> <span class="op">==</span> <span class="st">"Oikopleura"</span><span class="op">)</span>           <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>aliclass <span class="op">=</span> <span class="st">"Isol"</span><span class="op">)</span>,</span>
<span>  <span class="va">widths</span><span class="op">$</span><span class="va">unmap</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">genus</span> <span class="op">==</span> <span class="st">"Oikopleura"</span><span class="op">)</span>           <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>aliclass <span class="op">=</span> <span class="st">"Unmap"</span><span class="op">)</span>,</span>
<span>  <span class="va">widths</span><span class="op">$</span><span class="va">coa</span>   <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">genus</span> <span class="op">==</span> <span class="st">"Oikopleura"</span>, <span class="op">!</span><span class="va">nonCoa</span><span class="op">)</span>  <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>aliclass <span class="op">=</span> <span class="st">"Col reg"</span><span class="op">)</span>,</span>
<span>  <span class="va">widths</span><span class="op">$</span><span class="va">bri</span>   <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">genus</span> <span class="op">==</span> <span class="st">"Oikopleura"</span><span class="op">)</span>           <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>aliclass <span class="op">=</span> <span class="st">"Bridge"</span><span class="op">)</span>,</span>
<span>  <span class="va">widths</span><span class="op">$</span><span class="va">gbs</span>   <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">genus</span> <span class="op">==</span> <span class="st">"Oikopleura"</span>, <span class="op">!</span><span class="va">nonCoa</span><span class="op">)</span>  <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>aliclass <span class="op">=</span> <span class="st">"Col aln"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">aliclass</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">class</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 7561 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/compound1_alignment_classes-1.png" width="700"></p>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">w</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">class</span> <span class="op">==</span> <span class="st">"distant"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">aliclass</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 1406 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/compound1_alignment_classes-2.png" width="700"></p>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">w</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">class</span> <span class="op">==</span> <span class="st">"distant"</span><span class="op">)</span>, scale <span class="op">=</span> <span class="st">"natural"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">aliclass</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3e3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 49725 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 10 rows containing missing values (`geom_path()`).</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/compound1_alignment_classes-3.png" width="700"></p>
<div class="section level5">
<h5 id="for-figure-2">For figure 2<a class="anchor" aria-label="anchor" href="#for-figure-2"></a>
</h5>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'dplyr'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:Biostrings':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     collapse, intersect, setdiff, setequal, union</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:XVector':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     slice</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:GenomicRanges':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     intersect, setdiff, union</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:GenomeInfoDb':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     intersect</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:IRanges':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     collapse, desc, intersect, setdiff, slice, union</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:S4Vectors':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     first, intersect, rename, setdiff, setequal, union</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:BiocGenerics':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     combine, intersect, setdiff, union</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     filter, lag</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     intersect, setdiff, setequal, union</span></span></code></pre>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Frequency table is pre-computed so that ggplot2 can smooth over the different alignment pairs</span></span>
<span></span>
<span><span class="va">wfreq</span> <span class="op">&lt;-</span> <span class="va">w</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">class</span> <span class="op">==</span> <span class="st">"distant"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">aliclass</span>, <span class="va">name</span>, <span class="va">width</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">aliclass</span>, <span class="va">name</span><span class="op">)</span> <span class="op">|&gt;</span>          </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>prop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/proportions.html" class="external-link">prop.table</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Smoothing with loess to see the 3 peaks in bridge regions</span></span>
<span></span>
<span><span class="va">wfreq</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">width</span> <span class="op">&lt;=</span> <span class="fl">500</span>, <span class="va">aliclass</span> <span class="op">!=</span> <span class="st">"Col reg"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="va">prop</span>, col <span class="op">=</span> <span class="va">aliclass</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>span <span class="op">=</span> <span class="fl">.15</span>, method <span class="op">=</span> <span class="st">"loess"</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">500</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/compound1_alignment_classes_part-1.svg" width="960"></p>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plotting the collinear regions separately because their length distribution is</span></span>
<span><span class="co"># on a different scale.</span></span>
<span></span>
<span><span class="va">wfreq</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">width</span> <span class="op">&gt;=</span> <span class="fl">250</span>, <span class="va">aliclass</span> <span class="op">==</span> <span class="st">"Col reg"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="va">prop</span>, col <span class="op">=</span> <span class="va">aliclass</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>span <span class="op">=</span> <span class="fl">.15</span>, method <span class="op">=</span> <span class="st">"loess"</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">250</span>, <span class="fl">1e5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 77 rows containing non-finite values (`stat_smooth()`).</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/compound1_alignment_classes_part-2.svg" width="960"></p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="isolated-unmapped-colinear-regions-bridge-and-colinear-alingments">“isolated”, “unmapped”, “colinear regions”, “bridge” and “colinear
alingments”<a class="anchor" aria-label="anchor" href="#isolated-unmapped-colinear-regions-bridge-and-colinear-alingments"></a>
</h3>
<div class="section level4">
<h4 id="oki-north">Oki – North<a class="anchor" aria-label="anchor" href="#oki-north"></a>
</h4>
<div class="sourceCode" id="cb125"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_ali2</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">gbs</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"Oki – North"</span>, <span class="va">nonCoa</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">60</span>, scale <span class="op">=</span> <span class="st">"natural"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3e3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Isolated alignments"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_unmap2</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">unmap</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"Oki – North"</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">60</span>, scale <span class="op">=</span> <span class="st">"natural"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3e3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Unmapped"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_syn2</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"Oki – North"</span>, <span class="op">!</span><span class="va">nonCoa</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">600</span>, scale <span class="op">=</span> <span class="st">"natural"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3e4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Colinear region"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_map2</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">gbs</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"Oki – North"</span>, <span class="op">!</span><span class="va">nonCoa</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">60</span>, scale <span class="op">=</span> <span class="st">"natural"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3e3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Colinear alignment"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_bridge</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">bri</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"Oki – North"</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">20</span>, scale <span class="op">=</span> <span class="st">"natural"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3e3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Bridge"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Patchwork</span></span>
<span><span class="va">p_oki_north</span> <span class="op">&lt;-</span><span class="op">(</span><span class="va">p_ali2</span> <span class="op">|</span> <span class="va">p_unmap2</span> <span class="op">|</span> <span class="va">p_syn2</span> <span class="op">|</span> <span class="va">p_bridge</span> <span class="op">|</span> <span class="va">p_map2</span> <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">5</span>, guides <span class="op">=</span> <span class="st">'collect'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html" class="external-link">plot_annotation</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Okinawa vs North"</span><span class="op">)</span></span>
<span><span class="va">p_oki_north</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 1485 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 16 rows containing missing values (`geom_path()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 8089 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 16 rows containing missing values (`geom_path()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 2326 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 16 rows containing missing values (`geom_path()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 3190 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 16 rows containing missing values (`geom_path()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 15668 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 16 rows containing missing values (`geom_path()`).</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/compound2-1.svg" width="1920"></p>
</div>
<div class="section level4">
<h4 id="north-north">North – North<a class="anchor" aria-label="anchor" href="#north-north"></a>
</h4>
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_ali3</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">gbs</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"North – North"</span>, <span class="va">nonCoa</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">60</span>, scale <span class="op">=</span> <span class="st">"natural"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3e3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Isolated alignments"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_unmap3</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">unmap</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"North – North"</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">60</span>, scale <span class="op">=</span> <span class="st">"natural"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3e3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Unmapped"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_syn3</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"North – North"</span>, <span class="op">!</span><span class="va">nonCoa</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">600</span>, scale <span class="op">=</span> <span class="st">"natural"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3e4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Colinear region"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_map3</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">gbs</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"North – North"</span>, <span class="op">!</span><span class="va">nonCoa</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">60</span>, scale <span class="op">=</span> <span class="st">"natural"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3e3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Colinear alignment"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_bridge3</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">bri</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"North – North"</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">20</span>, scale <span class="op">=</span> <span class="st">"natural"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3e3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Bridge"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Patchwork</span></span>
<span><span class="va">p_north_north</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">p_ali3</span> <span class="op">|</span> <span class="va">p_unmap3</span> <span class="op">|</span> <span class="va">p_syn3</span> <span class="op">|</span> <span class="va">p_bridge3</span> <span class="op">|</span> <span class="va">p_map3</span> <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">5</span>, guides <span class="op">=</span> <span class="st">'collect'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html" class="external-link">plot_annotation</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"North vs North"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb137"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_ali4</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">gbs</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"In same pop"</span>, <span class="va">nonCoa</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">60</span>, scale <span class="op">=</span> <span class="st">"natural"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3e3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Isolated alignments"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_unmap4</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">unmap</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"In same pop"</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">60</span>, scale <span class="op">=</span> <span class="st">"natural"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3e3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Unmapped"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_syn4</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"In same pop"</span>, <span class="op">!</span><span class="va">nonCoa</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">600</span>, scale <span class="op">=</span> <span class="st">"natural"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3e4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Colinear region"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_map4</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">gbs</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"In same pop"</span>, <span class="op">!</span><span class="va">nonCoa</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">60</span>, scale <span class="op">=</span> <span class="st">"natural"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3e3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Colinear alignment"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_bridge4</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">bri</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"In same pop"</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">20</span>, scale <span class="op">=</span> <span class="st">"natural"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3e3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Bridge"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Patchwork</span></span>
<span><span class="va">p_same_pop</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">p_ali4</span> <span class="op">|</span> <span class="va">p_unmap4</span> <span class="op">|</span> <span class="va">p_syn4</span> <span class="op">|</span> <span class="va">p_bridge4</span> <span class="op">|</span> <span class="va">p_map4</span> <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">5</span>, guides <span class="op">=</span> <span class="st">'collect'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html" class="external-link">plot_annotation</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Same population"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb138"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_oki_north</span>    <span class="op">/</span></span>
<span><span class="va">p_north_north</span>  <span class="op">/</span></span>
<span><span class="va">p_same_pop</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Removed 1485 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 16 rows containing missing values (`geom_path()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 8089 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 16 rows containing missing values (`geom_path()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 2326 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 16 rows containing missing values (`geom_path()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 3190 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 16 rows containing missing values (`geom_path()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 15668 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 16 rows containing missing values (`geom_path()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 431 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 8 rows containing missing values (`geom_path()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 2700 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 8 rows containing missing values (`geom_path()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 1402 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 8 rows containing missing values (`geom_path()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 876 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 8 rows containing missing values (`geom_path()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 11985 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 8 rows containing missing values (`geom_path()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 1031 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 6 rows containing missing values (`geom_path()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 1229 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 6 rows containing missing values (`geom_path()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 1482 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 6 rows containing missing values (`geom_path()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 614 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 6 rows containing missing values (`geom_path()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 12048 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 6 rows containing missing values (`geom_path()`).</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/compound_all-1.svg" width="1920"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="paired-comparison-of-widths-in-target-and-query-genomes-">Paired comparison of widths in target and query genomes.<a class="anchor" aria-label="anchor" href="#paired-comparison-of-widths-in-target-and-query-genomes-"></a>
</h2>
<div class="sourceCode" id="cb169"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">GBreaks2widthTibble</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">gb</span>, <span class="va">pair</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">gb</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Arm</span><span class="op">)</span><span class="op">)</span>       <span class="va">df</span><span class="op">$</span><span class="va">Arm</span>        <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">rep</span><span class="op">)</span><span class="op">)</span>       <span class="va">df</span><span class="op">$</span><span class="va">rep</span>        <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">query.rep</span><span class="op">)</span><span class="op">)</span> <span class="va">df</span><span class="op">$</span><span class="va">query.rep</span>  <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>target     <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">width</span>,        query     <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">query.width</span>,</span>
<span>                 target.rep <span class="op">=</span> <span class="op">!</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">rep</span><span class="op">)</span>, query.rep <span class="op">=</span> <span class="op">!</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">query.rep</span><span class="op">)</span>,  <span class="co"># TRUE if overlaps a repeat</span></span>
<span>                 pair <span class="op">=</span> <span class="va">pair</span>, Arm <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">Arm</span>,</span>
<span>                 dist <span class="op">=</span> <span class="fu">OikScrambling</span><span class="fu">:::</span><span class="fu"><a href="../reference/compDistance.html">compDistance</a></span><span class="op">(</span><span class="va">pair</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">gbs.w2w</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">gbs</span><span class="op">)</span>,      \<span class="op">(</span><span class="va">name</span><span class="op">)</span> <span class="fu">GBreaks2widthTibble</span><span class="op">(</span><span class="va">gbs</span><span class="op">[[</span><span class="va">name</span><span class="op">]</span><span class="op">]</span>,      pair <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bri.w2s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bri</span><span class="op">)</span>,  \<span class="op">(</span><span class="va">name</span><span class="op">)</span> <span class="fu">GBreaks2widthTibble</span><span class="op">(</span><span class="va">bri</span><span class="op">[[</span><span class="va">name</span><span class="op">]</span><span class="op">]</span>,  pair <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tra.w2s</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tra</span><span class="op">)</span>,      \<span class="op">(</span><span class="va">name</span><span class="op">)</span> <span class="fu">GBreaks2widthTibble</span><span class="op">(</span><span class="va">tra</span><span class="op">[[</span><span class="va">name</span><span class="op">]</span><span class="op">]</span>,      pair <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tra2.w2s</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tra2</span><span class="op">)</span>,     \<span class="op">(</span><span class="va">name</span><span class="op">)</span> <span class="fu">GBreaks2widthTibble</span><span class="op">(</span><span class="va">tra2</span><span class="op">[[</span><span class="va">name</span><span class="op">]</span><span class="op">]</span>,     pair <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/cbind.html" class="external-link">rbind</a></span> <span class="op">(</span></span>
<span>  aligned <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span>    <span class="va">gbs.w2w</span><span class="op">$</span><span class="va">target.rep</span>,     <span class="va">gbs.w2w</span><span class="op">$</span><span class="va">query.rep</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  bri <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">bri.w2s</span><span class="op">$</span><span class="va">target.rep</span>, <span class="va">bri.w2s</span><span class="op">$</span><span class="va">query.rep</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  transpo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span>    <span class="va">tra.w2s</span><span class="op">$</span><span class="va">target.rep</span>,     <span class="va">tra.w2s</span><span class="op">$</span><span class="va">query.rep</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##         FALSE FALSE FALSE TRUE TRUE FALSE TRUE TRUE</span></span>
<span><span class="co">## aligned     1049613      41624      41943     52103</span></span>
<span><span class="co">## bri          801374      84573      82538     35159</span></span>
<span><span class="co">## transpo       10377       1252       3043      2782</span></span></code></pre>
<div class="sourceCode" id="cb171"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ggPlotW2W</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">tibble</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tibble</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">target</span>, <span class="va">query</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density_2d.html" class="external-link">geom_density_2d</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">ggPlotW2W</span><span class="op">(</span><span class="va">gbs.w2w</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Arm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Width of the target and query aligned regions"</span><span class="op">)</span></span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/paired_width_analysis-1.png" width="700"></p>
<div class="sourceCode" id="cb172"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggPlotW2W</span><span class="op">(</span><span class="va">bri.w2s</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Arm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Width of the target and query bridge regions"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous y-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous y-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 14293 rows containing non-finite values (`stat_density2d()`).</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/paired_width_analysis-2.png" width="700"></p>
<div class="sourceCode" id="cb178"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggPlotW2W</span><span class="op">(</span><span class="va">gbs.w2w</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">pair</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Width of the target and query aligned regions"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: `stat_contour()`: Zero contours were generated</span></span></code></pre>
<pre><code><span><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning: `stat_contour()`: Zero contours were generated</span></span></code></pre>
<pre><code><span><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning: `stat_contour()`: Zero contours were generated</span></span></code></pre>
<pre><code><span><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning: `stat_contour()`: Zero contours were generated</span></span></code></pre>
<pre><code><span><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning: `stat_contour()`: Zero contours were generated</span></span></code></pre>
<pre><code><span><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning: `stat_contour()`: Zero contours were generated</span></span></code></pre>
<pre><code><span><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning: `stat_contour()`: Zero contours were generated</span></span></code></pre>
<pre><code><span><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning: `stat_contour()`: Zero contours were generated</span></span></code></pre>
<pre><code><span><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning: `stat_contour()`: Zero contours were generated</span></span></code></pre>
<pre><code><span><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning: `stat_contour()`: Zero contours were generated</span></span></code></pre>
<pre><code><span><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning: `stat_contour()`: Zero contours were generated</span></span></code></pre>
<pre><code><span><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning: `stat_contour()`: Zero contours were generated</span></span></code></pre>
<pre><code><span><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning: `stat_contour()`: Zero contours were generated</span></span></code></pre>
<pre><code><span><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning: `stat_contour()`: Zero contours were generated</span></span></code></pre>
<pre><code><span><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning: `stat_contour()`: Zero contours were generated</span></span></code></pre>
<pre><code><span><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning: `stat_contour()`: Zero contours were generated</span></span></code></pre>
<pre><code><span><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning: `stat_contour()`: Zero contours were generated</span></span></code></pre>
<pre><code><span><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning: `stat_contour()`: Zero contours were generated</span></span></code></pre>
<pre><code><span><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning: `stat_contour()`: Zero contours were generated</span></span></code></pre>
<pre><code><span><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning: `stat_contour()`: Zero contours were generated</span></span></code></pre>
<pre><code><span><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning: `stat_contour()`: Zero contours were generated</span></span></code></pre>
<pre><code><span><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning: `stat_contour()`: Zero contours were generated</span></span></code></pre>
<pre><code><span><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/paired_width_analysis-3.png" width="700"></p>
<div class="sourceCode" id="cb245"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggPlotW2W</span><span class="op">(</span><span class="va">gbs.w2w</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Width of the target and query aligned regions"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: `stat_contour()`: Zero contours were generated</span></span></code></pre>
<pre><code><span><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning: `stat_contour()`: Zero contours were generated</span></span></code></pre>
<pre><code><span><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning: `stat_contour()`: Zero contours were generated</span></span></code></pre>
<pre><code><span><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning: `stat_contour()`: Zero contours were generated</span></span></code></pre>
<pre><code><span><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning: `stat_contour()`: Zero contours were generated</span></span></code></pre>
<pre><code><span><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning: `stat_contour()`: Zero contours were generated</span></span></code></pre>
<pre><code><span><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/paired_width_analysis-4.png" width="700"></p>
<div class="sourceCode" id="cb264"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggPlotW2W</span><span class="op">(</span><span class="va">bri.w2s</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">pair</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Width of the target and query bridge regions"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous y-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous y-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 43487 rows containing non-finite values (`stat_density2d()`).</span></span></code></pre>
<pre><code><span><span class="co">## Warning: `stat_contour()`: Zero contours were generated</span></span></code></pre>
<pre><code><span><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></span></code></pre>
<pre><code><span><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/paired_width_analysis-5.png" width="700"></p>
<div class="sourceCode" id="cb273"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggPlotW2W</span><span class="op">(</span><span class="va">tra.w2s</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Arm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">pair</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Width of the target and query translocated regions"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous y-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous y-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 893 rows containing non-finite values (`stat_density2d()`).</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/paired_width_analysis-6.png" width="700"></p>
<div class="sourceCode" id="cb279"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggPlotW2W</span><span class="op">(</span><span class="va">tra.w2s</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Arm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Width of the target and query translocated regions"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous y-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous y-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 893 rows containing non-finite values (`stat_density2d()`).</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/paired_width_analysis-7.png" width="700"></p>
<div class="sourceCode" id="cb285"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggPlotW2W</span><span class="op">(</span><span class="va">tra2.w2s</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Arm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">pair</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Width of the target and query translocated regions (after removal)"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous y-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous y-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 62 rows containing non-finite values (`stat_density2d()`).</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/paired_width_analysis-8.png" width="700"></p>
<div class="sourceCode" id="cb291"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggPlotW2W</span><span class="op">(</span><span class="va">tra2.w2s</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Arm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Width of the target and query translocated regions (after removal)"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous y-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous y-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 62 rows containing non-finite values (`stat_density2d()`).</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/paired_width_analysis-9.png" width="700"></p>
<div class="sourceCode" id="cb297"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggPlotW2W</span><span class="op">(</span><span class="va">gbs.w2w</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">query.rep</span> <span class="op">+</span> <span class="va">target.rep</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Width of the target and query aligned regions, matching or not matching repeats"</span><span class="op">)</span></span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/paired_width_analysis-10.png" width="700"></p>
<div class="sourceCode" id="cb298"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggPlotW2W</span><span class="op">(</span><span class="va">bri.w2s</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">query.rep</span> <span class="op">+</span> <span class="va">target.rep</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Width of the target and query bridge regions, matching or not matching repeats"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous y-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous y-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 43487 rows containing non-finite values (`stat_density2d()`).</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/paired_width_analysis-11.png" width="700"></p>
<div class="sourceCode" id="cb304"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggPlotW2W</span><span class="op">(</span><span class="va">tra.w2s</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span> <span class="op">+</span> <span class="va">query.rep</span> <span class="op">+</span> <span class="va">target.rep</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Width of the target and query translocated regions, matching or not matching repeats"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous y-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous y-axis</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 1298 rows containing non-finite values (`stat_density2d()`).</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/paired_width_analysis-12.png" width="700"></p>
<div class="sourceCode" id="cb310"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">bri.w2s</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">target</span> <span class="op">/</span> <span class="va">query</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">target.rep</span>, <span class="va">query.rep</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_freqpoly</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"In presence of a repeat, target width tends to be longer than query"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></span></code></pre>
<pre><code><span><span class="co">## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span></code></pre>
<pre><code><span><span class="co">## Warning: Removed 43487 rows containing non-finite values (`stat_bin()`).</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/paired_width_analysis-13.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="structural-variants">Structural variants<a class="anchor" aria-label="anchor" href="#structural-variants"></a>
</h2>
<div class="section level3">
<h3 id="width-of-inverted-regions">Width of inverted regions<a class="anchor" aria-label="anchor" href="#width-of-inverted-regions"></a>
</h3>
<p>We know that we can detect more inversions after coalescing and
removing translocations
(<code><a href="../articles/Inversions.html">vignette("Inversions", package = "OikScrambling")</a></code>).</p>
<p>Many inversions are shorter than 1 kbp. Size may differ slightly
between long and short arms.</p>
<div class="sourceCode" id="cb314"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">invs.gbs</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">gbs</span>,  <span class="kw">function</span><span class="op">(</span><span class="va">gb</span><span class="op">)</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/filterInversions.html" class="external-link">filterInversions</a></span><span class="op">(</span><span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/flagInversions.html" class="external-link">flagInversions</a></span><span class="op">(</span><span class="va">gb</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/SimpleList-class.html" class="external-link">SimpleList</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">invs.coa</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">coa</span>,  <span class="kw">function</span><span class="op">(</span><span class="va">gb</span><span class="op">)</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/filterInversions.html" class="external-link">filterInversions</a></span><span class="op">(</span><span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/flagInversions.html" class="external-link">flagInversions</a></span><span class="op">(</span><span class="va">gb</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/SimpleList-class.html" class="external-link">SimpleList</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">invs.coa2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">coa2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">gb</span><span class="op">)</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/filterInversions.html" class="external-link">filterInversions</a></span><span class="op">(</span><span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/flagInversions.html" class="external-link">flagInversions</a></span><span class="op">(</span><span class="va">gb</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/SimpleList-class.html" class="external-link">SimpleList</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">invs.gbs</span>,  <span class="va">length</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Oki_Osa Oki_Bar Oki_Kum Oki_Aom Oki_Nor Osa_Oki Osa_Bar Osa_Kum Osa_Aom Osa_Nor Bar_Oki Bar_Osa Bar_Kum Bar_Aom Bar_Nor Ply_Ros Ply_Rob Ply_Sav Ply_Oki Rob_Ros Rob_Ply Rob_Sav Rob_Oki Dme_Dbu Dme_Dsu </span></span>
<span><span class="co">##     614     604      89     608     541     613     241     620      56     212     597     237     608     237      19      42      58      16       0      50      58      14       0     697      20 </span></span>
<span><span class="co">## Dme_Dya Dme_Dma Cni_Cbr Cni_Cre Cni_Cin Cbr_Cni Cbr_Cre Cbr_Cel </span></span>
<span><span class="co">##      13      12     221      91      40     236      92      64</span></span></code></pre>
<div class="sourceCode" id="cb316"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">invs.coa</span>,  <span class="va">length</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Oki_Osa Oki_Bar Oki_Kum Oki_Aom Oki_Nor Osa_Oki Osa_Bar Osa_Kum Osa_Aom Osa_Nor Bar_Oki Bar_Osa Bar_Kum Bar_Aom Bar_Nor Ply_Ros Ply_Rob Ply_Sav Ply_Oki Rob_Ros Rob_Ply Rob_Sav Rob_Oki Dme_Dbu Dme_Dsu </span></span>
<span><span class="co">##     670     675     105     665     591     671     321     678      73     275     667     319     686     319      24      51      71      92       0      65      70      92       0    1003      44 </span></span>
<span><span class="co">## Dme_Dya Dme_Dma Cni_Cbr Cni_Cre Cni_Cin Cbr_Cni Cbr_Cre Cbr_Cel </span></span>
<span><span class="co">##      21      16     300     212     132     318     200     166</span></span></code></pre>
<div class="sourceCode" id="cb318"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">invs.coa2</span>, <span class="va">length</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Oki_Osa Oki_Bar Oki_Kum Oki_Aom Oki_Nor Osa_Oki Osa_Bar Osa_Kum Osa_Aom Osa_Nor Bar_Oki Bar_Osa Bar_Kum Bar_Aom Bar_Nor Ply_Ros Ply_Rob Ply_Sav Ply_Oki Rob_Ros Rob_Ply Rob_Sav Rob_Oki Dme_Dbu Dme_Dsu </span></span>
<span><span class="co">##     704     705     122     695     611     706     330     708      79     279     695     327     711     335      27      55      76      92       0      71      77      92       0    1003      45 </span></span>
<span><span class="co">## Dme_Dya Dme_Dma Cni_Cbr Cni_Cre Cni_Cin Cbr_Cni Cbr_Cre Cbr_Cel </span></span>
<span><span class="co">##      23      16     331     216     134     358     207     166</span></span></code></pre>
<div class="sourceCode" id="cb320"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Sanity check that we detect inversions on both strands</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">invs.coa2</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/pkg/CNEr/man/Axt-util.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Rle-class.html" class="external-link">decode</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/strand.html" class="external-link">strand</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   Oki_Osa Oki_Bar Oki_Kum Oki_Aom Oki_Nor Osa_Oki Osa_Bar Osa_Kum Osa_Aom Osa_Nor Bar_Oki Bar_Osa Bar_Kum Bar_Aom Bar_Nor Ply_Ros Ply_Rob Ply_Sav Ply_Oki Rob_Ros Rob_Ply Rob_Sav Rob_Oki Dme_Dbu</span></span>
<span><span class="co">## +     381     365      33     369     317     382     186     367      38     147     354     182     365     164       7       2       6      51       0       5       5      52       0     470</span></span>
<span><span class="co">## -     323     340      89     326     294     324     144     341      41     132     341     145     346     171      20      53      70      41       0      66      72      40       0     533</span></span>
<span><span class="co">## *       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0</span></span>
<span><span class="co">##   Dme_Dsu Dme_Dya Dme_Dma Cni_Cbr Cni_Cre Cni_Cin Cbr_Cni Cbr_Cre Cbr_Cel</span></span>
<span><span class="co">## +      29      11       3      53      84      73      60      88      69</span></span>
<span><span class="co">## -      16      12      13     278     132      61     298     119      97</span></span>
<span><span class="co">## *       0       0       0       0       0       0       0       0       0</span></span></code></pre>
<div class="sourceCode" id="cb322"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">widths</span><span class="op">$</span><span class="va">invs.gbs</span>  <span class="op">&lt;-</span> <span class="fu">makeWidthsDF</span><span class="op">(</span><span class="va">invs.gbs</span><span class="op">)</span>  <span class="op">|&gt;</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">widths</span><span class="op">$</span><span class="va">invs.coa</span>  <span class="op">&lt;-</span> <span class="fu">makeWidthsDF</span><span class="op">(</span><span class="va">invs.coa</span><span class="op">)</span>  <span class="op">|&gt;</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">widths</span><span class="op">$</span><span class="va">invs.coa2</span> <span class="op">&lt;-</span> <span class="fu">makeWidthsDF</span><span class="op">(</span><span class="va">invs.coa2</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb323"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">invs.gbs</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">chr</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of alignment widths for inverted regions, using aligned regions, split by arm."</span><span class="op">)</span></span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/inversion_width_aligned-1.png" width="700"></p>
<div class="sourceCode" id="cb324"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">invs.gbs</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of alignment widths for inverted regions, using aligned regions, split by genome pair"</span><span class="op">)</span></span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/inversion_width_aligned-2.png" width="700"></p>
<div class="sourceCode" id="cb325"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">invs.gbs</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">chr</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="st">"chr2"</span>, <span class="st">"PAR"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, nrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of alignment widths for inverted regions, using aligned regions, split by distance group"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">500</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="st">"Width (vertical bar at 500 bp)"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Scale for <span style="color: #00BB00;">x</span> is already present.</span></span>
<span><span class="co">## Adding another scale for <span style="color: #00BB00;">x</span>, which will replace the existing scale.</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/inversion_width_aligned-3.png" width="700"></p>
<div class="sourceCode" id="cb327"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">invs.coa</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">chr</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of alignment widths for inverted regions, using mapped regions, split by arm."</span><span class="op">)</span></span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/inversion_width_mapped-1.png" width="700"></p>
<div class="sourceCode" id="cb328"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">invs.coa</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of alignment widths for inverted regions, using mapped regions, split by genome pair"</span><span class="op">)</span></span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/inversion_width_mapped-2.png" width="700"></p>
<div class="sourceCode" id="cb329"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">invs.coa</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">chr</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="st">"chr2"</span>, <span class="st">"PAR"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, nrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of alignment widths for inverted regions, using mapped regions, split by distance group"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">500</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="st">"Width (vertical bar at 500 bp)"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Scale for <span style="color: #00BB00;">x</span> is already present.</span></span>
<span><span class="co">## Adding another scale for <span style="color: #00BB00;">x</span>, which will replace the existing scale.</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/inversion_width_mapped-3.png" width="700"></p>
<div class="sourceCode" id="cb331"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">invs.coa2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">chr</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of alignment widths for inverted regions, using doublemapped regions, split by arm."</span><span class="op">)</span></span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/inversion_width_doublemapped-1.png" width="700"></p>
<div class="sourceCode" id="cb332"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">invs.coa2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of alignment widths for inverted regions, using doublemapped regions, split by genome pair"</span><span class="op">)</span></span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/inversion_width_doublemapped-2.png" width="700"></p>
<div class="sourceCode" id="cb333"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">invs.coa2</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">chr</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="st">"chr2"</span>, <span class="st">"PAR"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, nrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of alignment widths for inverted regions, using doublemapped regions, split by distance group"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">500</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="st">"Width (vertical bar at 500 bp)"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Scale for <span style="color: #00BB00;">x</span> is already present.</span></span>
<span><span class="co">## Adding another scale for <span style="color: #00BB00;">x</span>, which will replace the existing scale.</span></span></code></pre>
<p><img src="RegionWidths_files/figure-html/inversion_width_doublemapped-3.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="width-of-gaps-next-to-the-inverted-regions">Width of gaps next to the inverted regions<a class="anchor" aria-label="anchor" href="#width-of-gaps-next-to-the-inverted-regions"></a>
</h3>
<div class="sourceCode" id="cb335"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inv.lgaps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">coa</span>, <span class="va">leftInversionGaps</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/SimpleList-class.html" class="external-link">SimpleList</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">inv.lgaps</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">inv.lgaps</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,  <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">OKI2018.I69</span><span class="op">)</span></span>
<span><span class="va">inv.lgaps</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">inv.lgaps</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">OSKA2016v1.9</span><span class="op">)</span></span>
<span><span class="va">inv.lgaps</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">inv.lgaps</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Bar2.p4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">inv.lgaps</span>, <span class="va">length</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Oki_Osa Oki_Bar Oki_Kum Oki_Aom Oki_Nor Osa_Oki Osa_Bar Osa_Kum Osa_Aom Osa_Nor Bar_Oki Bar_Osa Bar_Kum Bar_Aom Bar_Nor Ply_Ros Ply_Rob Ply_Sav Ply_Oki Rob_Ros Rob_Ply Rob_Sav Rob_Oki Dme_Dbu Dme_Dsu </span></span>
<span><span class="co">##     669     675      96     665     591     669     319     678      69     274     666     315     685     315      22      46      65      92       0      61      67      92       0    1003      44 </span></span>
<span><span class="co">## Dme_Dya Dme_Dma Cni_Cbr Cni_Cre Cni_Cin Cbr_Cni Cbr_Cre Cbr_Cel </span></span>
<span><span class="co">##      21      14     294     212     132     310     200     166</span></span></code></pre>
<div class="sourceCode" id="cb337"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">widths</span><span class="op">$</span><span class="va">invs.lgaps</span> <span class="op">&lt;-</span> <span class="fu">makeWidthsDF</span><span class="op">(</span><span class="va">inv.lgaps</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">invs.lgaps</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">chr</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution widths of left gaps next to inverted regions, split by arm."</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_of_inversions_gaps-1.png" width="700"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Aleksandra Bliznina, Michael Mansfield, Charles Plessy.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
