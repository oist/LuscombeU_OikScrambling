<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Width of the aligned and mapped regions. • OikScrambling</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Width of the aligned and mapped regions.">
<meta property="og:description" content="OikScrambling">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">OikScrambling</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">4.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/OikScrambling.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/CNEs.html">Conserved non-coding elements</a>
    </li>
    <li>
      <a href="../articles/ChromosomePlots.html">Chromosome-scale feature density plots</a>
    </li>
    <li>
      <a href="../articles/CoalescingCutoffs.html">Modifying coalescent cutoffs</a>
    </li>
    <li>
      <a href="../articles/ColinearityInterruptors.html">Regions interrupting colinearity</a>
    </li>
    <li>
      <a href="../articles/DistanceMeasures.html">Distance Measures</a>
    </li>
    <li>
      <a href="../articles/GenomicFeatures.html">Genomic features of the breakpoints</a>
    </li>
    <li>
      <a href="../articles/Inversions.html">Inversions</a>
    </li>
    <li>
      <a href="../articles/LoadGenomicBreaks.html">Load genomic break data</a>
    </li>
    <li>
      <a href="../articles/OrthogroupSyntenies.html">Orthogroup syntenies</a>
    </li>
    <li>
      <a href="../articles/OxfordPlots.html">Whole-genome dot-plots</a>
    </li>
    <li>
      <a href="../articles/PAC3.html">Region of interest: PAC3</a>
    </li>
    <li>
      <a href="../articles/PWM.html">Motif search and analysis</a>
    </li>
    <li>
      <a href="../articles/ParallelPlots.html">Whole-chromosome parallel plots</a>
    </li>
    <li>
      <a href="../articles/RegionWidths.html">Width of the aligned and mapped regions.</a>
    </li>
    <li>
      <a href="../articles/RegionsOfInterest.html">Regions of interest</a>
    </li>
    <li>
      <a href="../articles/RepeatRegions.html">Repeat regions</a>
    </li>
    <li>
      <a href="../articles/SegmentMovements.html">Segment movement distances</a>
    </li>
    <li>
      <a href="../articles/TFBS.html">Transcription factor binding sites</a>
    </li>
    <li>
      <a href="../articles/TandemSiteDuplications.html">Tandem site duplications</a>
    </li>
    <li>
      <a href="../articles/Translocations.html">Translocations</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/oist/LuscombeU_OikScrambling/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="RegionWidths_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Width of the aligned and mapped regions.</h1>
                        <h4 data-toc-skip class="author">Charles Plessy</h4>
            
            <h4 data-toc-skip class="date">25 May, 2022</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/oist/LuscombeU_OikScrambling/blob/HEAD/vignettes/RegionWidths.Rmd" class="external-link"><code>vignettes/RegionWidths.Rmd</code></a></small>
      <div class="hidden name"><code>RegionWidths.Rmd</code></div>

    </div>

    
    
<style type="text/css">
pre, code {white-space:pre !important; overflow-x:auto}
</style>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html" class="external-link">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>cache <span class="op">=</span> <span class="cn">TRUE</span>, cache.lazy <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></code></pre></div>
<div class="section level2">
<h2 id="load-r-pacakges-and-data">Load R pacakges and data<a class="anchor" aria-label="anchor" href="#load-r-pacakges-and-data"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/oist/LuscombeU_OikScrambling" class="external-link">'OikScrambling'</a></span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">'ggplot2'</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">'patchwork'</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">genomes</span> <span class="op">&lt;-</span> <span class="fu">OikScrambling</span><span class="fu">:::</span><span class="fu"><a href="../reference/loadAllGenomes.html">loadAllGenomes</a></span><span class="op">(</span>compat <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"BreakPoints.Rdata"</span><span class="op">)</span>
<span class="va">ces</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"CEs.Rds"</span><span class="op">)</span></code></pre></div>
<p>See <code><a href="../articles/LoadGenomicBreaks.html">vignette("LoadGenomicBreaks", package = "OikScrambling")</a></code> for how the different GBreaks objects are prepared.</p>
</div>
<div class="section level2">
<h2 id="precompute-widths">Precompute widths<a class="anchor" aria-label="anchor" href="#precompute-widths"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">widths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/SimpleList-class.html" class="external-link">SimpleList</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">makeWidthsDF</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">objList</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">objList</span><span class="op">)</span>, \<span class="op">(</span><span class="va">name</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">DF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">mcols</a></span><span class="op">(</span><span class="va">objList</span><span class="op">[[</span><span class="va">name</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">DF</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/DataFrame-class.html" class="external-link">DataFrame</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">DF</span><span class="op">$</span><span class="va">Arm</span><span class="op">)</span>   <span class="op">)</span> <span class="va">DF</span><span class="op">$</span><span class="va">Arm</span>     <span class="op">&lt;-</span> <span class="cn">NA</span>
    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">DF</span><span class="op">$</span><span class="va">flag</span><span class="op">)</span><span class="op">)</span>   <span class="va">DF</span><span class="op">$</span><span class="va">flag</span>    <span class="op">&lt;-</span> <span class="cn">NA</span>
    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">DF</span><span class="op">$</span><span class="va">nonCoa</span><span class="op">)</span><span class="op">)</span> <span class="va">DF</span><span class="op">$</span><span class="va">nonCoa</span>  <span class="op">&lt;-</span> <span class="cn">NA</span>
    <span class="va">DF</span><span class="op">$</span><span class="va">name</span>  <span class="op">&lt;-</span> <span class="va">name</span>
    <span class="va">DF</span><span class="op">$</span><span class="va">width</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/IPosRanges-class.html" class="external-link">width</a></span><span class="op">(</span><span class="va">objList</span><span class="op">[[</span><span class="va">name</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
    <span class="va">DF</span><span class="op">$</span><span class="va">chr</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomeInfoDb/man/seqinfo.html" class="external-link">seqnames</a></span><span class="op">(</span><span class="va">objList</span><span class="op">[[</span><span class="va">name</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> |&gt;
      <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>pat <span class="op">=</span> <span class="st">"Chr"</span>,    rep <span class="op">=</span> <span class="st">"chr"</span><span class="op">)</span>    |&gt;
      <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>pat <span class="op">=</span> <span class="st">"BNJZ.*"</span>, rep <span class="op">=</span> <span class="st">"Ply"</span><span class="op">)</span>    |&gt;
      <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>pat <span class="op">=</span> <span class="st">"BNKA.*"</span>, rep <span class="op">=</span> <span class="st">"Ros"</span><span class="op">)</span>    |&gt;
      <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>pat <span class="op">=</span> <span class="st">"BJTB.*"</span>, rep <span class="op">=</span> <span class="st">"Rob"</span><span class="op">)</span>    |&gt;
      <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>pat <span class="op">=</span> <span class="st">"^R.*"</span>,   rep <span class="op">=</span> <span class="st">"Sav"</span><span class="op">)</span>    |&gt;
      <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>pat <span class="op">=</span> <span class="st">"^2L$"</span>,   rep <span class="op">=</span> <span class="st">"Dro"</span><span class="op">)</span>    |&gt;
      <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>pat <span class="op">=</span> <span class="st">"^2R$"</span>,   rep <span class="op">=</span> <span class="st">"Dro"</span><span class="op">)</span>    |&gt;
      <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>pat <span class="op">=</span> <span class="st">"^3L$"</span>,   rep <span class="op">=</span> <span class="st">"Dro"</span><span class="op">)</span>    |&gt;
      <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>pat <span class="op">=</span> <span class="st">"^3R$"</span>,   rep <span class="op">=</span> <span class="st">"Dro"</span><span class="op">)</span>    |&gt;
      <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>pat <span class="op">=</span> <span class="st">"^4$"</span>,    rep <span class="op">=</span> <span class="st">"Dro"</span><span class="op">)</span>    |&gt;
      <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>pat <span class="op">=</span> <span class="st">"^X$"</span>,    rep <span class="op">=</span> <span class="st">"Dro"</span><span class="op">)</span>    |&gt;
      <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>pat <span class="op">=</span> <span class="st">"^Y$"</span>,    rep <span class="op">=</span> <span class="st">"Dro"</span><span class="op">)</span>   

    <span class="va">DF</span><span class="op">$</span><span class="va">query</span> <span class="op">&lt;-</span> <span class="va">DF</span><span class="op">$</span><span class="va">score</span> <span class="op">&lt;-</span> <span class="va">DF</span><span class="op">$</span><span class="va">rep</span> <span class="op">&lt;-</span> <span class="va">DF</span><span class="op">$</span><span class="va">repOvlp</span> <span class="op">&lt;-</span> <span class="va">DF</span><span class="op">$</span><span class="va">transcripts</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
    <span class="va">DF</span><span class="op">$</span><span class="va">dist</span>  <span class="op">&lt;-</span> <span class="fu">OikScrambling</span><span class="fu">:::</span><span class="fu"><a href="../reference/compDistance.html">compDistance</a></span><span class="op">(</span><span class="va">DF</span><span class="op">$</span><span class="va">name</span><span class="op">)</span>
    <span class="va">DF</span><span class="op">$</span><span class="va">distS</span> <span class="op">&lt;-</span> <span class="fu">OikScrambling</span><span class="fu">:::</span><span class="fu"><a href="../reference/compDistance.html">compDistance</a></span><span class="op">(</span><span class="va">DF</span><span class="op">$</span><span class="va">name</span>, short <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
    <span class="va">DF</span><span class="op">$</span><span class="va">genus</span> <span class="op">&lt;-</span> <span class="fu">OikScrambling</span><span class="fu">:::</span><span class="fu"><a href="../reference/compGenus.html">compGenus</a></span><span class="op">(</span><span class="va">DF</span><span class="op">$</span><span class="va">name</span><span class="op">)</span>
    <span class="va">DF</span><span class="op">$</span><span class="va">class</span> <span class="op">&lt;-</span> <span class="fu">OikScrambling</span><span class="fu">:::</span><span class="fu"><a href="../reference/compDistClass.html">compDistClass</a></span><span class="op">(</span><span class="va">DF</span><span class="op">$</span><span class="va">name</span><span class="op">)</span>
    <span class="va">DF</span>
  <span class="op">}</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/do.call.html" class="external-link">do.call</a></span><span class="op">(</span>what<span class="op">=</span><span class="va">rbind</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">isol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">gbs</span>, \<span class="op">(</span><span class="va">gb</span><span class="op">)</span> <span class="va">gb</span><span class="op">[</span><span class="va">gb</span><span class="op">$</span><span class="va">nonCoa</span><span class="op">]</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/SimpleList-class.html" class="external-link">SimpleList</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">widths</span><span class="op">$</span><span class="va">gbs</span>     <span class="op">&lt;-</span> <span class="fu">makeWidthsDF</span><span class="op">(</span><span class="va">gbs</span><span class="op">)</span>     |&gt; <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">widths</span><span class="op">$</span><span class="va">isol</span>    <span class="op">&lt;-</span> <span class="fu">makeWidthsDF</span><span class="op">(</span><span class="va">isol</span><span class="op">)</span>    |&gt; <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">widths</span><span class="op">$</span><span class="va">unal</span>    <span class="op">&lt;-</span> <span class="fu">makeWidthsDF</span><span class="op">(</span><span class="va">unal</span><span class="op">)</span>    |&gt; <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">widths</span><span class="op">$</span><span class="va">coa</span>     <span class="op">&lt;-</span> <span class="fu">makeWidthsDF</span><span class="op">(</span><span class="va">coa</span><span class="op">)</span>     |&gt; <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">widths</span><span class="op">$</span><span class="va">unmap</span>   <span class="op">&lt;-</span> <span class="fu">makeWidthsDF</span><span class="op">(</span><span class="va">unmap</span><span class="op">)</span>   |&gt; <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">widths</span><span class="op">$</span><span class="va">bri</span>     <span class="op">&lt;-</span> <span class="fu">makeWidthsDF</span><span class="op">(</span><span class="va">bri</span><span class="op">)</span>     |&gt; <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">widths</span><span class="op">$</span><span class="va">tra</span>     <span class="op">&lt;-</span> <span class="fu">makeWidthsDF</span><span class="op">(</span><span class="va">tra</span><span class="op">)</span>     |&gt; <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">widths</span><span class="op">$</span><span class="va">tra2</span>    <span class="op">&lt;-</span> <span class="fu">makeWidthsDF</span><span class="op">(</span><span class="va">tra2</span><span class="op">)</span>    |&gt; <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">widths</span><span class="op">$</span><span class="va">coa2</span>    <span class="op">&lt;-</span> <span class="fu">makeWidthsDF</span><span class="op">(</span><span class="va">coa2</span><span class="op">)</span>    |&gt; <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">names_table</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>
  pairnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Factor-class.html" class="external-link">levels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">gbs</span><span class="op">$</span><span class="va">name</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
  class     <span class="op">=</span> <span class="fu">OikScrambling</span><span class="fu">:::</span><span class="fu"><a href="../reference/compDistClass.html">compDistClass</a></span><span class="op">(</span><span class="va">pairnames</span><span class="op">)</span>,
  distS     <span class="op">=</span> <span class="fu">OikScrambling</span><span class="fu">:::</span><span class="fu"><a href="../reference/compDistance.html">compDistance</a></span><span class="op">(</span><span class="va">pairnames</span>, short <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
  target    <span class="op">=</span> <span class="va">pairnames</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>pat<span class="op">=</span><span class="st">"_.*"</span>, rep<span class="op">=</span><span class="st">""</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="op">)</span>,
  query     <span class="op">=</span> <span class="va">pairnames</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>pat<span class="op">=</span><span class="st">".*_"</span>, rep<span class="op">=</span><span class="st">""</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plot-all-width-distributions">Plot all width distributions<a class="anchor" aria-label="anchor" href="#plot-all-width-distributions"></a>
</h2>
<p>This is useful to verify by eye that collections of distributions in the same distance group resemble each other.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gg_freq_poly</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">tibble</span>, <span class="va">bins</span> <span class="op">=</span> <span class="fl">30</span>, <span class="va">binwidth</span> <span class="op">=</span> <span class="fl">30</span>, <span class="va">scale</span> <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">p</span> <span class="op">&lt;-</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tibble</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span><span class="op">)</span>
  <span class="kw">if</span><span class="op">(</span><span class="va">scale</span> <span class="op">==</span> <span class="st">"log"</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> 
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_freqpoly</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="va">bins</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span>
  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
    <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_freqpoly</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="va">binwidth</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="va">p</span>
<span class="op">}</span>

<span class="va">w_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">gbs</span>     |&gt; <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span>|&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>what <span class="op">=</span> <span class="st">"aligned"</span><span class="op">)</span>,
              <span class="va">widths</span><span class="op">$</span><span class="va">isol</span>    |&gt; <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span>|&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>what <span class="op">=</span> <span class="st">"isolated"</span><span class="op">)</span>,
              <span class="va">widths</span><span class="op">$</span><span class="va">unal</span>    |&gt; <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span>|&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>what <span class="op">=</span> <span class="st">"unaligned"</span><span class="op">)</span>,
              <span class="va">widths</span><span class="op">$</span><span class="va">coa</span>     |&gt; <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span>|&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>what <span class="op">=</span> <span class="st">"mapped"</span><span class="op">)</span>,
              <span class="va">widths</span><span class="op">$</span><span class="va">bri</span>     |&gt; <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span>|&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>what <span class="op">=</span> <span class="st">"bridge"</span><span class="op">)</span>,
              <span class="va">widths</span><span class="op">$</span><span class="va">unmap</span>   |&gt; <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span>|&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>what <span class="op">=</span> <span class="st">"unmaped"</span><span class="op">)</span>,
              <span class="va">widths</span><span class="op">$</span><span class="va">coa2</span>    |&gt; <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span>|&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>what <span class="op">=</span> <span class="st">"doublecoalesced"</span><span class="op">)</span><span class="op">)</span>


<span class="va">widths_all_tibble</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">gbs</span>     |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>what <span class="op">=</span> <span class="st">"aligned"</span><span class="op">)</span>,
                           <span class="va">widths</span><span class="op">$</span><span class="va">isol</span>    |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>what <span class="op">=</span> <span class="st">"isolated"</span><span class="op">)</span>,
                           <span class="va">widths</span><span class="op">$</span><span class="va">unal</span>    |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>what <span class="op">=</span> <span class="st">"unaligned"</span><span class="op">)</span>,
                           <span class="va">widths</span><span class="op">$</span><span class="va">coa</span>     |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>what <span class="op">=</span> <span class="st">"mapped"</span><span class="op">)</span>,
                           <span class="va">widths</span><span class="op">$</span><span class="va">bri</span>     |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>what <span class="op">=</span> <span class="st">"bridge"</span><span class="op">)</span>,
                           <span class="va">widths</span><span class="op">$</span><span class="va">unmap</span>   |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>what <span class="op">=</span> <span class="st">"unmaped"</span><span class="op">)</span>,
                           <span class="va">widths</span><span class="op">$</span><span class="va">coa2</span>    |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>what <span class="op">=</span> <span class="st">"doublecoalesced"</span><span class="op">)</span><span class="op">)</span>

<span class="va">p</span> <span class="op">&lt;-</span><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths_all_tibble</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">what</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of alignment width before and after collapsing"</span><span class="op">)</span>

<span class="co"># Showing all individual distributions, to demonstrate we can pool some.</span>
<span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">class</span> <span class="op">+</span> <span class="va">genus</span> <span class="op">+</span> <span class="va">distS</span> <span class="op">+</span> <span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></code></pre>
<pre><code><span class="co">## Warning: Removed 18784 rows containing non-finite values (stat_bin).</span></code></pre>
<p><img src="RegionWidths_files/figure-html/width_after_processing_steps-1.png" width="1152"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Aggregating by distance class</span>
<span class="va">p_droso</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths_all_tibble</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">genus</span> <span class="op">==</span> <span class="st">"Drosophila"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">what</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">genus</span> <span class="op">+</span> <span class="va">class</span>, nrow <span class="op">=</span> <span class="fl">1</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span>
<span class="va">p_ciona</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths_all_tibble</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">genus</span> <span class="op">==</span> <span class="st">"Ciona"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">what</span><span class="op">)</span>      <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">genus</span> <span class="op">+</span> <span class="va">class</span>, nrow <span class="op">=</span> <span class="fl">1</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span>
<span class="va">p_oikop</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths_all_tibble</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">genus</span> <span class="op">==</span> <span class="st">"Oikopleura"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">what</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">genus</span> <span class="op">+</span> <span class="va">class</span>, nrow <span class="op">=</span> <span class="fl">1</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span>

<span class="va">layout</span> <span class="op">&lt;-</span> <span class="st">"
AAAA
BBB#
CCC#
"</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://patchwork.data-imaginist.com" class="external-link">"patchwork"</a></span><span class="op">)</span>
<span class="op">(</span><span class="va">p_droso</span> <span class="op">/</span> <span class="va">p_ciona</span> <span class="op">/</span> <span class="va">p_oikop</span><span class="op">)</span> <span class="op">+</span>   <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">layout</span>, guides <span class="op">=</span> <span class="st">'collect'</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></code></pre>
<pre><code><span class="co">## Warning: Removed 914 rows containing non-finite values (stat_bin).</span></code></pre>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></code></pre>
<pre><code><span class="co">## Warning: Removed 10307 rows containing non-finite values (stat_bin).</span></code></pre>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></code></pre>
<pre><code><span class="co">## Warning: Removed 7561 rows containing non-finite values (stat_bin).</span></code></pre>
<p><img src="RegionWidths_files/figure-html/width_after_processing_steps_by_class_and_genus-1.png" width="1152"></p>
</div>
<div class="section level2">
<h2 id="saving-width-distributions-and-some-statistics">Saving width distributions and some statistics<a class="anchor" aria-label="anchor" href="#saving-width-distributions-and-some-statistics"></a>
</h2>
<p>Below, I take the <code>widths_all_tibble</code> and perform some statistical operations on it for later. Click below to view.</p>
<div class="section level3">
<h3 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a>
</h3>
<details><p><summary> Click here to view the full table with many summary statistics for width distributions.</summary></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">t_CI</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">vector</span>, <span class="va">conf.level</span><span class="op">)</span><span class="op">{</span>
  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">vector</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">3</span><span class="op">)</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="cn">NA_character_</span><span class="op">)</span>
  <span class="va">conf_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">vector</span>, conf.level <span class="op">=</span> <span class="va">conf.level</span><span class="op">)</span>
  <span class="va">conf_str</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">conf_test</span><span class="op">$</span><span class="va">conf.int</span>,<span class="fl">2</span><span class="op">)</span>, collapse<span class="op">=</span><span class="st">','</span><span class="op">)</span>
  <span class="va">conf_str</span>
<span class="op">}</span>

<span class="co"># Note that because the Wilcox test involves ranking (and therefore sorting),</span>
<span class="co"># this test is computationally demanding for large data frames.</span>
<span class="co"># It works the same as the function above - just slower.</span>
<span class="va">wilcox_CI</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">vector</span>, <span class="va">conf.level</span><span class="op">)</span><span class="op">{</span>
  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">vector</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">3</span><span class="op">)</span>
     <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="cn">NA_character_</span><span class="op">)</span>
  <span class="va">conf_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test</a></span><span class="op">(</span><span class="va">vector</span>, conf.level <span class="op">=</span> <span class="va">conf.level</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
  <span class="va">conf_str</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">conf_test</span><span class="op">$</span><span class="va">conf.int</span>, <span class="fl">2</span><span class="op">)</span>, collapse<span class="op">=</span><span class="st">','</span><span class="op">)</span>
  <span class="va">conf_str</span>
<span class="op">}</span>

<span class="va">stats_to_compute</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n         <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,
                         t_CI      <span class="op">=</span> <span class="op">~</span><span class="fu">t_CI</span><span class="op">(</span><span class="va">.</span>, conf.level<span class="op">=</span><span class="fl">0.95</span><span class="op">)</span>,
                         wilcox_CI <span class="op">=</span> <span class="op">~</span><span class="fu">wilcox_CI</span><span class="op">(</span><span class="va">.</span>, conf.level<span class="op">=</span><span class="fl">0.95</span><span class="op">)</span>,
                         min       <span class="op">=</span> <span class="va">min</span>,
                         q25       <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">.</span>, <span class="fl">0.25</span><span class="op">)</span>,
                         median    <span class="op">=</span> <span class="va">median</span>,
                         q75       <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">.</span>, <span class="fl">0.75</span><span class="op">)</span>,
                         max       <span class="op">=</span> <span class="va">max</span>,
                         mean      <span class="op">=</span> <span class="va">mean</span>,
                         sd        <span class="op">=</span> <span class="va">sd</span><span class="op">)</span>

<span class="va">old.o</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>max.print <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span>

<span class="va">widths_all_tibble</span> |&gt;
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">class</span>, <span class="va">what</span><span class="op">)</span> |&gt;
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="va">width</span>, <span class="va">stats_to_compute</span><span class="op">)</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## `summarise()` has grouped output by 'name', 'class'. You can override using the `.groups` argument.</span></code></pre>
<pre><code><span class="co">##        name           class            what width_n          width_t_CI width_wilcox_CI width_min width_q25 width_median width_q75 width_max  width_mean    width_sd</span>
<span class="co">## 1   Bar_Aom    intermediate         aligned   24717     1538.64,1610.24       844,872.5        51    368.00        634.0   1447.00     54452   1574.4417   2871.3143</span>
<span class="co">## 2   Bar_Aom    intermediate          bridge   20520        302.15,327.1         191,197         0     38.00        178.0    309.00     38380    314.6256    911.6882</span>
<span class="co">## 3   Bar_Aom    intermediate doublecoalesced    3452    11606.52,14764.2       3836,4392        58    562.75       2251.5   8361.50   1199960  13185.3589  47312.1501</span>
<span class="co">## 4   Bar_Aom    intermediate        isolated    1853      862.03,1000.66       559.5,621        58    271.00        481.0    960.00     19742    931.3475   1521.3645</span>
<span class="co">## 5   Bar_Aom    intermediate          mapped    4197    9887.49,11733.47   3636.5,4119.5        58    547.00       2104.0   7894.00    677793  10810.4818  30499.4833</span>
<span class="co">## 6   Bar_Aom    intermediate       unaligned   24170       611.96,681.74       210.5,217         1     48.00        194.0    351.00     79613    646.8544   2767.3868</span>
<span class="co">## 7   Bar_Aom    intermediate         unmaped    4129     2035.51,2410.29       526.5,629         1     82.00        272.0   1330.00     79613   2222.9002   6141.9161</span>
<span class="co">## 8   Bar_Kum         distant         aligned   31557       957.75,991.34         617,635        51    250.00        469.0   1052.00     43546    974.5433   1522.0555</span>
<span class="co">## 9   Bar_Kum         distant          bridge   23028       408.46,440.56     289.5,296.5         0    144.00        258.0    441.00    135099    424.5125   1242.4483</span>
<span class="co">## 10  Bar_Kum         distant doublecoalesced    7849     4903.46,5419.47   2151.5,2342.5        51    316.00       1354.0   4436.00    216498   5161.4630  11660.5964</span>
<span class="co">## 11  Bar_Kum         distant        isolated    4346       653.68,717.84       408,449.5        51    177.00        302.0    764.75     16862    685.7561   1078.6911</span>
<span class="co">## 12  Bar_Kum         distant          mapped    8529      4530.09,4973.8   2005.5,2181.5        51    296.00       1227.0   4188.00    138044   4751.9448  10452.2655</span>
<span class="co">## 13  Bar_Kum         distant       unaligned   31373        704.7,796.64         323,331         1    147.00        273.0    521.00    273024    750.6715   4154.0813</span>
<span class="co">## 14  Bar_Kum         distant         unmaped    8515     1455.44,1780.07         502,540         1    144.00        351.0    975.00    273024   1617.7504   7640.8206</span>
<span class="co">## 15  Bar_Nor  same_or_sister         aligned   15184     2880.98,3022.93   1814.5,1908.5        40    526.00       1305.5   3380.25     55611   2951.9559   4462.0282</span>
<span class="co">## 16  Bar_Nor  same_or_sister          bridge    8996        378.79,417.1         274,297         0      2.00        124.0    406.00     17680    397.9464    926.7815</span>
<span class="co">## 17  Bar_Nor  same_or_sister doublecoalesced    4319    10271.06,12273.5       2512,2848        40    529.00       1517.0   5440.00    569531  11272.2790  33562.3130</span>
<span class="co">## 18  Bar_Nor  same_or_sister        isolated    3882     1262.66,1415.56         780,845        40    312.00        633.0   1366.50     44180   1339.1121   2429.5923</span>
<span class="co">## 19  Bar_Nor  same_or_sister          mapped    6188     7355.49,8288.48     2419,2720.5        40    488.00       1373.5   5444.75    240933   7821.9819  18719.2179</span>
<span class="co">## 20  Bar_Nor  same_or_sister       unaligned   12425       755.51,822.08       359.5,383         1     24.00        225.0    734.00     56097    788.7979   1892.7856</span>
<span class="co">## 21  Bar_Nor  same_or_sister         unmaped    5214      1122.1,1264.13       557,629.5         1     16.00        325.0   1250.00     56097   1193.1124   2615.7709</span>
<span class="co">## 22  Bar_Oki         distant         aligned   32265       924.88,956.96     597.5,614.5        51    245.00        454.0   1014.00     43420    940.9199   1469.8924</span>
<span class="co">## 23  Bar_Oki         distant          bridge   23772       413.37,438.69     288.5,295.5         0    142.00        256.0    443.00     59129    426.0277    995.8294</span>
<span class="co">## 24  Bar_Oki         distant doublecoalesced    7849     4896.93,5417.11     2145.5,2338        54    306.00       1347.0   4450.00    218004   5157.0210  11754.6679</span>
<span class="co">## 25  Bar_Oki         distant        isolated    4321       645.66,714.44       390,427.5        54    172.00        296.0    714.00     21112    680.0470   1153.0032</span>
<span class="co">## 26  Bar_Oki         distant          mapped    8493     4540.11,4993.94     2005.5,2179        54    291.00       1218.0   4177.00    218004   4767.0211  10667.9952</span>
<span class="co">## 27  Bar_Oki         distant       unaligned   32076       703.97,795.69     322.5,330.5         1    146.00        272.0    520.00    269200    749.8278   4190.4617</span>
<span class="co">## 28  Bar_Oki         distant         unmaped    8484       1472.9,1809.5     503.5,539.5         1    148.00        358.0    968.00    269200   1641.2007   7908.2528</span>
<span class="co">## 29  Bar_Osa    intermediate         aligned   24851      1523.3,1593.59       844.5,873        52    367.00        634.0   1449.00     49546   1558.4455   2826.8737</span>
<span class="co">## 30  Bar_Osa    intermediate          bridge   20778        303.39,328.1     188.5,194.5         0     37.00        174.0    305.00     32212    315.7473    908.4853</span>
<span class="co">## 31  Bar_Osa    intermediate doublecoalesced    3373   12040.47,14823.71     3990.5,4583        59    585.00       2310.0   8781.00    714822  13432.0910  41221.5092</span>
<span class="co">## 32  Bar_Osa    intermediate        isolated    1732       814.98,929.84         571,634        59    279.75        478.0    968.25     16143    872.4094   1218.6145</span>
<span class="co">## 33  Bar_Osa    intermediate          mapped    4073   10180.46,12058.44       3738,4238        59    572.00       2153.0   8140.00    562164  11119.4513  30566.1990</span>
<span class="co">## 34  Bar_Osa    intermediate       unaligned   24266       616.12,690.07       208,214.5         1     47.00        189.0    346.00    106962    653.0948   2938.6433</span>
<span class="co">## 35  Bar_Osa    intermediate         unmaped    4008     2110.15,2524.29       516.5,607         1     83.00        277.0   1249.50    106962   2317.2161   6686.5554</span>
<span class="co">## 36  Dme_Dbu         distant         aligned   47893        610.2,623.09       463.5,472        48    205.00        397.0    731.00     16014    616.6455    719.1531</span>
<span class="co">## 37  Dme_Dbu         distant          bridge   41934     1570.08,1628.57    999.5,1023.5         0    395.00        783.0   1684.00    174913   1599.3246   3055.7262</span>
<span class="co">## 38  Dme_Dbu         distant doublecoalesced    5877    15727.3,17388.08     7514,8553.5        54    716.00       3233.0  17797.00    615658  16557.6888  32472.8670</span>
<span class="co">## 39  Dme_Dbu         distant        isolated    2086       638.88,695.17         519,565        54    245.00        462.0    849.75      5460    667.0240    655.5648</span>
<span class="co">## 40  Dme_Dbu         distant          mapped    5959   15413.96,17007.28     7325.5,8328        54    701.00       3134.0  17379.50    532037  16210.6196  31370.6132</span>
<span class="co">## 41  Dme_Dbu         distant       unaligned   47867     2115.49,2325.33     1100,1125.5         1    424.00        853.0   1868.00   1031382   2220.4080  11711.7224</span>
<span class="co">## 42  Dme_Dbu         distant         unmaped    5951     5780.24,7400.13     2069.5,2221         1    772.50       1602.0   3679.50   1031382   6590.1850  31872.2350</span>
<span class="co">## 43  Dme_Dma  same_or_sister         aligned    9732   10954.29,11804.24       5294,5971        49    404.00       1953.0  13037.50    291858  11379.2660  21387.8094</span>
<span class="co">## 44  Dme_Dma  same_or_sister          bridge    7026      884.17,1011.76       270.5,296         0     25.00        183.0    479.00     67561    947.9668   2727.8052</span>
<span class="co">## 45  Dme_Dma  same_or_sister doublecoalesced    2272   29884.44,73666.11         623,729        56    240.00        458.5   1274.25  15422642  51775.2720 532092.2108</span>
<span class="co">## 46  Dme_Dma  same_or_sister        isolated    2008        492.3,638.59       369,398.5        56    199.00        333.5    574.25     60697    565.4417   1671.3122</span>
<span class="co">## 47  Dme_Dma  same_or_sister          mapped    2706   32527.05,54245.63       667,793.5        56    237.25        465.0   1472.75   8110313  43386.3385 288086.3839</span>
<span class="co">## 48  Dme_Dma  same_or_sister       unaligned    9138     2583.15,3115.67       521.5,592         1     71.00        276.0   1299.00    545408   2849.4082  12984.5839</span>
<span class="co">## 49  Dme_Dma  same_or_sister         unmaped    2616     6516.25,8298.34     2456,2975.5         1    266.75       1311.0   5929.50    545408   7407.2924  23241.7218</span>
<span class="co">## 50  Dme_Dsu    intermediate         aligned   68750        1168.64,1187     931.5,942.5        50    553.00        843.0   1333.00     33370   1177.8198   1227.9791</span>
<span class="co">## 51  Dme_Dsu    intermediate          bridge   67758       327.89,343.23     221.5,223.5         0    148.00        207.0    298.00     76314    335.5584   1018.9091</span>
<span class="co">## 52  Dme_Dsu    intermediate doublecoalesced     878 103687.77,132644.64   45163.5,67214        77    665.75       7701.0 134819.75   1457965 118166.2050 218585.3124</span>
<span class="co">## 53  Dme_Dsu    intermediate        isolated     379       639.68,784.97       522.5,637        77    264.50        498.0    895.50      7094    712.3245    719.2297</span>
<span class="co">## 54  Dme_Dsu    intermediate          mapped     992  92498.83,116597.69   39379,60320.5        77    661.50       7251.5 122432.00   1338161 104548.2621 193394.2339</span>
<span class="co">## 55  Dme_Dsu    intermediate       unaligned   68626       665.01,916.59     223.5,225.5         1    149.00        209.0    303.00   2615430    790.8018  16812.8419</span>
<span class="co">## 56  Dme_Dsu    intermediate         unmaped     984   23497.61,40593.44     1173,1914.5         1    313.75        693.5   4526.00   2615430  32045.5264 136638.9172</span>
<span class="co">## 57  Dme_Dya           close         aligned   23059     4475.07,4642.76     3052,3167.5        60    919.00       2264.0   5468.00     92398   4558.9142   6495.6166</span>
<span class="co">## 58  Dme_Dya           close          bridge   21243        480.45,527.1         213,218         0    123.00        191.0    309.00     75233    503.7723   1734.2930</span>
<span class="co">## 59  Dme_Dya           close doublecoalesced    1582   56273.14,90367.16      764.5,1000        63    243.25        500.0   1919.25   6070020  73320.1492 345677.1415</span>
<span class="co">## 60  Dme_Dya           close        isolated    1314       536.32,649.82       390.5,436        63    203.00        335.0    646.00     25871    593.0723   1048.5917</span>
<span class="co">## 61  Dme_Dya           close          mapped    1816    51540.18,76021.1    913.5,1292.5        63    247.75        531.0   2852.50   4893795  63780.6382 265960.8921</span>
<span class="co">## 62  Dme_Dya           close       unaligned   22743     1251.61,1518.29       232,238.5         1    129.00        202.0    360.00    859148   1384.9524  10259.1500</span>
<span class="co">## 63  Dme_Dya           close         unmaped    1776   10099.58,13319.72       4087,5246         1    407.50       2005.5  10593.00    859148  11709.6492  34595.6295</span>
<span class="co">## 64  Oki_Aom         distant         aligned   32398      970.18,1004.75         599,616        55    257.25        459.0   1014.00     38135    987.4651   1587.6967</span>
<span class="co">## 65  Oki_Aom         distant          bridge   23534       556.31,599.03       329.5,340         0     91.00        278.0    548.00     81689    577.6661   1671.8453</span>
<span class="co">## 66  Oki_Aom         distant doublecoalesced    8176     5354.77,5893.45     2325,2534.5        64    324.75       1434.0   4868.50    216565   5624.1087  12423.8043</span>
<span class="co">## 67  Oki_Aom         distant        isolated    4586         723.3,801.8       432.5,474        55    184.00        322.0    803.75     23204    762.5497   1355.7858</span>
<span class="co">## 68  Oki_Aom         distant          mapped    8864     4909.98,5375.83     2150.5,2340        55    310.75       1291.5   4535.00    216565   5142.9025  11187.1566</span>
<span class="co">## 69  Oki_Aom         distant       unaligned   32175      925.18,1015.58         400,413         1    129.00        313.0    710.00    189661    970.3809   4136.8088</span>
<span class="co">## 70  Oki_Aom         distant         unmaped    8848     1839.99,2144.46     786.5,848.5         1    176.00        497.0   1577.50    189661   1992.2255   7305.3661</span>
<span class="co">## 71  Oki_Bar         distant         aligned   30841     1005.87,1041.09       652,671.5        51    261.00        494.0   1118.00     43759   1023.4778   1577.7563</span>
<span class="co">## 72  Oki_Bar         distant          bridge   22308        589.8,629.34       359.5,370         0    165.00        302.0    583.00     51342    609.5723   1506.3415</span>
<span class="co">## 73  Oki_Bar         distant doublecoalesced    7876     5494.42,6064.46   2353.5,2569.5        54    316.00       1438.0   4926.75    216563   5779.4397  12903.7318</span>
<span class="co">## 74  Oki_Bar         distant        isolated    4435       691.58,762.42       423,463.5        54    184.50        316.0    775.00     21231    726.9998   1203.0890</span>
<span class="co">## 75  Oki_Bar         distant          mapped    8533     5044.56,5541.03       2182,2374        54    302.00       1312.0   4580.00    168062   5292.7949  11697.6288</span>
<span class="co">## 76  Oki_Bar         distant       unaligned   30684      969.67,1068.66       426,439.5         1    172.00        333.0    744.00    283076   1019.1656   4423.5389</span>
<span class="co">## 77  Oki_Bar         distant         unmaped    8515     1906.94,2244.26       780,845.5         1    182.00        503.0   1572.50    283076   2075.6006   7939.4455</span>
<span class="co">## 78  Oki_Kum  same_or_sister         aligned   15086        3444.82,3615     2263.5,2378        44    601.00       1598.0   4234.00     72046   3529.9073   5331.9172</span>
<span class="co">## 79  Oki_Kum  same_or_sister          bridge    9662       554.25,637.24       311.5,332         0      7.00        180.0    497.00     49765    595.7452   2080.8174</span>
<span class="co">## 80  Oki_Kum  same_or_sister doublecoalesced    1625   32119.88,41848.39  8992.5,12752.5        48    427.00       2193.0  27502.00   1365817  36984.1342  99970.3102</span>
<span class="co">## 81  Oki_Kum  same_or_sister        isolated    2993     1640.94,1904.58       726.5,808        44    321.00        597.0   1305.00     58461   1772.7618   3677.9126</span>
<span class="co">## 82  Oki_Kum  same_or_sister          mapped    5424   10370.48,11387.73     5736,6459.5        44    542.75       2506.0  12995.25    262072  10879.1062  19107.8473</span>
<span class="co">## 83  Oki_Kum  same_or_sister       unaligned   12386        790.2,882.38         309,329         1     25.00        211.0    614.00     53783    836.2917   2616.6886</span>
<span class="co">## 84  Oki_Kum  same_or_sister         unmaped    4119      1018.53,1216.1     305.5,364.5         1      8.00        121.0    794.00     53783   1117.3146   3233.7276</span>
<span class="co">## 85  Oki_Nor         distant         aligned   30055      974.05,1006.36     656.5,675.5        52    261.00        502.0   1122.00     43752    990.2015   1428.7816</span>
<span class="co">## 86  Oki_Nor         distant          bridge   21180       616.65,658.38     369.5,381.5         0    171.00        305.0    607.00     83492    637.5155   1549.4677</span>
<span class="co">## 87  Oki_Nor         distant doublecoalesced    8280     5027.56,5504.15   2359.5,2552.5        54    365.75       1530.0   4800.25    216563   5265.8556  11061.6823</span>
<span class="co">## 88  Oki_Nor         distant        isolated    4578       769.55,842.95         498,544        54    190.00        357.0    926.25     17200    806.2532   1266.6301</span>
<span class="co">## 89  Oki_Nor         distant          mapped    8875     4662.56,5086.86     2202.5,2381        54    340.50       1408.0   4490.50    216563   4874.7136  10195.7615</span>
<span class="co">## 90  Oki_Nor         distant       unaligned   29897     1065.36,1166.48     462.5,478.5         1    178.00        348.0    824.00    280268   1115.9183   4460.4825</span>
<span class="co">## 91  Oki_Nor         distant         unmaped    8854     2082.17,2403.95    951.5,1028.5         1    194.00        596.0   1929.75    280268   2243.0576   7723.0016</span>
<span class="co">## 92  Oki_Osa         distant         aligned   30852     1042.47,1080.36       642.5,662        56    273.00        487.0   1098.25     38135   1061.4169   1697.9866</span>
<span class="co">## 93  Oki_Osa         distant          bridge   22009       554.32,592.64     333.5,344.5         0     75.00        284.0    559.00     47969    573.4841   1450.1810</span>
<span class="co">## 94  Oki_Osa         distant doublecoalesced    8132     5358.65,5881.01   2385.5,2593.5        67    338.75       1489.0   4944.25    164824   5619.8308  12014.8889</span>
<span class="co">## 95  Oki_Osa         distant        isolated    4646        780.7,861.56       471.5,518        61    195.00        345.5    888.75     24353    821.1334   1405.6672</span>
<span class="co">## 96  Oki_Osa         distant          mapped    8843     4903.95,5356.97     2195,2380.5        61    324.00       1358.0   4561.00    164824   5130.4588  10866.2362</span>
<span class="co">## 97  Oki_Osa         distant       unaligned   30636      937.76,1034.33       403,416.5         1    114.00        318.0    722.00    211398    986.0471   4311.6897</span>
<span class="co">## 98  Oki_Osa         distant         unmaped    8821     1834.91,2152.56     757.5,819.5         1    167.00        475.0   1543.00    211398   1993.7338   7609.5710</span>
<span class="co">## 99  Osa_Aom  same_or_sister         aligned   15261     3005.27,3189.26       1625,1709        44    501.00       1142.0   3015.00    112674   3097.2689   5797.9303</span>
<span class="co">## 100 Osa_Aom  same_or_sister          bridge   10311       327.61,359.27       263,276.5         0     12.00        186.0    392.00     31147    343.4384    820.0688</span>
<span class="co">## 101 Osa_Aom  same_or_sister doublecoalesced    2256   18388.65,27235.22   3626.5,4766.5        46    467.75       1569.0  10310.00   2627520  22811.9331 107135.4024</span>
<span class="co">## 102 Osa_Aom  same_or_sister        isolated    2791     1152.21,1353.59         619,670        46    297.50        546.0   1015.50     37928   1252.9022   2712.9315</span>
<span class="co">## 103 Osa_Aom  same_or_sister          mapped    4950    9581.21,10947.52       3444,4108        46    487.25       1441.0   8766.75    394294  10264.3665  24517.1044</span>
<span class="co">## 104 Osa_Aom  same_or_sister       unaligned   13147       536.81,588.57       281.5,297         1     34.00        219.0    539.50     37950    562.6859   1513.9013</span>
<span class="co">## 105 Osa_Aom  same_or_sister         unmaped    4063       876.8,1021.52         375,431         1     10.00        200.0    868.00     37950    949.1605   2352.5788</span>
<span class="co">## 106 Osa_Bar    intermediate         aligned   24430     1555.18,1626.72     870.5,900.5        50    372.00        651.0   1500.00     49309   1590.9494   2852.6515</span>
<span class="co">## 107 Osa_Bar    intermediate          bridge   20349       374.78,396.54       276.5,283         0    121.00        257.0    400.00     34004    385.6573    791.8057</span>
<span class="co">## 108 Osa_Bar    intermediate doublecoalesced    3358   12551.79,15470.77     4230,4939.5        59    596.25       2474.0   9656.25    735649  14011.2802  43135.7029</span>
<span class="co">## 109 Osa_Bar    intermediate        isolated    1757       837.18,973.65       570.5,635        59    282.00        487.0    962.00     19831    905.4104   1458.2906</span>
<span class="co">## 110 Osa_Bar    intermediate          mapped    4081    10494.2,12399.52     3967,4547.5        59    588.00       2321.0   8849.00    541207  11446.8598  31041.5565</span>
<span class="co">## 111 Osa_Bar    intermediate       unaligned   24028          628,681.41       293,300.5         1    128.00        267.0    437.25     79670    654.7069   2111.8623</span>
<span class="co">## 112 Osa_Bar    intermediate         unmaped    4034     1811.51,2097.04         669,775         1    105.00        340.5   1561.00     79670   1954.2779   4625.0001</span>
<span class="co">## 113 Osa_Kum         distant         aligned   31182     1005.38,1041.72       619.5,638        56    265.00        470.0   1054.00     38424   1023.5524   1636.9241</span>
<span class="co">## 114 Osa_Kum         distant          bridge   22406       447.63,470.48       334,341.5         0    184.00        308.0    485.00     52870    459.0552    872.7113</span>
<span class="co">## 115 Osa_Kum         distant doublecoalesced    8083     4990.75,5474.86     2291.5,2489        56    332.00       1454.0   4732.50    197453   5232.8028  11101.7552</span>
<span class="co">## 116 Osa_Kum         distant        isolated    4526        731.3,805.67       450.5,494        56    190.00        331.0    836.75     24056    768.4861   1276.1406</span>
<span class="co">## 117 Osa_Kum         distant          mapped    8776     4598.02,5019.58     2133.5,2311        56    320.00       1349.5   4387.50    197453   4808.7968  10073.2296</span>
<span class="co">## 118 Osa_Kum         distant       unaligned   30980       702.92,761.14         366,375         1    174.00        321.0    577.25    171974    732.0299   2613.8709</span>
<span class="co">## 119 Osa_Kum         distant         unmaped    8755     1318.17,1512.83       566,611.5         1    139.00        381.0   1138.50    171974   1415.4991   4645.6815</span>
<span class="co">## 120 Osa_Nor    intermediate         aligned   24497     1506.63,1566.54         922,955        50    376.00        680.0   1612.00     45285   1536.5851   2392.0808</span>
<span class="co">## 121 Osa_Nor    intermediate          bridge   19270       412.45,434.51       289,296.5         0    122.00        264.0    416.75     22261    423.4802    780.8947</span>
<span class="co">## 122 Osa_Nor    intermediate doublecoalesced    4500    9521.42,10964.37     3965,4480.5        50    707.00       2473.0   8530.00    388962  10242.8958  24686.7688</span>
<span class="co">## 123 Osa_Nor    intermediate        isolated    2321     1036.98,1164.82       718.5,793        50    314.00        588.0   1243.00     21037   1100.8992   1570.4058</span>
<span class="co">## 124 Osa_Nor    intermediate          mapped    5227     8236.78,9288.45     3644,4072.5        50    671.50       2300.0   7719.50    345763   8762.6153  19392.2112</span>
<span class="co">## 125 Osa_Nor    intermediate       unaligned   24037       682.83,732.22         318,327         1    129.00        280.0    503.00     90708    707.5226   1953.4642</span>
<span class="co">## 126 Osa_Nor    intermediate         unmaped    5161     1611.15,1816.97     747.5,846.5         1    102.00        389.0   1690.00     90708   1714.0585   3771.2084</span>
<span class="co">## 127 Osa_Oki         distant         aligned   31322      998.92,1035.17         614,632        56    264.00        466.0   1045.00     38067   1017.0453   1636.6480</span>
<span class="co">## 128 Osa_Oki         distant          bridge   22486       443.74,466.17       332,339.5         0    180.00        306.0    482.00     52933    454.9548    857.8036</span>
<span class="co">## 129 Osa_Oki         distant doublecoalesced    8127     4945.52,5420.28     2278.5,2478        68    328.00       1428.0   4741.00    197453   5182.9032  10916.8876</span>
<span class="co">## 130 Osa_Oki         distant        isolated    4620        747.44,823.6     454.5,499.5        61    190.00        331.0    848.25     22604    785.5190   1320.1540</span>
<span class="co">## 131 Osa_Oki         distant          mapped    8836     4557.12,4968.92       2119,2298        61    313.00       1317.0   4389.25    197453   4763.0158   9873.6593</span>
<span class="co">## 132 Osa_Oki         distant       unaligned   31103        700.4,760.96       365,373.5         1    172.50        320.0    574.00    131977    730.6795   2724.9146</span>
<span class="co">## 133 Osa_Oki         distant         unmaped    8815     1316.03,1519.19       565,609.5         1    140.50        384.0   1120.00    131977   1417.6076   4865.2006</span>
<span class="co">## 134 Ply_Oki different_genus         aligned    2127       323.32,391.14       233,258.5        91    158.00        196.0    375.50     30669    357.2294    797.3819</span>
<span class="co">## 135 Ply_Oki different_genus          bridge     821     1656.48,2286.29     1019.5,1210         0    381.00        811.0   1886.00     81648   1971.3837   4596.8409</span>
<span class="co">## 136 Ply_Oki different_genus doublecoalesced    1304     1542.61,2104.86       648.5,765        91    193.00        489.0   1261.75     81983   1823.7324   5174.7058</span>
<span class="co">## 137 Ply_Oki different_genus        isolated     941       406.56,543.47     342.5,389.5        91    172.00        263.0    569.00     30669    475.0138   1070.0561</span>
<span class="co">## 138 Ply_Oki different_genus          mapped    1306     1540.37,2101.79       646.5,762        91    193.00        489.0   1254.00     81983   1821.0819   5171.0702</span>
<span class="co">## 139 Ply_Oki different_genus       unaligned    2112   54816.04,63130.34 34084.5,40805.5         1   1180.25      15740.5  79679.50   1318064  58973.1908  97419.3303</span>
<span class="co">## 140 Ply_Oki different_genus         unmaped    1292  89137.72,101160.85 71179.5,82074.5         3  22040.25      60884.0 133164.25   1318064  95149.2825 110144.6120</span>
<span class="co">## 141 Ply_Rob           close         aligned   56000      1595.82,1633.3     1127.5,1151        50    387.00        881.0   1920.25     71233   1614.5579   2262.6163</span>
<span class="co">## 142 Ply_Rob           close          bridge   51031       420.52,443.07       246.5,251         0     45.00        214.0    375.00     58679    431.7949   1300.0021</span>
<span class="co">## 143 Ply_Rob           close doublecoalesced    3152   32691.15,39854.43     3150.5,4217        53    495.00       1401.5  11693.00   1226353  36272.7919 102555.6949</span>
<span class="co">## 144 Ply_Rob           close        isolated    2691       779.36,849.31       606.5,656        51    268.00        534.0    996.50     14541    814.3363    925.3702</span>
<span class="co">## 145 Ply_Rob           close          mapped    4969   21143.06,24117.62     4100,5397.5        51    476.00       1512.0  14541.00    626768  22630.3417  53477.8367</span>
<span class="co">## 146 Ply_Rob           close       unaligned   53216       695.11,736.84     268.5,273.5         1     78.00        235.0    436.00    114410    715.9753   2456.2716</span>
<span class="co">## 147 Ply_Rob           close         unmaped    4668     3255.42,3628.54   1803.5,2016.5         1    192.75       1145.5   3833.50    114410   3441.9818   6501.6677</span>
<span class="co">## 148 Ply_Ros  same_or_sister         aligned   40659     2534.44,2612.26     1669.5,1716        43    498.00       1251.0   2974.00     97390   2573.3486   4003.2243</span>
<span class="co">## 149 Ply_Ros  same_or_sister          bridge   32958       364.42,391.57     231.5,237.5         0     30.00        195.5    340.00     97102    377.9965   1257.6133</span>
<span class="co">## 150 Ply_Ros  same_or_sister doublecoalesced    4224   25242.83,30881.69   1803.5,2091.5        50    491.00       1135.0   4150.50   1322492  28062.2607  93465.4230</span>
<span class="co">## 151 Ply_Ros  same_or_sister        isolated    4830     1135.75,1228.97       830.5,883        45    350.00        697.0   1381.00     35993   1182.3617   1652.3764</span>
<span class="co">## 152 Ply_Ros  same_or_sister          mapped    7701   14397.07,16011.39     3100,3677.5        45    532.00       1461.0   9053.00    443768  15204.2322  36134.0852</span>
<span class="co">## 153 Ply_Ros  same_or_sister       unaligned   36133       640.21,686.43         262,269         1     71.00        220.0    444.00    169778    663.3193   2240.8260</span>
<span class="co">##  [ reached 'max' / getOption("max.print") -- omitted 36 rows ]</span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">widths_all_tibble</span> |&gt;
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">what</span>, <span class="va">class</span>, <span class="va">genus</span><span class="op">)</span> |&gt;
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="va">width</span>, <span class="va">stats_to_compute</span><span class="op">)</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## `summarise()` has grouped output by 'what', 'class'. You can override using the `.groups` argument.</span></code></pre>
<pre><code><span class="co">##               what           class      genus width_n          width_t_CI width_wilcox_CI width_min width_q25 width_median width_q75 width_max  width_mean    width_sd</span>
<span class="co">## 1          aligned  same_or_sister Drosophila    9732   10954.29,11804.24       5294,5971        49    404.00       1953.0  13037.50    291858  11379.2660  21387.8094</span>
<span class="co">## 2          aligned  same_or_sister      Ciona   40659     2534.44,2612.26     1669.5,1716        43    498.00       1251.0   2974.00     97390   2573.3486   4003.2243</span>
<span class="co">## 3          aligned  same_or_sister Oikopleura   45531     3144.09,3240.23     1908,1965.5        40    536.00       1328.0   3549.50    112674   3192.1570   5233.1119</span>
<span class="co">## 4          aligned           close Drosophila   23059     4475.07,4642.76     3052,3167.5        60    919.00       2264.0   5468.00     92398   4558.9142   6495.6166</span>
<span class="co">## 5          aligned           close      Ciona  176589     1497.75,1517.72     1055,1067.5        47    366.00        823.0   1784.00     83419   1507.7380   2140.7792</span>
<span class="co">## 6          aligned    intermediate Drosophila   68750        1168.64,1187     931.5,942.5        50    553.00        843.0   1333.00     33370   1177.8198   1227.9791</span>
<span class="co">## 7          aligned    intermediate Oikopleura   98495     1547.95,1582.22     876.5,891.5        50    371.00        650.0   1497.50     54452   1565.0848   2743.5154</span>
<span class="co">## 8          aligned         distant Drosophila   47893        610.2,623.09       463.5,472        48    205.00        397.0    731.00     16014    616.6455    719.1531</span>
<span class="co">## 9          aligned         distant      Ciona  138664        243.89,247.2       179,179.5        60    137.00        170.0    221.00     25919    245.5469    314.0168</span>
<span class="co">## 10         aligned         distant Oikopleura  250472      995.75,1008.06       630,636.5        51    259.00        474.0   1065.00     43759   1001.9047   1572.4288</span>
<span class="co">## 11         aligned different_genus       &lt;NA&gt;    4474       320.97,361.86         227,243        78    156.00        193.0    356.75     30669    341.4119    697.5420</span>
<span class="co">## 12          bridge  same_or_sister Drosophila    7026      884.17,1011.76       270.5,296         0     25.00        183.0    479.00     67561    947.9668   2727.8052</span>
<span class="co">## 13          bridge  same_or_sister      Ciona   32958       364.42,391.57     231.5,237.5         0     30.00        195.5    340.00     97102    377.9965   1257.6133</span>
<span class="co">## 14          bridge  same_or_sister Oikopleura   28969       428.39,460.65     284.5,295.5         0      6.00        169.0    431.00     49765    444.5169   1400.7196</span>
<span class="co">## 15          bridge           close Drosophila   21243        480.45,527.1         213,218         0    123.00        191.0    309.00     75233    503.7723   1734.2930</span>
<span class="co">## 16          bridge           close      Ciona  162242       378.06,390.49       226.5,229         0     51.00        201.0    343.00     90560    384.2791   1277.3452</span>
<span class="co">## 17          bridge    intermediate Drosophila   67758       327.89,343.23     221.5,223.5         0    148.00        207.0    298.00     76314    335.5584   1018.9091</span>
<span class="co">## 18          bridge    intermediate Oikopleura   80917       352.82,364.58       236,239.5         0     58.00        222.0    369.00     38380    358.6999    853.0667</span>
<span class="co">## 19          bridge         distant Drosophila   41934     1570.08,1628.57    999.5,1023.5         0    395.00        783.0   1684.00    174913   1599.3246   3055.7262</span>
<span class="co">## 20          bridge         distant      Ciona  130475      1026.7,1052.15         599,607         0    293.00        465.0    979.00    175994   1039.4208   2345.1046</span>
<span class="co">## 21          bridge         distant Oikopleura  180723       512.66,524.69         329,332         0    146.00        286.0    511.00    135099    518.6746   1304.3395</span>
<span class="co">## 22          bridge different_genus       &lt;NA&gt;    1766     1652.73,2053.32        992,1121         0    372.00        775.0   1817.00     81648   1853.0238   4291.6322</span>
<span class="co">## 23 doublecoalesced  same_or_sister Drosophila    2272   29884.44,73666.11         623,729        56    240.00        458.5   1274.25  15422642  51775.2720 532092.2108</span>
<span class="co">## 24 doublecoalesced  same_or_sister      Ciona    4224   25242.83,30881.69   1803.5,2091.5        50    491.00       1135.0   4150.50   1322492  28062.2607  93465.4230</span>
<span class="co">## 25 doublecoalesced  same_or_sister Oikopleura    8200   17889.71,21195.14     3340,3847.5        40    496.75       1606.0   8502.50   2627520  19542.4283  76347.1262</span>
<span class="co">## 26 doublecoalesced           close Drosophila    1582   56273.14,90367.16      764.5,1000        63    243.25        500.0   1919.25   6070020  73320.1492 345677.1415</span>
<span class="co">## 27 doublecoalesced           close      Ciona    9517   32836.42,36892.14     3058,3590.5        52    466.00       1304.0  10497.00   1394106  34864.2812 100921.6066</span>
<span class="co">## 28 doublecoalesced    intermediate Drosophila     878 103687.77,132644.64   45163.5,67214        77    665.75       7701.0 134819.75   1457965 118166.2050 218585.3124</span>
<span class="co">## 29 doublecoalesced    intermediate Oikopleura   14683   11896.19,13162.07     4135,4423.5        50    612.00       2400.0   8719.50   1199960  12529.1297  39127.8040</span>
<span class="co">## 30 doublecoalesced         distant Drosophila    5877    15727.3,17388.08     7514,8553.5        54    716.00       3233.0  17797.00    615658  16557.6888  32472.8670</span>
<span class="co">## 31 doublecoalesced         distant      Ciona    8179    20048.5,21449.54 12801.5,13788.5        61   2215.00       8371.0  25468.50    526016  20749.0219  32319.1280</span>
<span class="co">## 32 doublecoalesced         distant Oikopleura   64372     5287.56,5469.02   2349.5,2420.5        51    327.00       1439.0   4730.00    218004   5378.2904  11744.8510</span>
<span class="co">## 33 doublecoalesced different_genus       &lt;NA&gt;    2704     1584.88,1965.09     654.5,733.5        78    189.00        469.5   1252.00     81983   1774.9852   5041.5504</span>
<span class="co">## 34        isolated  same_or_sister Drosophila    2008        492.3,638.59       369,398.5        56    199.00        333.5    574.25     60697    565.4417   1671.3122</span>
<span class="co">## 35        isolated  same_or_sister      Ciona    4830     1135.75,1228.97       830.5,883        45    350.00        697.0   1381.00     35993   1182.3617   1652.3764</span>
<span class="co">## 36        isolated  same_or_sister Oikopleura    9666     1389.58,1507.41       725,763.5        40    312.00        594.0   1239.50     58461   1448.4957   2954.8151</span>
<span class="co">## 37        isolated           close Drosophila    1314       536.32,649.82       390.5,436        63    203.00        335.0    646.00     25871    593.0723   1048.5917</span>
<span class="co">## 38        isolated           close      Ciona    7994       789.28,830.11     601.5,630.5        50    259.00        512.0    967.75     14541    809.6955    931.1006</span>
<span class="co">## 39        isolated    intermediate Drosophila     379       639.68,784.97       522.5,637        77    264.50        498.0    895.50      7094    712.3245    719.2297</span>
<span class="co">## 40        isolated    intermediate Oikopleura    7663       930.69,996.17       625,658.5        50    289.00        511.0   1041.00     21037    963.4338   1462.0853</span>
<span class="co">## 41        isolated         distant Drosophila    2086       638.88,695.17         519,565        54    245.00        462.0    849.75      5460    667.0240    655.5648</span>
<span class="co">## 42        isolated         distant      Ciona    1386       582.66,684.67         400,451        61    173.00        275.5    708.25     12900    633.6652    967.9353</span>
<span class="co">## 43        isolated         distant Oikopleura   36058       742.77,768.87     454.5,469.5        51    185.00        324.0    822.00     24353    755.8199   1264.6923</span>
<span class="co">## 44        isolated different_genus       &lt;NA&gt;    1933       402.17,472.71       330.5,361        78    169.00        251.0    550.00     30669    437.4397    790.7655</span>
<span class="co">## 45          mapped  same_or_sister Drosophila    2706   32527.05,54245.63       667,793.5        56    237.25        465.0   1472.75   8110313  43386.3385 288086.3839</span>
<span class="co">## 46          mapped  same_or_sister      Ciona    7701   14397.07,16011.39     3100,3677.5        45    532.00       1461.0   9053.00    443768  15204.2322  36134.0852</span>
<span class="co">## 47          mapped  same_or_sister Oikopleura   16562      9236.61,9869.7     3755.5,4081        40    502.00       1591.0   8854.25    394294   9553.1524  20783.1448</span>
<span class="co">## 48          mapped           close Drosophila    1816    51540.18,76021.1    913.5,1292.5        63    247.75        531.0   2852.50   4893795  63780.6382 265960.8921</span>
<span class="co">## 49          mapped           close      Ciona   14347   21986.59,23820.35       3930,4585        50    446.00       1392.0  13495.50    730624  22903.4749  56028.4109</span>
<span class="co">## 50          mapped    intermediate Drosophila     992  92498.83,116597.69   39379,60320.5        77    661.50       7251.5 122432.00   1338161 104548.2621 193394.2339</span>
<span class="co">## 51          mapped    intermediate Oikopleura   17578   10009.24,10832.49       3847,4098        50    595.00       2231.5   8118.75    677793  10420.8637  27842.3288</span>
<span class="co">## 52          mapped         distant Drosophila    5959   15413.96,17007.28     7325.5,8328        54    701.00       3134.0  17379.50    532037  16210.6196  31370.6132</span>
<span class="co">## 53          mapped         distant      Ciona    8189   20019.71,21418.06 12785.5,13770.5        61   2203.00       8358.0  25455.00    526016  20718.8846  32276.7284</span>
<span class="co">## 54          mapped         distant Oikopleura   69749     4862.84,5020.76   2181.5,2245.5        51    311.00       1311.0   4411.00    218004   4941.7983  10639.7762</span>
<span class="co">## 55          mapped different_genus       &lt;NA&gt;    2708     1582.66,1962.34         653,731        78    189.00        469.5   1243.00     81983   1772.4952   5038.1306</span>
<span class="co">## 56       unaligned  same_or_sister Drosophila    9138     2583.15,3115.67       521.5,592         1     71.00        276.0   1299.00    545408   2849.4082  12984.5839</span>
<span class="co">## 57       unaligned  same_or_sister      Ciona   36133       640.21,686.43         262,269         1     71.00        220.0    444.00    169778    663.3193   2240.8260</span>
<span class="co">## 58       unaligned  same_or_sister Oikopleura   37958       705.33,746.63       316.5,328         1     27.00        220.5    622.75     56097    725.9802   2053.0616</span>
<span class="co">## 59       unaligned           close Drosophila   22743     1251.61,1518.29       232,238.5         1    129.00        202.0    360.00    859148   1384.9524  10259.1500</span>
<span class="co">## 60       unaligned           close      Ciona  168424       592.73,619.35       239.5,242         1     75.00        212.0    382.00    222284    606.0407   2786.3012</span>
<span class="co">## 61       unaligned    intermediate Drosophila   68626       665.01,916.59     223.5,225.5         1    149.00        209.0    303.00   2615430    790.8018  16812.8419</span>
<span class="co">## 62       unaligned    intermediate Oikopleura   96501       649.84,681.14     257.5,261.5         1     72.00        233.0    410.00    106962    665.4904   2480.1362</span>
<span class="co">## 63       unaligned         distant Drosophila   47867     2115.49,2325.33     1100,1125.5         1    424.00        853.0   1868.00   1031382   2220.4080  11711.7224</span>
<span class="co">## 64       unaligned         distant      Ciona  138550     1507.32,1563.34         673,683         1    301.00        497.0   1147.00    340903   1535.3326   5319.4596</span>
<span class="co">## 65       unaligned         distant Oikopleura  248924       864.59,895.56     380.5,384.5         1    154.00        309.0    639.00    283076    880.0764   3941.8615</span>
<span class="co">## 66       unaligned different_genus       &lt;NA&gt;    4443    51033.47,56289.1 31315.5,35664.5         1   1059.00      12496.0  72354.50   1318064  53661.2845  89344.3051</span>
<span class="co">## 67         unmaped  same_or_sister Drosophila    2616     6516.25,8298.34     2456,2975.5         1    266.75       1311.0   5929.50    545408   7407.2924  23241.7218</span>
<span class="co">## 68         unmaped  same_or_sister      Ciona    6304     1718.19,1933.18    905.5,1002.5         1     24.00        521.0   1977.50    169778   1825.6851   4353.8685</span>
<span class="co">## 69         unmaped  same_or_sister Oikopleura   13396      1049.23,1142.4     434.5,471.5         1      9.00        209.0    989.25     56097   1095.8156   2750.6950</span>
<span class="co">## 70         unmaped           close Drosophila    1776   10099.58,13319.72       4087,5246         1    407.50       2005.5  10593.00    859148  11709.6492  34595.6295</span>
<span class="co">## 71         unmaped           close      Ciona   13298     2842.81,3131.98       1138,1230         1     82.00        595.0   2508.75    222284   2987.3928   8505.9641</span>
<span class="co">## 72         unmaped    intermediate Drosophila     984   23497.61,40593.44     1173,1914.5         1    313.75        693.5   4526.00   2615430  32045.5264 136638.9172</span>
<span class="co">## 73         unmaped    intermediate Oikopleura   17332     1951.06,2110.28       647.5,699         1     92.00        321.0   1489.00    106962   2030.6699   5347.2715</span>
<span class="co">## 74         unmaped         distant Drosophila    5951     5780.24,7400.13     2069.5,2221         1    772.50       1602.0   3679.50   1031382   6590.1850  31872.2350</span>
<span class="co">## 75         unmaped         distant      Ciona    8137     9082.69,9868.25       5618,5949         1   1916.00       4319.0   9995.00    340903   9475.4708  18074.6835</span>
<span class="co">## 76         unmaped         distant Oikopleura   69607      1748.1,1853.14     675.5,694.5         1    160.00        430.0   1319.00    283076   1800.6193   7069.6154</span>
<span class="co">## 77         unmaped different_genus       &lt;NA&gt;    2679   83929.15,91617.44 66459.5,73084.5         1  19851.50      55753.0 119267.50   1318064  87773.2912 101470.9185</span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="va">old.o</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/detach.html" class="external-link">detach</a></span><span class="op">(</span><span class="st">'package:dplyr'</span><span class="op">)</span></code></pre></div>
</details>
</div>
</div>
<div class="section level2">
<h2 id="width-distribution-of-aligned-and-mapped-regions">Width distribution of aligned and mapped regions<a class="anchor" aria-label="anchor" href="#width-distribution-of-aligned-and-mapped-regions"></a>
</h2>
<div class="section level3">
<h3 id="aligned-regions">Aligned regions<a class="anchor" aria-label="anchor" href="#aligned-regions"></a>
</h3>
<div class="section level4">
<h4 id="whole-genomes">Whole genomes<a class="anchor" aria-label="anchor" href="#whole-genomes"></a>
</h4>
<p><em>Aligned</em> means “before coalescing” and <em>mapped</em> means “after coalescing”.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">gbs</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">genus</span> <span class="op">+</span> <span class="va">class</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of aligned region widths"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">names_table</span><span class="op">$</span><span class="va">class</span><span class="op">)</span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_before_coalescing-1.png" width="960"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">gbs</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">genus</span> <span class="op">==</span> <span class="st">"Oikopleura"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of aligned region widths"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">names_table</span><span class="op">$</span><span class="va">query</span><span class="op">)</span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_before_coalescing-2.png" width="960"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">gbs</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">class</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">genus</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of aligned region widths"</span><span class="op">)</span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_before_coalescing2-1.png" width="576"></p>
</div>
<div class="section level4">
<h4 id="faceted-by-arms">Faceted by arms<a class="anchor" aria-label="anchor" href="#faceted-by-arms"></a>
</h4>
<p>The distribution of widths is not the same on long and short arms.</p>
<p>Note that for this reason, it would be unwise to filter by width on some operations such as coalescing.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">gbs</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">chr</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of aligned region widths"</span><span class="op">)</span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/widths_gbs_by_arm-1.png" width="700"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">gbs</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">chr</span> <span class="op">==</span> <span class="st">"chr1"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of aligned region widths on chr1"</span><span class="op">)</span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/widths_gbs_by_arm-2.png" width="700"></p>
<p>Width distribution per arm follows similar pattern on chr2 (first graph). Pairs at a similar evolutionary distance show similar profile, with the exception of Osa_Aom, where the number of alignments on short arms is higher. Nevertheless, the trend of widths being longer on long arms stay true, so we can average them in the plot below.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">gbs</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">chr</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="st">"chr2"</span>, <span class="st">"PAR"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, nrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of alignment widths before collapsing, split by distance group"</span><span class="op">)</span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/widths_gbs2_by_arm-1.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="unaligned-regions">Unaligned regions<a class="anchor" aria-label="anchor" href="#unaligned-regions"></a>
</h3>
<p>Unaligned regions show no difference of width between arms, except perhaps at the “same population” level.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">unal</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">chr</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of unaligned region widths"</span><span class="op">)</span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/widths_unaligned-1.png" width="700"></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">unal</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">chr</span> <span class="op">==</span> <span class="st">"chr1"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of unaligned region widths"</span><span class="op">)</span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/widths_unaligned-2.png" width="700"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">unal</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">chr</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="st">"chr2"</span>, <span class="st">"PAR"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of unaligned region widths"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">300</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="st">"Width (vertical bar at 300 bp)"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Scale for 'x' is already present. Adding another scale for 'x', which will replace the existing scale.</span></code></pre>
<p><img src="RegionWidths_files/figure-html/widths_unaligned-3.png" width="700"></p>
<p>Interestingly, only in Oikopleura do the width distributions from pairs of different distance peak at the same size. Could that be because the genome is very compact?</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">unal</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">chr</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="st">"chr2"</span>, <span class="st">"PAR"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of unaligned region widths"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">300</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="st">"Width (vertical bar at 300 bp)"</span><span class="op">)</span>  <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">names_table</span><span class="op">$</span><span class="va">query</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Scale for 'x' is already present. Adding another scale for 'x', which will replace the existing scale.</span></code></pre>
<p><img src="RegionWidths_files/figure-html/widths_unaligned2-1.png" width="700"></p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">unal</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">class</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">genus</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of unaligned region widths"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">300</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="st">"Width (vertical bar at 300 bp)"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Scale for 'x' is already present. Adding another scale for 'x', which will replace the existing scale.</span></code></pre>
<p><img src="RegionWidths_files/figure-html/widths_unaligned2-2.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="mapped-coalesced-regions">Mapped (coalesced) regions<a class="anchor" aria-label="anchor" href="#mapped-coalesced-regions"></a>
</h3>
<p>After coalescing, some width distribution become clearly bimodal. The distributions are hard to compare between genera and between evolutionary distance groups, and even within group for the “same population” <em>Oikopleura</em>.</p>
<p>The plots below display the data in details for the reader to make their opinion about the above statement.</p>
<div class="section level4">
<h4 id="whole-data">Whole data<a class="anchor" aria-label="anchor" href="#whole-data"></a>
</h4>
<div class="section level5">
<h5 id="width-distributions-">Width distributions.<a class="anchor" aria-label="anchor" href="#width-distributions-"></a>
</h5>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Using after_stat(density) to make more meaningful comparisons between genus</span>
<span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">genus</span> <span class="op">+</span> <span class="va">class</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of mapped region widths"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">names_table</span><span class="op">$</span><span class="va">query</span><span class="op">)</span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_after_coalescing-1.png" width="1152"></p>
<p>Faceting by genus only. Why is North / North (“intermediate”) not bimodal?</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">class</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">genus</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of mapped region widths"</span><span class="op">)</span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_after_coalescing2-1.png" width="768"></p>
<p>What is in the first peak of the bimodal distributions ?</p>
</div>
<div class="section level5">
<h5 id="empirical-cumulative-distributions">Empirical cumulative distributions<a class="anchor" aria-label="anchor" href="#empirical-cumulative-distributions"></a>
</h5>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, col <span class="op">=</span> <span class="va">genus</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_ecdf.html" class="external-link">stat_ecdf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>,<span class="fl">5e6</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">class</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: Removed 13 rows containing non-finite values (stat_ecdf).</span></code></pre>
<p><img src="RegionWidths_files/figure-html/width_after_coalescing_ecdf-1.png" width="1152"></p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, col <span class="op">=</span> <span class="va">class</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_ecdf.html" class="external-link">stat_ecdf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>,<span class="fl">5e6</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">genus</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: Removed 13 rows containing non-finite values (stat_ecdf).</span></code></pre>
<p><img src="RegionWidths_files/figure-html/width_after_coalescing_ecdf-2.png" width="1152"></p>
</div>
<div class="section level5">
<h5 id="cumulative-sums-">Cumulative sums.<a class="anchor" aria-label="anchor" href="#cumulative-sums-"></a>
</h5>
<p>Note: there is a bug: the lines jump between replicates instead of plotting them separately</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">widths</span><span class="op">$</span><span class="va">coa</span> |&gt;
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">width</span><span class="op">)</span> |&gt;
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span> |&gt;
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cumsum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">width</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">class</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">width</span>, y <span class="op">=</span> <span class="va">cumsum</span>, col <span class="op">=</span> <span class="va">genus</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_after_coalescing_cumsum-1.png" width="1152"></p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">widths</span><span class="op">$</span><span class="va">coa</span> |&gt;
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">width</span><span class="op">)</span> |&gt;
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span> |&gt;
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cumsum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">width</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">genus</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">width</span>, y <span class="op">=</span> <span class="va">cumsum</span>, col <span class="op">=</span> <span class="va">class</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_after_coalescing_cumsum-2.png" width="1152"></p>
</div>
</div>
<div class="section level4">
<h4 id="by-arm">By arm<a class="anchor" aria-label="anchor" href="#by-arm"></a>
</h4>
<p>When faceted by chromosome and arm type, bimodality is also observed. There is a small peak under 500 bp, found on all arms except YSR. The second peak shows two different distributions for long and short arms.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">chr</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of alignment widths after collapsing, split by arm."</span><span class="op">)</span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_after_coalescing3-1.png" width="700"></p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">flag</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">chr</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of alignment widths after collapsing, split by flag."</span><span class="op">)</span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_after_coalescing3-2.png" width="700"></p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa</span> <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of alignment widths on chr1 after collapsing, split by genome pair"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_after_coalescing3-3.png" width="700"></p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">chr</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="st">"chr2"</span>, <span class="st">"PAR"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of alignment widths after collapsing, split by distance group"</span><span class="op">)</span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_after_coalescing3-4.png" width="700"></p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">chr</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="st">"chr2"</span>, <span class="st">"PAR"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">flag</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">class</span> <span class="op">+</span> <span class="va">flag</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of alignment widths after collapsing, split by distance group"</span><span class="op">)</span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_after_coalescing3-5.png" width="700"></p>
<p>Therefore, if the first peak represented events that we do not want to consider breaking synteny (either alignment artefacts or insertion/transpositions of short mobile elements), we could re-coalesce once after removing the shortest intervals. We tried some width cutoffs on the coalescing step, but at 500 bp, the coverage of the genome by the resulting mapped regions is already decreasing (<code><a href="../articles/CoalescingCutoffs.html">vignette("CoalescingCutoffs", package = "OikScrambling")</a></code>).</p>
</div>
<div class="section level4">
<h4 id="non-coalesced-mapped-regions">Non-coalesced mapped regions<a class="anchor" aria-label="anchor" href="#non-coalesced-mapped-regions"></a>
</h4>
<p>The mapped regions that are found identical in the aligned set are those that were not coalesced… Are they the small peak ?</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">widths</span><span class="op">$</span><span class="va">coa</span><span class="op">$</span><span class="va">nonCoa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">coa</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">nonCoa</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="focus-on-oki-north-comparisons">Focus on Oki – North comparisons<a class="anchor" aria-label="anchor" href="#focus-on-oki-north-comparisons"></a>
</h4>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p_all</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"Oki – North"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of mapped region widths (vline at 600)"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">600</span><span class="op">)</span>

<span class="va">p_coa_map</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"Oki – North"</span>, <span class="va">Arm</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"short"</span>, <span class="st">"long"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"FALSE = collapsed, TRUE = non-collapsed"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">600</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">nonCoa</span> <span class="op">+</span> <span class="va">Arm</span><span class="op">)</span>

<span class="va">p_all</span> <span class="op">+</span> <span class="va">p_coa_map</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">'collect'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/mapped_region_widths_Oki_vs_North-1.png" width="700"></p>
<p>The short-width mapped peak is made of aligned regions that can not be coalesced.</p>
<p>We know from <code><a href="../articles/RepeatRegions.html">vignette("RepeatRegions", package = "OikScrambling")</a></code> that these short mapped regions are not repeats.</p>
</div>
</div>
<div class="section level3">
<h3 id="unmapped-regions">Unmapped regions<a class="anchor" aria-label="anchor" href="#unmapped-regions"></a>
</h3>
<p>Unmapped regions are a bit longer on the short arm in Oki – North comparisons…</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">unmap</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">chr</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of unmapped regions width after collapsing, split by arm."</span><span class="op">)</span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_of_unmapped_regions-1.png" width="700"></p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">unmap</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of unmapped regions width after collapsing, split by genome pair"</span><span class="op">)</span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_of_unmapped_regions-2.png" width="700"></p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">unmap</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">chr</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="st">"chr2"</span>, <span class="st">"PAR"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, nrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of unmapped region widths after collapsing, split by distance group"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">300</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="st">"Width (vertical bar at 300 bp)"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Scale for 'x' is already present. Adding another scale for 'x', which will replace the existing scale.</span></code></pre>
<p><img src="RegionWidths_files/figure-html/width_of_unmapped_regions-3.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="bridge-regions">Bridge regions<a class="anchor" aria-label="anchor" href="#bridge-regions"></a>
</h3>
<p>Note the short peak when comparing pairs within the same population.</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">bri</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">chr</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of widths of bridge regions, split by arm."</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></code></pre>
<pre><code><span class="co">## Warning: Removed 18784 rows containing non-finite values (stat_bin).</span></code></pre>
<p><img src="RegionWidths_files/figure-html/width_of_unAlmapped_regions-1.png" width="700"></p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">bri</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of widths of bridge regions, split by genome pair"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span>
<span class="co">## Removed 18784 rows containing non-finite values (stat_bin).</span></code></pre>
<p><img src="RegionWidths_files/figure-html/width_of_unAlmapped_regions-2.png" width="700"></p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">bri</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">chr</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="st">"chr2"</span>, <span class="st">"PAR"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, nrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of widths of bridge regions, split by distance group"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">300</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="st">"Width (vertical bar at 300 bp)"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Scale for 'x' is already present. Adding another scale for 'x', which will replace the existing scale.</span></code></pre>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></code></pre>
<pre><code><span class="co">## Warning: Removed 5425 rows containing non-finite values (stat_bin).</span></code></pre>
<p><img src="RegionWidths_files/figure-html/width_of_unAlmapped_regions-3.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="translocated-regions">Translocated regions<a class="anchor" aria-label="anchor" href="#translocated-regions"></a>
</h3>
<div class="section level4">
<h4 id="whole-region">Whole region<a class="anchor" aria-label="anchor" href="#whole-region"></a>
</h4>
<p>Reminder: here we measure the distance between the two colinear pairs that are separated by the translocated pair.</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">tra</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">chr</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of widths of translocated regions, split by arm."</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></code></pre>
<pre><code><span class="co">## Warning: Removed 207 rows containing non-finite values (stat_bin).</span></code></pre>
<p><img src="RegionWidths_files/figure-html/width_of_translocated_regions-1.png" width="700"></p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">tra</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of widths of translocated regions, split by genome pair"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span>
<span class="co">## Removed 207 rows containing non-finite values (stat_bin).</span></code></pre>
<p><img src="RegionWidths_files/figure-html/width_of_translocated_regions-2.png" width="700"></p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">tra</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">chr</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="st">"chr2"</span>, <span class="st">"PAR"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, nrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of widths of translocated regions, split by distance group"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">300</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="st">"Width (vertical bar at 300 bp)"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Scale for 'x' is already present. Adding another scale for 'x', which will replace the existing scale.</span></code></pre>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></code></pre>
<pre><code><span class="co">## Warning: Removed 125 rows containing non-finite values (stat_bin).</span></code></pre>
<p><img src="RegionWidths_files/figure-html/width_of_translocated_regions-3.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="whole-region-after-removal">Whole region, after removal<a class="anchor" aria-label="anchor" href="#whole-region-after-removal"></a>
</h4>
<p>Small peak in <em>“same pop”</em> disapears by design. Total number in the main peak also decreases, because they may pass the size filter on the <em>query</em> genome.</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">tra2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">chr</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of widths of translocated regions (after removal), split by arm."</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></code></pre>
<pre><code><span class="co">## Warning: Removed 9 rows containing non-finite values (stat_bin).</span></code></pre>
<p><img src="RegionWidths_files/figure-html/width_of_translocated_regions_rem-1.png" width="700"></p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">tra2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of widths of translocated regions (after removal), split by genome pair"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span>
<span class="co">## Removed 9 rows containing non-finite values (stat_bin).</span></code></pre>
<p><img src="RegionWidths_files/figure-html/width_of_translocated_regions_rem-2.png" width="700"></p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">tra2</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">chr</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="st">"chr2"</span>, <span class="st">"PAR"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, nrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of widths of translocated regions (after removal), split by distance group"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">300</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="st">"Width (vertical bar at 300 bp)"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Scale for 'x' is already present. Adding another scale for 'x', which will replace the existing scale.</span></code></pre>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></code></pre>
<pre><code><span class="co">## Warning: Removed 2 rows containing non-finite values (stat_bin).</span></code></pre>
<p><img src="RegionWidths_files/figure-html/width_of_translocated_regions_rem-3.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="aligned-before-removal">Aligned, before removal<a class="anchor" aria-label="anchor" href="#aligned-before-removal"></a>
</h4>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">widths</span><span class="op">$</span><span class="va">tra_coa_aln</span>   <span class="op">&lt;-</span> <span class="fu">makeWidthsDF</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">coa</span>, \<span class="op">(</span><span class="va">gb</span><span class="op">)</span> <span class="va">gb</span> |&gt; <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/flagTranslocations.html" class="external-link">flagTranslocations</a></span><span class="op">(</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/filterTranslocations.html" class="external-link">filterTranslocations</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> |&gt; <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span>

<span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">tra_coa_aln</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">chr</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of widths of translocated regions (aligned), split by arm."</span><span class="op">)</span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_of_translocated_regions_coa_aligned-1.png" width="700"></p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">tra_coa_aln</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of widths of translocated regions (aligned), split by genome pair"</span><span class="op">)</span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_of_translocated_regions_coa_aligned-2.png" width="700"></p>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">tra_coa_aln</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">chr</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="st">"chr2"</span>, <span class="st">"PAR"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, nrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of widths of translocated regions (aligned), split by distance group"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">300</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="st">"Width (vertical bar at 300 bp)"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Scale for 'x' is already present. Adding another scale for 'x', which will replace the existing scale.</span></code></pre>
<p><img src="RegionWidths_files/figure-html/width_of_translocated_regions_coa_aligned-3.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="aligned-after-removal">Aligned, after removal<a class="anchor" aria-label="anchor" href="#aligned-after-removal"></a>
</h4>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">widths</span><span class="op">$</span><span class="va">tra_coa2_aln</span>   <span class="op">&lt;-</span> <span class="fu">makeWidthsDF</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">coa2</span>, \<span class="op">(</span><span class="va">gb</span><span class="op">)</span> <span class="va">gb</span> |&gt; <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/flagTranslocations.html" class="external-link">flagTranslocations</a></span><span class="op">(</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/filterTranslocations.html" class="external-link">filterTranslocations</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> |&gt; <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span>

<span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">tra_coa2_aln</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">chr</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of widths of translocated regions (aligned, after removal), split by arm."</span><span class="op">)</span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_of_translocated_regions_coa2_aligned-1.png" width="700"></p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">tra_coa2_aln</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of widths of translocated regions (aligned, after removal), split by genome pair"</span><span class="op">)</span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_of_translocated_regions_coa2_aligned-2.png" width="700"></p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">tra_coa2_aln</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">chr</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="st">"chr2"</span>, <span class="st">"PAR"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, nrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of widths of translocated regions (aligned, after removal), split by distance group"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">300</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="st">"Width (vertical bar at 300 bp)"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Scale for 'x' is already present. Adding another scale for 'x', which will replace the existing scale.</span></code></pre>
<p><img src="RegionWidths_files/figure-html/width_of_translocated_regions_coa2_aligned-3.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="double-coalesced-regions">Double-coalesced regions<a class="anchor" aria-label="anchor" href="#double-coalesced-regions"></a>
</h3>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">chr</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of alignment widths after double-collapsing, split by arm."</span><span class="op">)</span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/re_coalesce-1.png" width="700"></p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of widthsof alignment widths after double-collapsing, split by genome pair"</span><span class="op">)</span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/re_coalesce-2.png" width="700"></p>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa2</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">chr</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="st">"chr2"</span>, <span class="st">"PAR"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, nrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of alignment widths after double-collapsing, split by distance group"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">500</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="st">"Width (vertical bar at 500 bp)"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Scale for 'x' is already present. Adding another scale for 'x', which will replace the existing scale.</span></code></pre>
<p><img src="RegionWidths_files/figure-html/re_coalesce-3.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="compound-pictures">Compound pictures<a class="anchor" aria-label="anchor" href="#compound-pictures"></a>
</h2>
<div class="section level3">
<h3 id="aligned-unaligned-and-mapped">“aligned”, “unaligned” and “mapped”<a class="anchor" aria-label="anchor" href="#aligned-unaligned-and-mapped"></a>
</h3>
<div class="section level4">
<h4 id="facet-by-genus">Facet by genus<a class="anchor" aria-label="anchor" href="#facet-by-genus"></a>
</h4>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p_ali</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">gbs</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">genus</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">class</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">genus</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Aligned"</span><span class="op">)</span>

<span class="va">p_una</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">unal</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">genus</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">class</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">genus</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Not aligned"</span><span class="op">)</span>

<span class="va">p_map</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">genus</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">class</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">genus</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Mapped"</span><span class="op">)</span>

<span class="co"># Patchwork</span>
<span class="op">(</span><span class="va">p_ali</span> <span class="op">|</span> <span class="va">p_una</span> <span class="op">|</span> <span class="va">p_map</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">3</span>, guides <span class="op">=</span> <span class="st">'collect'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/compound1-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="oik-only-color-by-distance">Oik only, color by distance<a class="anchor" aria-label="anchor" href="#oik-only-color-by-distance"></a>
</h4>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p_isol</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">isol</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">genus</span> <span class="op">==</span> <span class="st">"Oikopleura"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">class</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Isolated alignments"</span><span class="op">)</span>

<span class="va">p_unma</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">unmap</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">genus</span> <span class="op">==</span> <span class="st">"Oikopleura"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">class</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Unmapped"</span><span class="op">)</span>

<span class="va">p_coar</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">genus</span> <span class="op">==</span> <span class="st">"Oikopleura"</span>, <span class="op">!</span><span class="va">nonCoa</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">class</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Colinear regions"</span><span class="op">)</span>

<span class="va">p_brid</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">bri</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">genus</span> <span class="op">==</span> <span class="st">"Oikopleura"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">class</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Bridge regions"</span><span class="op">)</span>

<span class="va">p_coal</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">gbs</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">genus</span> <span class="op">==</span> <span class="st">"Oikopleura"</span>, <span class="op">!</span><span class="va">nonCoa</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">class</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Colinear alignments"</span><span class="op">)</span>

<span class="co"># Patchwork</span>
<span class="op">(</span><span class="va">p_isol</span> <span class="op">|</span> <span class="va">p_unma</span> <span class="op">|</span> <span class="va">p_coar</span> <span class="op">|</span> <span class="va">p_brid</span> <span class="op">|</span> <span class="va">p_coal</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">1</span>, guides <span class="op">=</span> <span class="st">'collect'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></code></pre>
<pre><code><span class="co">## Warning: Removed 7561 rows containing non-finite values (stat_bin).</span></code></pre>
<p><img src="RegionWidths_files/figure-html/compound1_oik-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="oik-only-color-by-alignment-class">Oik only, color by alignment class<a class="anchor" aria-label="anchor" href="#oik-only-color-by-alignment-class"></a>
</h4>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/cbind.html" class="external-link">rbind</a></span><span class="op">(</span>
  <span class="va">widths</span><span class="op">$</span><span class="va">isol</span>  |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">genus</span> <span class="op">==</span> <span class="st">"Oikopleura"</span><span class="op">)</span>           |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>aliclass <span class="op">=</span> <span class="st">"Isol"</span><span class="op">)</span>,
  <span class="va">widths</span><span class="op">$</span><span class="va">unmap</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">genus</span> <span class="op">==</span> <span class="st">"Oikopleura"</span><span class="op">)</span>           |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>aliclass <span class="op">=</span> <span class="st">"Unmap"</span><span class="op">)</span>,
  <span class="va">widths</span><span class="op">$</span><span class="va">coa</span>   |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">genus</span> <span class="op">==</span> <span class="st">"Oikopleura"</span>, <span class="op">!</span><span class="va">nonCoa</span><span class="op">)</span>  |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>aliclass <span class="op">=</span> <span class="st">"Col reg"</span><span class="op">)</span>,
  <span class="va">widths</span><span class="op">$</span><span class="va">bri</span>   |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">genus</span> <span class="op">==</span> <span class="st">"Oikopleura"</span><span class="op">)</span>           |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>aliclass <span class="op">=</span> <span class="st">"Bridge"</span><span class="op">)</span>,
  <span class="va">widths</span><span class="op">$</span><span class="va">gbs</span>   |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">genus</span> <span class="op">==</span> <span class="st">"Oikopleura"</span>, <span class="op">!</span><span class="va">nonCoa</span><span class="op">)</span>  |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>aliclass <span class="op">=</span> <span class="st">"Col aln"</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">aliclass</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">class</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></code></pre>
<pre><code><span class="co">## Warning: Removed 7561 rows containing non-finite values (stat_bin).</span></code></pre>
<p><img src="RegionWidths_files/figure-html/compound1_alignment_classes-1.png" width="700"></p>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">w</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">class</span> <span class="op">==</span> <span class="st">"distant"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">aliclass</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></code></pre>
<pre><code><span class="co">## Warning: Removed 1406 rows containing non-finite values (stat_bin).</span></code></pre>
<p><img src="RegionWidths_files/figure-html/compound1_alignment_classes-2.png" width="700"></p>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">w</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">class</span> <span class="op">==</span> <span class="st">"distant"</span><span class="op">)</span>, scale <span class="op">=</span> <span class="st">"natural"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">aliclass</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3e3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: Removed 49725 rows containing non-finite values (stat_bin).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 10 row(s) containing missing values (geom_path).</span></code></pre>
<p><img src="RegionWidths_files/figure-html/compound1_alignment_classes-3.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="isolated-unmapped-colinear-regions-bridge-and-colinear-alingments">“isolated”, “unmapped”, “colinear regions”, “bridge” and “colinear alingments”<a class="anchor" aria-label="anchor" href="#isolated-unmapped-colinear-regions-bridge-and-colinear-alingments"></a>
</h3>
<div class="section level4">
<h4 id="oki-north">Oki – North<a class="anchor" aria-label="anchor" href="#oki-north"></a>
</h4>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p_ali2</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">gbs</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"Oki – North"</span>, <span class="va">nonCoa</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">60</span>, scale <span class="op">=</span> <span class="st">"natural"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3e3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Isolated alignments"</span><span class="op">)</span>

<span class="va">p_unmap2</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">unmap</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"Oki – North"</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">60</span>, scale <span class="op">=</span> <span class="st">"natural"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3e3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Unmapped"</span><span class="op">)</span>

<span class="va">p_syn2</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"Oki – North"</span>, <span class="op">!</span><span class="va">nonCoa</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">600</span>, scale <span class="op">=</span> <span class="st">"natural"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3e4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Colinear region"</span><span class="op">)</span>

<span class="va">p_map2</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">gbs</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"Oki – North"</span>, <span class="op">!</span><span class="va">nonCoa</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">60</span>, scale <span class="op">=</span> <span class="st">"natural"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3e3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Colinear alignment"</span><span class="op">)</span>

<span class="va">p_bridge</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">bri</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"Oki – North"</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">20</span>, scale <span class="op">=</span> <span class="st">"natural"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3e3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Bridge"</span><span class="op">)</span>

<span class="co"># Patchwork</span>
<span class="va">p_oki_north</span> <span class="op">&lt;-</span><span class="op">(</span><span class="va">p_ali2</span> <span class="op">|</span> <span class="va">p_unmap2</span> <span class="op">|</span> <span class="va">p_syn2</span> <span class="op">|</span> <span class="va">p_bridge</span> <span class="op">|</span> <span class="va">p_map2</span> <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">5</span>, guides <span class="op">=</span> <span class="st">'collect'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html" class="external-link">plot_annotation</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Okinawa vs North"</span><span class="op">)</span>
<span class="va">p_oki_north</span></code></pre></div>
<pre><code><span class="co">## Warning: Removed 1485 rows containing non-finite values (stat_bin).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 16 row(s) containing missing values (geom_path).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 8089 rows containing non-finite values (stat_bin).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 16 row(s) containing missing values (geom_path).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 2326 rows containing non-finite values (stat_bin).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 16 row(s) containing missing values (geom_path).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 3190 rows containing non-finite values (stat_bin).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 16 row(s) containing missing values (geom_path).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 15668 rows containing non-finite values (stat_bin).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 16 row(s) containing missing values (geom_path).</span></code></pre>
<p><img src="RegionWidths_files/figure-html/compound2-1.svg" width="1920"></p>
</div>
<div class="section level4">
<h4 id="north-north">North – North<a class="anchor" aria-label="anchor" href="#north-north"></a>
</h4>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p_ali3</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">gbs</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"North – North"</span>, <span class="va">nonCoa</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">60</span>, scale <span class="op">=</span> <span class="st">"natural"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3e3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Isolated alignments"</span><span class="op">)</span>

<span class="va">p_unmap3</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">unmap</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"North – North"</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">60</span>, scale <span class="op">=</span> <span class="st">"natural"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3e3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Unmapped"</span><span class="op">)</span>

<span class="va">p_syn3</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"North – North"</span>, <span class="op">!</span><span class="va">nonCoa</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">600</span>, scale <span class="op">=</span> <span class="st">"natural"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3e4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Colinear region"</span><span class="op">)</span>

<span class="va">p_map3</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">gbs</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"North – North"</span>, <span class="op">!</span><span class="va">nonCoa</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">60</span>, scale <span class="op">=</span> <span class="st">"natural"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3e3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Colinear alignment"</span><span class="op">)</span>

<span class="va">p_bridge3</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">bri</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"North – North"</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">20</span>, scale <span class="op">=</span> <span class="st">"natural"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3e3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Bridge"</span><span class="op">)</span>

<span class="co"># Patchwork</span>
<span class="va">p_north_north</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">p_ali3</span> <span class="op">|</span> <span class="va">p_unmap3</span> <span class="op">|</span> <span class="va">p_syn3</span> <span class="op">|</span> <span class="va">p_bridge3</span> <span class="op">|</span> <span class="va">p_map3</span> <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">5</span>, guides <span class="op">=</span> <span class="st">'collect'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html" class="external-link">plot_annotation</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"North vs North"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p_ali4</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">gbs</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"In same pop"</span>, <span class="va">nonCoa</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">60</span>, scale <span class="op">=</span> <span class="st">"natural"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3e3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Isolated alignments"</span><span class="op">)</span>

<span class="va">p_unmap4</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">unmap</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"In same pop"</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">60</span>, scale <span class="op">=</span> <span class="st">"natural"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3e3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Unmapped"</span><span class="op">)</span>

<span class="va">p_syn4</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">coa</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"In same pop"</span>, <span class="op">!</span><span class="va">nonCoa</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">600</span>, scale <span class="op">=</span> <span class="st">"natural"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3e4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Colinear region"</span><span class="op">)</span>

<span class="va">p_map4</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">gbs</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"In same pop"</span>, <span class="op">!</span><span class="va">nonCoa</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">60</span>, scale <span class="op">=</span> <span class="st">"natural"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3e3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Colinear alignment"</span><span class="op">)</span>

<span class="va">p_bridge4</span> <span class="op">&lt;-</span> <span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">bri</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">dist</span> <span class="op">==</span> <span class="st">"In same pop"</span><span class="op">)</span>, binwidth <span class="op">=</span> <span class="fl">20</span>, scale <span class="op">=</span> <span class="st">"natural"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">width</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span>, col<span class="op">=</span><span class="va">name</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3e3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Bridge"</span><span class="op">)</span>

<span class="co"># Patchwork</span>
<span class="va">p_same_pop</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">p_ali4</span> <span class="op">|</span> <span class="va">p_unmap4</span> <span class="op">|</span> <span class="va">p_syn4</span> <span class="op">|</span> <span class="va">p_bridge4</span> <span class="op">|</span> <span class="va">p_map4</span> <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">5</span>, guides <span class="op">=</span> <span class="st">'collect'</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html" class="external-link">plot_annotation</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Same population"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p_oki_north</span>    <span class="op">/</span>
<span class="va">p_north_north</span>  <span class="op">/</span>
<span class="va">p_same_pop</span></code></pre></div>
<pre><code><span class="co">## Warning: Removed 1485 rows containing non-finite values (stat_bin).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 16 row(s) containing missing values (geom_path).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 8089 rows containing non-finite values (stat_bin).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 16 row(s) containing missing values (geom_path).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 2326 rows containing non-finite values (stat_bin).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 16 row(s) containing missing values (geom_path).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 3190 rows containing non-finite values (stat_bin).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 16 row(s) containing missing values (geom_path).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 15668 rows containing non-finite values (stat_bin).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 16 row(s) containing missing values (geom_path).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 431 rows containing non-finite values (stat_bin).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 8 row(s) containing missing values (geom_path).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 2700 rows containing non-finite values (stat_bin).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 8 row(s) containing missing values (geom_path).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 1402 rows containing non-finite values (stat_bin).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 8 row(s) containing missing values (geom_path).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 876 rows containing non-finite values (stat_bin).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 8 row(s) containing missing values (geom_path).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 11985 rows containing non-finite values (stat_bin).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 8 row(s) containing missing values (geom_path).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 1031 rows containing non-finite values (stat_bin).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 6 row(s) containing missing values (geom_path).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 1229 rows containing non-finite values (stat_bin).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 6 row(s) containing missing values (geom_path).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 1482 rows containing non-finite values (stat_bin).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 6 row(s) containing missing values (geom_path).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 614 rows containing non-finite values (stat_bin).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 6 row(s) containing missing values (geom_path).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 12048 rows containing non-finite values (stat_bin).</span></code></pre>
<pre><code><span class="co">## Warning: Removed 6 row(s) containing missing values (geom_path).</span></code></pre>
<p><img src="RegionWidths_files/figure-html/compound_all-1.svg" width="1920"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="paired-comparison-of-widths-in-target-and-query-genomes-">Paired comparison of widths in target and query genomes.<a class="anchor" aria-label="anchor" href="#paired-comparison-of-widths-in-target-and-query-genomes-"></a>
</h2>
<div class="sourceCode" id="cb151"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">GBreaks2widthTibble</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">gb</span>, <span class="va">pair</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">gb</span><span class="op">)</span>
  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Arm</span><span class="op">)</span><span class="op">)</span>       <span class="va">df</span><span class="op">$</span><span class="va">Arm</span>        <span class="op">&lt;-</span> <span class="cn">NA</span>
  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">rep</span><span class="op">)</span><span class="op">)</span>       <span class="va">df</span><span class="op">$</span><span class="va">rep</span>        <span class="op">&lt;-</span> <span class="cn">NA</span>
  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">query.rep</span><span class="op">)</span><span class="op">)</span> <span class="va">df</span><span class="op">$</span><span class="va">query.rep</span>  <span class="op">&lt;-</span> <span class="cn">NA</span>
  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>target     <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">width</span>,        query     <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">query.width</span>,
                 target.rep <span class="op">=</span> <span class="op">!</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">rep</span><span class="op">)</span>, query.rep <span class="op">=</span> <span class="op">!</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">query.rep</span><span class="op">)</span>,  <span class="co"># TRUE if overlaps a repeat</span>
                 pair <span class="op">=</span> <span class="va">pair</span>, Arm <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">Arm</span>,
                 dist <span class="op">=</span> <span class="fu">OikScrambling</span><span class="fu">:::</span><span class="fu"><a href="../reference/compDistance.html">compDistance</a></span><span class="op">(</span><span class="va">pair</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">gbs.w2w</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">gbs</span><span class="op">)</span>,      \<span class="op">(</span><span class="va">name</span><span class="op">)</span> <span class="fu">GBreaks2widthTibble</span><span class="op">(</span><span class="va">gbs</span><span class="op">[[</span><span class="va">name</span><span class="op">]</span><span class="op">]</span>,      pair <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">bri.w2s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bri</span><span class="op">)</span>,  \<span class="op">(</span><span class="va">name</span><span class="op">)</span> <span class="fu">GBreaks2widthTibble</span><span class="op">(</span><span class="va">bri</span><span class="op">[[</span><span class="va">name</span><span class="op">]</span><span class="op">]</span>,  pair <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">tra.w2s</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tra</span><span class="op">)</span>,      \<span class="op">(</span><span class="va">name</span><span class="op">)</span> <span class="fu">GBreaks2widthTibble</span><span class="op">(</span><span class="va">tra</span><span class="op">[[</span><span class="va">name</span><span class="op">]</span><span class="op">]</span>,      pair <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">tra2.w2s</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tra2</span><span class="op">)</span>,     \<span class="op">(</span><span class="va">name</span><span class="op">)</span> <span class="fu">GBreaks2widthTibble</span><span class="op">(</span><span class="va">tra2</span><span class="op">[[</span><span class="va">name</span><span class="op">]</span><span class="op">]</span>,     pair <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/cbind.html" class="external-link">rbind</a></span> <span class="op">(</span>
  aligned <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span>    <span class="va">gbs.w2w</span><span class="op">$</span><span class="va">target.rep</span>,     <span class="va">gbs.w2w</span><span class="op">$</span><span class="va">query.rep</span><span class="op">)</span><span class="op">)</span>,
  bri <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">bri.w2s</span><span class="op">$</span><span class="va">target.rep</span>, <span class="va">bri.w2s</span><span class="op">$</span><span class="va">query.rep</span><span class="op">)</span><span class="op">)</span>,
  transpo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span>    <span class="va">tra.w2s</span><span class="op">$</span><span class="va">target.rep</span>,     <span class="va">tra.w2s</span><span class="op">$</span><span class="va">query.rep</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<pre><code><span class="co">##         FALSE FALSE FALSE TRUE TRUE FALSE TRUE TRUE</span>
<span class="co">## aligned      768648      41624      41943     52103</span>
<span class="co">## bri          553741      84573      82538     35159</span>
<span class="co">## transpo        5824       1252       3043      2782</span></code></pre>
<div class="sourceCode" id="cb153"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ggPlotW2W</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">tibble</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tibble</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">target</span>, <span class="va">query</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density_2d.html" class="external-link">geom_density_2d</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu">ggPlotW2W</span><span class="op">(</span><span class="va">gbs.w2w</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Arm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Width of the target and query aligned regions"</span><span class="op">)</span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/paired_width_analysis-1.png" width="700"></p>
<div class="sourceCode" id="cb154"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggPlotW2W</span><span class="op">(</span><span class="va">bri.w2s</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Arm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Width of the target and query bridge regions"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></code></pre>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous y-axis</span></code></pre>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></code></pre>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous y-axis</span></code></pre>
<pre><code><span class="co">## Warning: Removed 14293 rows containing non-finite values (stat_density2d).</span></code></pre>
<p><img src="RegionWidths_files/figure-html/paired_width_analysis-2.png" width="700"></p>
<div class="sourceCode" id="cb160"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggPlotW2W</span><span class="op">(</span><span class="va">gbs.w2w</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">pair</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Width of the target and query aligned regions"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: stat_contour(): Zero contours were generated</span></code></pre>
<pre><code><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></code></pre>
<pre><code><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></code></pre>
<pre><code><span class="co">## Warning: stat_contour(): Zero contours were generated</span></code></pre>
<pre><code><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></code></pre>
<pre><code><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></code></pre>
<pre><code><span class="co">## Warning: stat_contour(): Zero contours were generated</span></code></pre>
<pre><code><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></code></pre>
<pre><code><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></code></pre>
<pre><code><span class="co">## Warning: stat_contour(): Zero contours were generated</span></code></pre>
<pre><code><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></code></pre>
<pre><code><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></code></pre>
<pre><code><span class="co">## Warning: stat_contour(): Zero contours were generated</span></code></pre>
<pre><code><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></code></pre>
<pre><code><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></code></pre>
<pre><code><span class="co">## Warning: stat_contour(): Zero contours were generated</span></code></pre>
<pre><code><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></code></pre>
<pre><code><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></code></pre>
<pre><code><span class="co">## Warning: stat_contour(): Zero contours were generated</span></code></pre>
<pre><code><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></code></pre>
<pre><code><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></code></pre>
<pre><code><span class="co">## Warning: stat_contour(): Zero contours were generated</span></code></pre>
<pre><code><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></code></pre>
<pre><code><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></code></pre>
<pre><code><span class="co">## Warning: stat_contour(): Zero contours were generated</span></code></pre>
<pre><code><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></code></pre>
<pre><code><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></code></pre>
<pre><code><span class="co">## Warning: stat_contour(): Zero contours were generated</span></code></pre>
<pre><code><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></code></pre>
<pre><code><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></code></pre>
<pre><code><span class="co">## Warning: stat_contour(): Zero contours were generated</span></code></pre>
<pre><code><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></code></pre>
<pre><code><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></code></pre>
<pre><code><span class="co">## Warning: stat_contour(): Zero contours were generated</span></code></pre>
<pre><code><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></code></pre>
<pre><code><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></code></pre>
<pre><code><span class="co">## Warning: stat_contour(): Zero contours were generated</span></code></pre>
<pre><code><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></code></pre>
<pre><code><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></code></pre>
<pre><code><span class="co">## Warning: stat_contour(): Zero contours were generated</span></code></pre>
<pre><code><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></code></pre>
<pre><code><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></code></pre>
<pre><code><span class="co">## Warning: stat_contour(): Zero contours were generated</span></code></pre>
<pre><code><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></code></pre>
<pre><code><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></code></pre>
<pre><code><span class="co">## Warning: stat_contour(): Zero contours were generated</span></code></pre>
<pre><code><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></code></pre>
<pre><code><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></code></pre>
<pre><code><span class="co">## Warning: stat_contour(): Zero contours were generated</span></code></pre>
<pre><code><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></code></pre>
<pre><code><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></code></pre>
<pre><code><span class="co">## Warning: stat_contour(): Zero contours were generated</span></code></pre>
<pre><code><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></code></pre>
<pre><code><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></code></pre>
<pre><code><span class="co">## Warning: stat_contour(): Zero contours were generated</span></code></pre>
<pre><code><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></code></pre>
<pre><code><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></code></pre>
<pre><code><span class="co">## Warning: stat_contour(): Zero contours were generated</span></code></pre>
<pre><code><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></code></pre>
<pre><code><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></code></pre>
<pre><code><span class="co">## Warning: stat_contour(): Zero contours were generated</span></code></pre>
<pre><code><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></code></pre>
<pre><code><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></code></pre>
<pre><code><span class="co">## Warning: stat_contour(): Zero contours were generated</span></code></pre>
<pre><code><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></code></pre>
<pre><code><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></code></pre>
<p><img src="RegionWidths_files/figure-html/paired_width_analysis-3.png" width="700"></p>
<div class="sourceCode" id="cb227"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggPlotW2W</span><span class="op">(</span><span class="va">gbs.w2w</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Width of the target and query aligned regions"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: stat_contour(): Zero contours were generated</span></code></pre>
<pre><code><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></code></pre>
<pre><code><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></code></pre>
<pre><code><span class="co">## Warning: stat_contour(): Zero contours were generated</span></code></pre>
<pre><code><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></code></pre>
<pre><code><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></code></pre>
<pre><code><span class="co">## Warning: stat_contour(): Zero contours were generated</span></code></pre>
<pre><code><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></code></pre>
<pre><code><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></code></pre>
<pre><code><span class="co">## Warning: stat_contour(): Zero contours were generated</span></code></pre>
<pre><code><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></code></pre>
<pre><code><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></code></pre>
<pre><code><span class="co">## Warning: stat_contour(): Zero contours were generated</span></code></pre>
<pre><code><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></code></pre>
<pre><code><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></code></pre>
<pre><code><span class="co">## Warning: stat_contour(): Zero contours were generated</span></code></pre>
<pre><code><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></code></pre>
<pre><code><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></code></pre>
<p><img src="RegionWidths_files/figure-html/paired_width_analysis-4.png" width="700"></p>
<div class="sourceCode" id="cb246"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggPlotW2W</span><span class="op">(</span><span class="va">bri.w2s</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">pair</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Width of the target and query bridge regions"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></code></pre>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous y-axis</span></code></pre>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></code></pre>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous y-axis</span></code></pre>
<pre><code><span class="co">## Warning: Removed 36376 rows containing non-finite values (stat_density2d).</span></code></pre>
<pre><code><span class="co">## Warning: stat_contour(): Zero contours were generated</span></code></pre>
<pre><code><span class="co">## Warning in min(x): no non-missing arguments to min; returning Inf</span></code></pre>
<pre><code><span class="co">## Warning in max(x): no non-missing arguments to max; returning -Inf</span></code></pre>
<p><img src="RegionWidths_files/figure-html/paired_width_analysis-5.png" width="700"></p>
<div class="sourceCode" id="cb255"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggPlotW2W</span><span class="op">(</span><span class="va">tra.w2s</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Arm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">pair</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Width of the target and query translocated regions"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></code></pre>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous y-axis</span></code></pre>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></code></pre>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous y-axis</span></code></pre>
<pre><code><span class="co">## Warning: Removed 893 rows containing non-finite values (stat_density2d).</span></code></pre>
<p><img src="RegionWidths_files/figure-html/paired_width_analysis-6.png" width="700"></p>
<div class="sourceCode" id="cb261"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggPlotW2W</span><span class="op">(</span><span class="va">tra.w2s</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Arm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Width of the target and query translocated regions"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></code></pre>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous y-axis</span></code></pre>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></code></pre>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous y-axis</span></code></pre>
<pre><code><span class="co">## Warning: Removed 893 rows containing non-finite values (stat_density2d).</span></code></pre>
<p><img src="RegionWidths_files/figure-html/paired_width_analysis-7.png" width="700"></p>
<div class="sourceCode" id="cb267"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggPlotW2W</span><span class="op">(</span><span class="va">tra2.w2s</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Arm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">pair</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Width of the target and query translocated regions (after removal)"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></code></pre>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous y-axis</span></code></pre>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></code></pre>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous y-axis</span></code></pre>
<pre><code><span class="co">## Warning: Removed 62 rows containing non-finite values (stat_density2d).</span></code></pre>
<p><img src="RegionWidths_files/figure-html/paired_width_analysis-8.png" width="700"></p>
<div class="sourceCode" id="cb273"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggPlotW2W</span><span class="op">(</span><span class="va">tra2.w2s</span> |&gt; <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Arm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Width of the target and query translocated regions (after removal)"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></code></pre>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous y-axis</span></code></pre>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></code></pre>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous y-axis</span></code></pre>
<pre><code><span class="co">## Warning: Removed 62 rows containing non-finite values (stat_density2d).</span></code></pre>
<p><img src="RegionWidths_files/figure-html/paired_width_analysis-9.png" width="700"></p>
<div class="sourceCode" id="cb279"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggPlotW2W</span><span class="op">(</span><span class="va">gbs.w2w</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">query.rep</span> <span class="op">+</span> <span class="va">target.rep</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Width of the target and query aligned regions, matching or not matching repeats"</span><span class="op">)</span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/paired_width_analysis-10.png" width="700"></p>
<div class="sourceCode" id="cb280"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggPlotW2W</span><span class="op">(</span><span class="va">bri.w2s</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">query.rep</span> <span class="op">+</span> <span class="va">target.rep</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Width of the target and query bridge regions, matching or not matching repeats"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></code></pre>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous y-axis</span></code></pre>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></code></pre>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous y-axis</span></code></pre>
<pre><code><span class="co">## Warning: Removed 36376 rows containing non-finite values (stat_density2d).</span></code></pre>
<p><img src="RegionWidths_files/figure-html/paired_width_analysis-11.png" width="700"></p>
<div class="sourceCode" id="cb286"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggPlotW2W</span><span class="op">(</span><span class="va">tra.w2s</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span> <span class="op">+</span> <span class="va">query.rep</span> <span class="op">+</span> <span class="va">target.rep</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Width of the target and query translocated regions, matching or not matching repeats"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></code></pre>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous y-axis</span></code></pre>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></code></pre>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous y-axis</span></code></pre>
<pre><code><span class="co">## Warning: Removed 1202 rows containing non-finite values (stat_density2d).</span></code></pre>
<p><img src="RegionWidths_files/figure-html/paired_width_analysis-12.png" width="700"></p>
<div class="sourceCode" id="cb292"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">bri.w2s</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">target</span> <span class="op">/</span> <span class="va">query</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">target.rep</span>, <span class="va">query.rep</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_freqpoly</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"In presence of a repeat, target width tends to be longer than query"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: Transformation introduced infinite values in continuous x-axis</span></code></pre>
<pre><code><span class="co">## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></code></pre>
<pre><code><span class="co">## Warning: Removed 36376 rows containing non-finite values (stat_bin).</span></code></pre>
<p><img src="RegionWidths_files/figure-html/paired_width_analysis-13.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="structural-variants">Structural variants<a class="anchor" aria-label="anchor" href="#structural-variants"></a>
</h2>
<div class="section level3">
<h3 id="width-of-inverted-regions">Width of inverted regions<a class="anchor" aria-label="anchor" href="#width-of-inverted-regions"></a>
</h3>
<p>We know that we can detect more inversions after coalescing and removing translocations (<code><a href="../articles/Inversions.html">vignette("Inversions", package = "OikScrambling")</a></code>).</p>
<p>Many inversions are shorter than 1 kbp. Size may differ slightly between long and short arms.</p>
<div class="sourceCode" id="cb296"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">invs.gbs</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">gbs</span>,  <span class="kw">function</span><span class="op">(</span><span class="va">gb</span><span class="op">)</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/filterInversions.html" class="external-link">filterInversions</a></span><span class="op">(</span><span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/flagInversions.html" class="external-link">flagInversions</a></span><span class="op">(</span><span class="va">gb</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/SimpleList-class.html" class="external-link">SimpleList</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">invs.coa</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">coa</span>,  <span class="kw">function</span><span class="op">(</span><span class="va">gb</span><span class="op">)</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/filterInversions.html" class="external-link">filterInversions</a></span><span class="op">(</span><span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/flagInversions.html" class="external-link">flagInversions</a></span><span class="op">(</span><span class="va">gb</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/SimpleList-class.html" class="external-link">SimpleList</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">invs.coa2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">coa2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">gb</span><span class="op">)</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/filterInversions.html" class="external-link">filterInversions</a></span><span class="op">(</span><span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/flagInversions.html" class="external-link">flagInversions</a></span><span class="op">(</span><span class="va">gb</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/SimpleList-class.html" class="external-link">SimpleList</a></span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">invs.gbs</span>,  <span class="va">length</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Oki_Osa Oki_Bar Oki_Kum Oki_Aom Oki_Nor Osa_Oki Osa_Bar Osa_Kum Osa_Aom Osa_Nor Bar_Oki Bar_Osa Bar_Kum Bar_Aom Bar_Nor Ply_Ros Ply_Rob Ply_Sav Ply_Oki Rob_Ros Rob_Ply Rob_Sav Rob_Oki Dme_Dbu Dme_Dsu </span>
<span class="co">##     614     604      89     608     541     613     241     620      56     212     597     237     608     237      19      42      58      16       0      50      58      14       0     697      20 </span>
<span class="co">## Dme_Dya Dme_Dma </span>
<span class="co">##      13      12</span></code></pre>
<div class="sourceCode" id="cb298"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">invs.coa</span>,  <span class="va">length</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Oki_Osa Oki_Bar Oki_Kum Oki_Aom Oki_Nor Osa_Oki Osa_Bar Osa_Kum Osa_Aom Osa_Nor Bar_Oki Bar_Osa Bar_Kum Bar_Aom Bar_Nor Ply_Ros Ply_Rob Ply_Sav Ply_Oki Rob_Ros Rob_Ply Rob_Sav Rob_Oki Dme_Dbu Dme_Dsu </span>
<span class="co">##     670     675     105     665     591     671     321     678      73     275     667     319     686     319      24      51      71      92       0      65      70      92       0    1003      44 </span>
<span class="co">## Dme_Dya Dme_Dma </span>
<span class="co">##      21      16</span></code></pre>
<div class="sourceCode" id="cb300"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">invs.coa2</span>, <span class="va">length</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Oki_Osa Oki_Bar Oki_Kum Oki_Aom Oki_Nor Osa_Oki Osa_Bar Osa_Kum Osa_Aom Osa_Nor Bar_Oki Bar_Osa Bar_Kum Bar_Aom Bar_Nor Ply_Ros Ply_Rob Ply_Sav Ply_Oki Rob_Ros Rob_Ply Rob_Sav Rob_Oki Dme_Dbu Dme_Dsu </span>
<span class="co">##     704     705     122     695     611     706     330     708      79     279     695     327     711     335      27      55      76      92       0      71      77      92       0    1003      45 </span>
<span class="co">## Dme_Dya Dme_Dma </span>
<span class="co">##      23      16</span></code></pre>
<div class="sourceCode" id="cb302"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Sanity check that we detect inversions on both strands</span>
<span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">invs.coa2</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/pkg/CNEr/man/Axt-util.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Rle-class.html" class="external-link">decode</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/strand.html" class="external-link">strand</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##   Oki_Osa Oki_Bar Oki_Kum Oki_Aom Oki_Nor Osa_Oki Osa_Bar Osa_Kum Osa_Aom Osa_Nor Bar_Oki Bar_Osa Bar_Kum Bar_Aom Bar_Nor Ply_Ros Ply_Rob Ply_Sav Ply_Oki Rob_Ros Rob_Ply Rob_Sav Rob_Oki Dme_Dbu</span>
<span class="co">## +     381     365      33     369     317     382     186     367      38     147     354     182     365     164       7       2       6      51       0       5       5      52       0     470</span>
<span class="co">## -     323     340      89     326     294     324     144     341      41     132     341     145     346     171      20      53      70      41       0      66      72      40       0     533</span>
<span class="co">## *       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0       0</span>
<span class="co">##   Dme_Dsu Dme_Dya Dme_Dma</span>
<span class="co">## +      29      11       3</span>
<span class="co">## -      16      12      13</span>
<span class="co">## *       0       0       0</span></code></pre>
<div class="sourceCode" id="cb304"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">widths</span><span class="op">$</span><span class="va">invs.gbs</span>  <span class="op">&lt;-</span> <span class="fu">makeWidthsDF</span><span class="op">(</span><span class="va">invs.gbs</span><span class="op">)</span>  |&gt; <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">widths</span><span class="op">$</span><span class="va">invs.coa</span>  <span class="op">&lt;-</span> <span class="fu">makeWidthsDF</span><span class="op">(</span><span class="va">invs.coa</span><span class="op">)</span>  |&gt; <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">widths</span><span class="op">$</span><span class="va">invs.coa2</span> <span class="op">&lt;-</span> <span class="fu">makeWidthsDF</span><span class="op">(</span><span class="va">invs.coa2</span><span class="op">)</span> |&gt; <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb305"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">invs.gbs</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">chr</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of alignment widths for inverted regions, using aligned regions, split by arm."</span><span class="op">)</span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/inversion_width_aligned-1.png" width="700"></p>
<div class="sourceCode" id="cb306"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">invs.gbs</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of alignment widths for inverted regions, using aligned regions, split by genome pair"</span><span class="op">)</span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/inversion_width_aligned-2.png" width="700"></p>
<div class="sourceCode" id="cb307"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">invs.gbs</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">chr</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="st">"chr2"</span>, <span class="st">"PAR"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, nrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of alignment widths for inverted regions, using aligned regions, split by distance group"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">500</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="st">"Width (vertical bar at 500 bp)"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Scale for 'x' is already present. Adding another scale for 'x', which will replace the existing scale.</span></code></pre>
<p><img src="RegionWidths_files/figure-html/inversion_width_aligned-3.png" width="700"></p>
<div class="sourceCode" id="cb309"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">invs.coa</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">chr</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of alignment widths for inverted regions, using mapped regions, split by arm."</span><span class="op">)</span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/inversion_width_mapped-1.png" width="700"></p>
<div class="sourceCode" id="cb310"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">invs.coa</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of alignment widths for inverted regions, using mapped regions, split by genome pair"</span><span class="op">)</span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/inversion_width_mapped-2.png" width="700"></p>
<div class="sourceCode" id="cb311"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">invs.coa</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">chr</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="st">"chr2"</span>, <span class="st">"PAR"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, nrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of alignment widths for inverted regions, using mapped regions, split by distance group"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">500</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="st">"Width (vertical bar at 500 bp)"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Scale for 'x' is already present. Adding another scale for 'x', which will replace the existing scale.</span></code></pre>
<p><img src="RegionWidths_files/figure-html/inversion_width_mapped-3.png" width="700"></p>
<div class="sourceCode" id="cb313"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">invs.coa2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">chr</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of alignment widths for inverted regions, using doublemapped regions, split by arm."</span><span class="op">)</span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/inversion_width_doublemapped-1.png" width="700"></p>
<div class="sourceCode" id="cb314"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">invs.coa2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, ncol<span class="op">=</span><span class="fl">5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of alignment widths for inverted regions, using doublemapped regions, split by genome pair"</span><span class="op">)</span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/inversion_width_doublemapped-2.png" width="700"></p>
<div class="sourceCode" id="cb315"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">invs.coa2</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">chr</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="st">"chr2"</span>, <span class="st">"PAR"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">dist</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, nrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution of alignment widths for inverted regions, using doublemapped regions, split by distance group"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">500</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="st">"Width (vertical bar at 500 bp)"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Scale for 'x' is already present. Adding another scale for 'x', which will replace the existing scale.</span></code></pre>
<p><img src="RegionWidths_files/figure-html/inversion_width_doublemapped-3.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="width-of-gaps-next-to-the-inverted-regions">Width of gaps next to the inverted regions<a class="anchor" aria-label="anchor" href="#width-of-gaps-next-to-the-inverted-regions"></a>
</h3>
<div class="sourceCode" id="cb317"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">inv.lgaps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">coa</span>, <span class="va">leftInversionGaps</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/SimpleList-class.html" class="external-link">SimpleList</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">inv.lgaps</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">inv.lgaps</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,  <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">OKI2018.I69</span><span class="op">)</span>
<span class="va">inv.lgaps</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">inv.lgaps</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">OSKA2016v1.9</span><span class="op">)</span>
<span class="va">inv.lgaps</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">inv.lgaps</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Bar2.p4</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">inv.lgaps</span>, <span class="va">length</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Oki_Osa Oki_Bar Oki_Kum Oki_Aom Oki_Nor Osa_Oki Osa_Bar Osa_Kum Osa_Aom Osa_Nor Bar_Oki Bar_Osa Bar_Kum Bar_Aom Bar_Nor Ply_Ros Ply_Rob Ply_Sav Ply_Oki Rob_Ros Rob_Ply Rob_Sav Rob_Oki Dme_Dbu Dme_Dsu </span>
<span class="co">##     669     675      96     665     591     669     319     678      69     274     666     315     685     315      22      46      65      92       0      61      67      92       0    1003      44 </span>
<span class="co">## Dme_Dya Dme_Dma </span>
<span class="co">##      21      14</span></code></pre>
<div class="sourceCode" id="cb319"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">widths</span><span class="op">$</span><span class="va">invs.lgaps</span> <span class="op">&lt;-</span> <span class="fu">makeWidthsDF</span><span class="op">(</span><span class="va">inv.lgaps</span><span class="op">)</span> |&gt; <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span>

<span class="fu">gg_freq_poly</span><span class="op">(</span><span class="va">widths</span><span class="op">$</span><span class="va">invs.lgaps</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">Arm</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">chr</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Distribution widths of left gaps next to inverted regions, split by arm."</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></code></pre></div>
<p><img src="RegionWidths_files/figure-html/width_of_inversions_gaps-1.png" width="700"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Aleksandra Bliznina, Michael Mansfield, Charles Plessy.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
