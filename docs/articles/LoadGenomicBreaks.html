<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Load genomic break data • OikScrambling</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Load genomic break data">
<meta property="og:description" content="OikScrambling">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">OikScrambling</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/OikScrambling.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ColinearityInterruptors.html">Regions interrupting colinearity</a>
    </li>
    <li>
      <a href="../articles/DistanceMeasures.html">Distance Measures</a>
    </li>
    <li>
      <a href="../articles/GenomicFeatures.html">Introduction to the OikScrambling package</a>
    </li>
    <li>
      <a href="../articles/Inversions.html">Inversions</a>
    </li>
    <li>
      <a href="../articles/LoadGenomicBreaks.html">Load genomic break data</a>
    </li>
    <li>
      <a href="../articles/OrthogroupSyntenies.html">Orthogroup syntenies</a>
    </li>
    <li>
      <a href="../articles/PWM.html">Motif finding and analysis</a>
    </li>
    <li>
      <a href="../articles/ParallelPlots.html">Whole-chromosome parallel plots</a>
    </li>
    <li>
      <a href="../articles/RegionWidths.html">Width of the aligned and mapped regions.</a>
    </li>
    <li>
      <a href="../articles/RepeatRegions.html">Repeat regions</a>
    </li>
    <li>
      <a href="../articles/Translocations.html">Translocations</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/oist/LuscombeU_OikScrambling/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="LoadGenomicBreaks_files/header-attrs-2.11/header-attrs.js"></script><script src="LoadGenomicBreaks_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Load genomic break data</h1>
                        <h4 class="author">Charles Plessy</h4>
            
            <h4 class="date">18 November, 2021</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/oist/LuscombeU_OikScrambling/blob/master/vignettes/LoadGenomicBreaks.Rmd"><code>vignettes/LoadGenomicBreaks.Rmd</code></a></small>
      <div class="hidden name"><code>LoadGenomicBreaks.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_knit.html">opts_knit</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This vignette loads the genomic breaks data, consolidates colinear regions, extracts unaligned and unmapped regions, transfers annotation data and saves the resulting objects in a serialised R object (<code>RData</code> file) for reuse in other vignettes.</p>
<p>Related objects are stored in lists to avoid cluttering the environment.</p>
</div>
<div id="packages-and-data" class="section level1">
<h1 class="hasAnchor">
<a href="#packages-and-data" class="anchor"></a>Packages and data</h1>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">{</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://oist.github.io/GenomicBreaks">'GenomicBreaks'</a></span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org">'ggplot2'</a></span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"BreakpointsData"</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span>
<span class="op">(</span><span class="va">genomes</span> <span class="op">&lt;-</span> <span class="fu">OikScrambling</span><span class="fu">:::</span><span class="fu"><a href="../reference/loadAllGenomes.html">loadAllGenomes</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Loading required package: BSgenome</code></pre>
<pre><code>## Loading required package: Biostrings</code></pre>
<pre><code>## Loading required package: XVector</code></pre>
<pre><code>## 
## Attaching package: 'Biostrings'</code></pre>
<pre><code>## The following object is masked from 'package:base':
## 
##     strsplit</code></pre>
<pre><code>## Loading required package: rtracklayer</code></pre>
<pre><code>## Warning in runHook(".onLoad", env, package.lib, package): strings not
## representable in native encoding will be translated to UTF-8

## Warning in runHook(".onLoad", env, package.lib, package): strings not
## representable in native encoding will be translated to UTF-8</code></pre>
<pre><code>## List of length 6
## names(6): Oki Osa Bar Kum Aom Nor</code></pre>
</div>
<div id="genomic-breaks" class="section level1">
<h1 class="hasAnchor">
<a href="#genomic-breaks" class="anchor"></a>Genomic breaks</h1>
<div id="longshort-arm-information" class="section level2">
<h2 class="hasAnchor">
<a href="#longshort-arm-information" class="anchor"></a>Long/short arm information</h2>
<p>Short / long arm annotation will be done by the <code><a href="https://oist.github.io/GenomicBreaks/reference/flagLongShort.html">GenomicBreaks::flagLongShort()</a></code> function.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">loadLongShort</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">file</span>, <span class="va">genome</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"extdata/Annotations/"</span>, <span class="va">file</span><span class="op">)</span>, package <span class="op">=</span> <span class="st">"BreakpointsData"</span><span class="op">)</span>
  <span class="va">gr</span> <span class="op">&lt;-</span> <span class="fu">rtracklayer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rtracklayer/man/GFFFile-class.html">import.gff3</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span>
  <span class="va">gr</span><span class="op">$</span><span class="va">source</span> <span class="op">&lt;-</span> <span class="va">gr</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="va">gr</span><span class="op">$</span><span class="va">score</span> <span class="op">&lt;-</span> <span class="va">gr</span><span class="op">$</span><span class="va">phase</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
  <span class="fu">GRanges</span><span class="op">(</span><span class="va">gr</span>, seqinfo <span class="op">=</span> <span class="fu">seqinfo</span><span class="op">(</span><span class="va">genome</span><span class="op">)</span>, strand <span class="op">=</span> <span class="st">"*"</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">longShort</span> <span class="op">&lt;-</span> <span class="fu">SimpleList</span><span class="op">(</span><span class="op">)</span>
<span class="va">longShort</span><span class="op">$</span><span class="va">Oki</span> <span class="op">&lt;-</span> <span class="fu">loadLongShort</span><span class="op">(</span><span class="st">"OKI2018_I69.v2/OKI2018_I69.arms.gff3"</span>, <span class="va">OKI2018_I69</span><span class="op">)</span>
<span class="va">longShort</span><span class="op">$</span><span class="va">Osa</span> <span class="op">&lt;-</span> <span class="fu">loadLongShort</span><span class="op">(</span><span class="st">"OSKA2016v1.9/OSKA2016v1.9.arms.gff3"</span>, <span class="va">OSKA2016v1.9</span><span class="op">)</span>
<span class="va">longShort</span><span class="op">$</span><span class="va">Bar</span> <span class="op">&lt;-</span> <span class="fu">loadLongShort</span><span class="op">(</span><span class="st">"Bar2_p4.Flye/Bar2_p4.Flye.arms.gff3"</span>, <span class="va">Bar2_p4</span><span class="op">)</span>

<span class="va">longShort</span></code></pre></div>
<pre><code>## List of length 3
## names(3): Oki Osa Bar</code></pre>
</div>
<div id="repeat-regions" class="section level2">
<h2 class="hasAnchor">
<a href="#repeat-regions" class="anchor"></a>Repeat regions</h2>
<p>Load from <code>BreakpointsData</code> package via <code>OikScrambling:::loadAllRepeats()</code></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">reps</span> <span class="op">&lt;-</span> <span class="fu">OikScrambling</span><span class="fu">:::</span><span class="fu"><a href="../reference/loadAllRepeats.html">loadAllRepeats</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## List of length 6
## names(6): Oki Osa Bar Kum Aom Nor</code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">annotateWithReps.GRanges</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">gr</span>, <span class="va">rep</span><span class="op">)</span> <span class="op">{</span>
  <span class="co"># Inspired from CAGEr:::ranges2names</span>
  <span class="va">o</span> <span class="op">&lt;-</span> <span class="fu">findOverlaps</span><span class="op">(</span><span class="va">gr</span>, <span class="va">rep</span><span class="op">)</span>
  <span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/as.html">as</a></span><span class="op">(</span><span class="va">o</span>, <span class="st">"List"</span><span class="op">)</span>
  <span class="va">o</span> <span class="op">&lt;-</span> <span class="fu">extractList</span><span class="op">(</span><span class="va">rep</span><span class="op">$</span><span class="va">Class</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">o</span><span class="op">)</span>
  <span class="va">o</span> <span class="op">&lt;-</span> <span class="fu">endoapply</span><span class="op">(</span><span class="va">o</span>, <span class="va">unique</span><span class="op">)</span>
  <span class="va">o</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">o</span>, <span class="va">length</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span>
  <span class="va">gr</span><span class="op">$</span><span class="va">rep</span> <span class="op">&lt;-</span> <span class="va">o</span>
  <span class="va">gr</span>
<span class="op">}</span>

<span class="va">annotateWithReps.GBreaks</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">gb</span>, <span class="va">repT</span>, <span class="va">repQ</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">gb</span><span class="op">$</span><span class="va">query</span> <span class="op">&lt;-</span> <span class="fu">annotateWithReps.GRanges</span><span class="op">(</span><span class="va">gb</span><span class="op">$</span><span class="va">query</span>, <span class="va">repQ</span><span class="op">)</span>
  <span class="va">gb</span>       <span class="op">&lt;-</span> <span class="fu">annotateWithReps.GRanges</span><span class="op">(</span><span class="va">gb</span>,       <span class="va">repT</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">annotateWithReps.GBreaksSimpleList</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">gbl</span>, <span class="va">reps</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">gbl</span><span class="op">$</span><span class="va">Oki_Osa</span> <span class="op">&lt;-</span> <span class="va">gbl</span><span class="op">$</span><span class="va">Oki_Osa</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Oki</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
  <span class="va">gbl</span><span class="op">$</span><span class="va">Oki_Bar</span> <span class="op">&lt;-</span> <span class="va">gbl</span><span class="op">$</span><span class="va">Oki_Bar</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Oki</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span>
  <span class="va">gbl</span><span class="op">$</span><span class="va">Oki_Kum</span> <span class="op">&lt;-</span> <span class="va">gbl</span><span class="op">$</span><span class="va">Oki_Kum</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Oki</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Kum</span><span class="op">)</span>
  <span class="va">gbl</span><span class="op">$</span><span class="va">Oki_Aom</span> <span class="op">&lt;-</span> <span class="va">gbl</span><span class="op">$</span><span class="va">Oki_Aom</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Oki</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Aom</span><span class="op">)</span>
  <span class="va">gbl</span><span class="op">$</span><span class="va">Oki_Nor</span> <span class="op">&lt;-</span> <span class="va">gbl</span><span class="op">$</span><span class="va">Oki_Nor</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Oki</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Nor</span><span class="op">)</span>
  
  <span class="va">gbl</span><span class="op">$</span><span class="va">Osa_Oki</span> <span class="op">&lt;-</span> <span class="va">gbl</span><span class="op">$</span><span class="va">Osa_Oki</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Osa</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
  <span class="va">gbl</span><span class="op">$</span><span class="va">Osa_Bar</span> <span class="op">&lt;-</span> <span class="va">gbl</span><span class="op">$</span><span class="va">Osa_Bar</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Osa</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span>
  <span class="va">gbl</span><span class="op">$</span><span class="va">Osa_Kum</span> <span class="op">&lt;-</span> <span class="va">gbl</span><span class="op">$</span><span class="va">Osa_Kum</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Osa</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Kum</span><span class="op">)</span>
  <span class="va">gbl</span><span class="op">$</span><span class="va">Osa_Aom</span> <span class="op">&lt;-</span> <span class="va">gbl</span><span class="op">$</span><span class="va">Osa_Aom</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Osa</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Aom</span><span class="op">)</span>
  <span class="va">gbl</span><span class="op">$</span><span class="va">Osa_Nor</span> <span class="op">&lt;-</span> <span class="va">gbl</span><span class="op">$</span><span class="va">Osa_Nor</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Osa</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Nor</span><span class="op">)</span>
  
  <span class="va">gbl</span><span class="op">$</span><span class="va">Bar_Oki</span> <span class="op">&lt;-</span> <span class="va">gbl</span><span class="op">$</span><span class="va">Bar_Oki</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Bar</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
  <span class="va">gbl</span><span class="op">$</span><span class="va">Bar_Osa</span> <span class="op">&lt;-</span> <span class="va">gbl</span><span class="op">$</span><span class="va">Bar_Osa</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Bar</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
  <span class="va">gbl</span><span class="op">$</span><span class="va">Bar_Kum</span> <span class="op">&lt;-</span> <span class="va">gbl</span><span class="op">$</span><span class="va">Bar_Kum</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Bar</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Kum</span><span class="op">)</span>
  <span class="va">gbl</span><span class="op">$</span><span class="va">Bar_Aom</span> <span class="op">&lt;-</span> <span class="va">gbl</span><span class="op">$</span><span class="va">Bar_Aom</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Bar</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Aom</span><span class="op">)</span>
  <span class="va">gbl</span><span class="op">$</span><span class="va">Bar_Nor</span> <span class="op">&lt;-</span> <span class="va">gbl</span><span class="op">$</span><span class="va">Bar_Nor</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Bar</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Nor</span><span class="op">)</span>
  <span class="va">gbl</span>
<span class="op">}</span></code></pre></div>
</div>
<div id="transcript-annotations" class="section level2">
<h2 class="hasAnchor">
<a href="#transcript-annotations" class="anchor"></a>Transcript annotations</h2>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">transcripts</span> <span class="op">&lt;-</span> <span class="fu">OikScrambling</span><span class="fu">:::</span><span class="fu"><a href="../reference/loadAllTranscriptsGR.html">loadAllTranscriptsGR</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## List of length 6
## names(6): Oki Osa Bar Kum Aom Nor</code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">annotateWithTranscripts</span> <span class="op">&lt;-</span>  <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">annotT</span>, <span class="va">annotQ</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/UseMethod.html">UseMethod</a></span><span class="op">(</span><span class="st">"annotateWithTranscripts"</span><span class="op">)</span>

<span class="va">annotateWithTranscripts.GRanges</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">annotT</span>, <span class="va">annotQ</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span>
  <span class="co"># Taken from CAGEr (and I am the author)</span>
  <span class="va">ranges2names</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">rangesA</span>, <span class="va">rangesB</span><span class="op">)</span> <span class="op">{</span>
    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">rangesB</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> 
        <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sQuote.html">sQuote</a></span><span class="op">(</span><span class="st">"rangesB"</span><span class="op">)</span>, <span class="st">" must contain have names."</span><span class="op">)</span>
    <span class="va">names</span> <span class="op">&lt;-</span> <span class="fu">findOverlaps</span><span class="op">(</span><span class="va">rangesA</span>, <span class="va">rangesB</span><span class="op">)</span>
    <span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/as.html">as</a></span><span class="op">(</span><span class="va">names</span>, <span class="st">"List"</span><span class="op">)</span>
    <span class="va">names</span> <span class="op">&lt;-</span> <span class="fu">extractList</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">rangesB</span><span class="op">)</span>, <span class="va">names</span><span class="op">)</span>
    <span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span>
    <span class="va">names</span> <span class="op">&lt;-</span> <span class="fu">unstrsplit</span><span class="op">(</span><span class="va">names</span>, <span class="st">";"</span><span class="op">)</span>
    <span class="fu">Rle</span><span class="op">(</span><span class="va">names</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="va">x</span><span class="op">$</span><span class="va">transcripts</span> <span class="op">&lt;-</span> <span class="fu">ranges2names</span><span class="op">(</span><span class="va">x</span>, <span class="va">annotT</span><span class="op">)</span>
  <span class="va">x</span><span class="op">$</span><span class="va">transcripts</span><span class="op">[</span><span class="va">x</span><span class="op">$</span><span class="va">transcripts</span> <span class="op">==</span> <span class="st">''</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span>
  <span class="va">x</span>
<span class="op">}</span>

<span class="va">annotateWithTranscripts.GBreaks</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">annotT</span>, <span class="va">annotQ</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">x</span><span class="op">$</span><span class="va">query</span> <span class="op">&lt;-</span> <span class="fu">annotateWithTranscripts.GRanges</span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">query</span>, <span class="va">annotQ</span><span class="op">)</span>
  <span class="va">x</span>       <span class="op">&lt;-</span> <span class="fu">annotateWithTranscripts.GRanges</span><span class="op">(</span><span class="va">x</span>,       <span class="va">annotT</span><span class="op">)</span>
  <span class="va">x</span>
<span class="op">}</span>

<span class="va">annotateWithTranscripts.GRangesList</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">annotT</span>, <span class="va">annotQ</span> <span class="op">=</span> <span class="va">annotT</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">x</span><span class="op">$</span><span class="va">Oki_Osa</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">Oki_Osa</span> |&gt; <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">annotT</span><span class="op">$</span><span class="va">Oki</span>, <span class="va">annotQ</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
  <span class="va">x</span><span class="op">$</span><span class="va">Oki_Bar</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">Oki_Bar</span> |&gt; <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">annotT</span><span class="op">$</span><span class="va">Oki</span>, <span class="va">annotQ</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span>
  <span class="va">x</span><span class="op">$</span><span class="va">Oki_Kum</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">Oki_Kum</span> |&gt; <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">annotT</span><span class="op">$</span><span class="va">Oki</span>, <span class="va">annotQ</span><span class="op">$</span><span class="va">Kum</span><span class="op">)</span>
  <span class="va">x</span><span class="op">$</span><span class="va">Oki_Aom</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">Oki_Aom</span> |&gt; <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">annotT</span><span class="op">$</span><span class="va">Oki</span>, <span class="va">annotQ</span><span class="op">$</span><span class="va">Aom</span><span class="op">)</span>
  <span class="va">x</span><span class="op">$</span><span class="va">Oki_Nor</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">Oki_Nor</span> |&gt; <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">annotT</span><span class="op">$</span><span class="va">Oki</span>, <span class="va">annotQ</span><span class="op">$</span><span class="va">Nor</span><span class="op">)</span>
  
  <span class="va">x</span><span class="op">$</span><span class="va">Osa_Oki</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">Osa_Oki</span> |&gt; <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">annotT</span><span class="op">$</span><span class="va">Osa</span>, <span class="va">annotQ</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
  <span class="va">x</span><span class="op">$</span><span class="va">Osa_Bar</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">Osa_Bar</span> |&gt; <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">annotT</span><span class="op">$</span><span class="va">Osa</span>, <span class="va">annotQ</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span>
  <span class="va">x</span><span class="op">$</span><span class="va">Osa_Kum</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">Osa_Kum</span> |&gt; <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">annotT</span><span class="op">$</span><span class="va">Osa</span>, <span class="va">annotQ</span><span class="op">$</span><span class="va">Kum</span><span class="op">)</span>
  <span class="va">x</span><span class="op">$</span><span class="va">Osa_Aom</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">Osa_Aom</span> |&gt; <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">annotT</span><span class="op">$</span><span class="va">Osa</span>, <span class="va">annotQ</span><span class="op">$</span><span class="va">Aom</span><span class="op">)</span>
  <span class="va">x</span><span class="op">$</span><span class="va">Osa_Nor</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">Osa_Nor</span> |&gt; <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">annotT</span><span class="op">$</span><span class="va">Osa</span>, <span class="va">annotQ</span><span class="op">$</span><span class="va">Nor</span><span class="op">)</span>
  
  <span class="va">x</span><span class="op">$</span><span class="va">Bar_Oki</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">Bar_Oki</span> |&gt; <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">annotT</span><span class="op">$</span><span class="va">Bar</span>, <span class="va">annotQ</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
  <span class="va">x</span><span class="op">$</span><span class="va">Bar_Osa</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">Bar_Osa</span> |&gt; <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">annotT</span><span class="op">$</span><span class="va">Bar</span>, <span class="va">annotQ</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
  <span class="va">x</span><span class="op">$</span><span class="va">Bar_Kum</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">Bar_Kum</span> |&gt; <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">annotT</span><span class="op">$</span><span class="va">Bar</span>, <span class="va">annotQ</span><span class="op">$</span><span class="va">Kum</span><span class="op">)</span>
  <span class="va">x</span><span class="op">$</span><span class="va">Bar_Aom</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">Bar_Aom</span> |&gt; <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">annotT</span><span class="op">$</span><span class="va">Bar</span>, <span class="va">annotQ</span><span class="op">$</span><span class="va">Aom</span><span class="op">)</span>
  <span class="va">x</span><span class="op">$</span><span class="va">Bar_Nor</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">Bar_Nor</span> |&gt; <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">annotT</span><span class="op">$</span><span class="va">Bar</span>, <span class="va">annotQ</span><span class="op">$</span><span class="va">Nor</span><span class="op">)</span>
  <span class="va">x</span>
<span class="op">}</span>

<span class="va">annotateWithTranscripts.SimpleList</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">annotT</span>, <span class="va">annotQ</span> <span class="op">=</span> <span class="va">annotT</span><span class="op">)</span>
  <span class="fu">annotateWithTranscripts.GRangesList</span><span class="op">(</span><span class="va">x</span>, annotT <span class="op">=</span> <span class="va">annotT</span>, annotQ <span class="op">=</span> <span class="va">annotQ</span><span class="op">)</span></code></pre></div>
</div>
<div id="mapped-alignments" class="section level2">
<h2 class="hasAnchor">
<a href="#mapped-alignments" class="anchor"></a>Mapped alignments</h2>
<p>Let’s load data from genome alignments, using the copy distributed in the <code>BreakpointsData</code> package.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Local function to add extra annotation on long/short arms while loading data</span>
<span class="va">load_genomic_breaks_</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">file</span>, <span class="va">genomeT</span>, <span class="va">genomeQ</span>, <span class="va">longShort</span><span class="op">=</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"extdata/Oidioi_pairwise_v3/"</span>, <span class="va">file</span><span class="op">)</span>, package <span class="op">=</span> <span class="st">"BreakpointsData"</span><span class="op">)</span>
  <span class="va">gb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/load_genomic_breaks.html">load_genomic_breaks</a></span><span class="op">(</span><span class="va">file</span>, <span class="va">genomeT</span>,  <span class="va">genomeQ</span><span class="op">)</span>
  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span> <span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">longShort</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">gb</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/flagLongShort.html">flagLongShort</a></span><span class="op">(</span><span class="va">gb</span>, <span class="va">longShort</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="va">gb</span>
<span class="op">}</span>

<span class="va">gbs</span> <span class="op">&lt;-</span> <span class="fu">SimpleList</span><span class="op">(</span><span class="op">)</span>

<span class="va">gbs</span><span class="op">$</span><span class="va">Oki_Osa</span> <span class="op">&lt;-</span> <span class="fu">load_genomic_breaks_</span><span class="op">(</span><span class="st">"OKI2018_I69_1.0__OSKA2016v1.9.gff.gz"</span>, <span class="va">OKI2018_I69</span>,  <span class="va">OSKA2016v1.9</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Oki</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
<span class="va">gbs</span><span class="op">$</span><span class="va">Oki_Bar</span> <span class="op">&lt;-</span> <span class="fu">load_genomic_breaks_</span><span class="op">(</span><span class="st">"OKI2018_I69_1.0__Bar2_p4.gff.gz"</span>,      <span class="va">OKI2018_I69</span>,  <span class="va">Bar2_p4</span>,      <span class="va">longShort</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Oki</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span>
<span class="va">gbs</span><span class="op">$</span><span class="va">Oki_Kum</span> <span class="op">&lt;-</span> <span class="fu">load_genomic_breaks_</span><span class="op">(</span><span class="st">"OKI2018_I69_1.0__KUM-M3-7f.gff.gz"</span>,    <span class="va">OKI2018_I69</span>,  <span class="va">KUM_M3</span>,       <span class="va">longShort</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Oki</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Kum</span><span class="op">)</span>
<span class="va">gbs</span><span class="op">$</span><span class="va">Oki_Aom</span> <span class="op">&lt;-</span> <span class="fu">load_genomic_breaks_</span><span class="op">(</span><span class="st">"OKI2018_I69_1.0__AOM-5-5f.gff.gz"</span>,     <span class="va">OKI2018_I69</span>,  <span class="va">AOM_5</span>,        <span class="va">longShort</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Oki</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Aom</span><span class="op">)</span>
<span class="va">gbs</span><span class="op">$</span><span class="va">Oki_Nor</span> <span class="op">&lt;-</span> <span class="fu">load_genomic_breaks_</span><span class="op">(</span><span class="st">"OKI2018_I69_1.0__OdB3.gff.gz"</span>,         <span class="va">OKI2018_I69</span>,  <span class="va">OdB3</span>,         <span class="va">longShort</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Oki</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Nor</span><span class="op">)</span>

<span class="va">gbs</span><span class="op">$</span><span class="va">Osa_Oki</span> <span class="op">&lt;-</span> <span class="fu">load_genomic_breaks_</span><span class="op">(</span><span class="st">"OSKA2016v1.9__OKI2018_I69_1.0.gff.gz"</span>, <span class="va">OSKA2016v1.9</span>, <span class="va">OKI2018_I69</span>,  <span class="va">longShort</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Osa</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
<span class="va">gbs</span><span class="op">$</span><span class="va">Osa_Bar</span> <span class="op">&lt;-</span> <span class="fu">load_genomic_breaks_</span><span class="op">(</span><span class="st">"OSKA2016v1.9__Bar2_p4.gff.gz"</span>,         <span class="va">OSKA2016v1.9</span>, <span class="va">Bar2_p4</span>,      <span class="va">longShort</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Osa</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span>
<span class="va">gbs</span><span class="op">$</span><span class="va">Osa_Kum</span> <span class="op">&lt;-</span> <span class="fu">load_genomic_breaks_</span><span class="op">(</span><span class="st">"OSKA2016v1.9__KUM-M3-7f.gff.gz"</span>,       <span class="va">OSKA2016v1.9</span>, <span class="va">KUM_M3</span>,       <span class="va">longShort</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Osa</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Kum</span><span class="op">)</span>
<span class="va">gbs</span><span class="op">$</span><span class="va">Osa_Aom</span> <span class="op">&lt;-</span> <span class="fu">load_genomic_breaks_</span><span class="op">(</span><span class="st">"OSKA2016v1.9__AOM-5-5f.gff.gz"</span>,        <span class="va">OSKA2016v1.9</span>, <span class="va">AOM_5</span>,        <span class="va">longShort</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Osa</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Aom</span><span class="op">)</span>
<span class="va">gbs</span><span class="op">$</span><span class="va">Osa_Nor</span> <span class="op">&lt;-</span> <span class="fu">load_genomic_breaks_</span><span class="op">(</span><span class="st">"OSKA2016v1.9__OdB3.gff.gz"</span>,            <span class="va">OSKA2016v1.9</span>, <span class="va">OdB3</span>,         <span class="va">longShort</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Osa</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Nor</span><span class="op">)</span>

<span class="va">gbs</span><span class="op">$</span><span class="va">Bar_Oki</span> <span class="op">&lt;-</span> <span class="fu">load_genomic_breaks_</span><span class="op">(</span><span class="st">"Bar2_p4__OKI2018_I69_1.0.gff.gz"</span>,      <span class="va">Bar2_p4</span>,     <span class="va">OKI2018_I69</span>,   <span class="va">longShort</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Bar</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
<span class="va">gbs</span><span class="op">$</span><span class="va">Bar_Osa</span> <span class="op">&lt;-</span> <span class="fu">load_genomic_breaks_</span><span class="op">(</span><span class="st">"Bar2_p4__OSKA2016v1.9.gff.gz"</span>,         <span class="va">Bar2_p4</span>,     <span class="va">OSKA2016v1.9</span>,  <span class="va">longShort</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Bar</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
<span class="va">gbs</span><span class="op">$</span><span class="va">Bar_Kum</span> <span class="op">&lt;-</span> <span class="fu">load_genomic_breaks_</span><span class="op">(</span><span class="st">"Bar2_p4__KUM-M3-7f.gff.gz"</span>,            <span class="va">Bar2_p4</span>,     <span class="va">KUM_M3</span>,        <span class="va">longShort</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Bar</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Kum</span><span class="op">)</span>
<span class="va">gbs</span><span class="op">$</span><span class="va">Bar_Aom</span> <span class="op">&lt;-</span> <span class="fu">load_genomic_breaks_</span><span class="op">(</span><span class="st">"Bar2_p4__AOM-5-5f.gff.gz"</span>,             <span class="va">Bar2_p4</span>,     <span class="va">AOM_5</span>,         <span class="va">longShort</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Bar</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Aom</span><span class="op">)</span>
<span class="va">gbs</span><span class="op">$</span><span class="va">Bar_Nor</span> <span class="op">&lt;-</span> <span class="fu">load_genomic_breaks_</span><span class="op">(</span><span class="st">"Bar2_p4__OdB3.gff.gz"</span>,                 <span class="va">Bar2_p4</span>,     <span class="va">OdB3</span>,          <span class="va">longShort</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Bar</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Nor</span><span class="op">)</span>

<span class="va">gbs</span> <span class="op">&lt;-</span> <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">gbs</span>, <span class="va">transcripts</span><span class="op">)</span>
<span class="va">gbs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">gbs</span>, <span class="va">flagAll</span><span class="op">)</span> |&gt; <span class="fu">SimpleList</span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div id="unaligned-regions" class="section level2">
<h2 class="hasAnchor">
<a href="#unaligned-regions" class="anchor"></a>Unaligned regions</h2>
<p>Note that the unaligned regions are strandless and unpaired by definition.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">unal</span>  <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">gbs</span>, <span class="va">cleanGaps</span><span class="op">)</span> |&gt; <span class="fu">SimpleList</span><span class="op">(</span><span class="op">)</span>
<span class="va">unal</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">unal</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
<span class="va">unal</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">unal</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
<span class="va">unal</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">unal</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span>

<span class="va">unal</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">unal</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span>, <span class="va">annotateWithReps.GRanges</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
<span class="va">unal</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">unal</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="va">annotateWithReps.GRanges</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
<span class="va">unal</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">unal</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>, <span class="va">annotateWithReps.GRanges</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span>

<span class="va">unal</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">unal</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span>, <span class="va">annotateWithTranscripts</span>, <span class="va">transcripts</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
<span class="va">unal</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">unal</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="va">annotateWithTranscripts</span>, <span class="va">transcripts</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
<span class="va">unal</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">unal</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>, <span class="va">annotateWithTranscripts</span>, <span class="va">transcripts</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span></code></pre></div>
</div>
<div id="coalescing-alignments" class="section level2">
<h2 class="hasAnchor">
<a href="#coalescing-alignments" class="anchor"></a>Coalescing alignments</h2>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">coa</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">gbs</span>, <span class="va">coalesce_contigs</span><span class="op">)</span> |&gt; <span class="fu">SimpleList</span><span class="op">(</span><span class="op">)</span>
<span class="va">coa</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">coa</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,  <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
<span class="va">coa</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">coa</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
<span class="va">coa</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">coa</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span>

<span class="va">coa</span> <span class="op">&lt;-</span> <span class="fu">annotateWithReps.GBreaksSimpleList</span><span class="op">(</span><span class="va">coa</span>, <span class="va">reps</span><span class="op">)</span>
<span class="va">coa</span> <span class="op">&lt;-</span> <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">coa</span>, <span class="va">transcripts</span><span class="op">)</span>

<span class="va">coa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">coa</span>, <span class="va">flagAll</span><span class="op">)</span> |&gt; <span class="fu">SimpleList</span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div id="unmapped-regions" class="section level2">
<h2 class="hasAnchor">
<a href="#unmapped-regions" class="anchor"></a>Unmapped regions</h2>
<p>We can not call them “uncoalesced” because this would also qualify aligned regions that were not colinear with any other region.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">unmap</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">coa</span>, <span class="va">cleanGaps</span><span class="op">)</span> |&gt; <span class="fu">SimpleList</span><span class="op">(</span><span class="op">)</span>

<span class="va">unmap</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">unmap</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
<span class="va">unmap</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">unmap</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
<span class="va">unmap</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">unmap</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span>

<span class="va">unmap</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">unmap</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span>, <span class="va">annotateWithReps.GRanges</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
<span class="va">unmap</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">unmap</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="va">annotateWithReps.GRanges</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
<span class="va">unmap</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">unmap</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>, <span class="va">annotateWithReps.GRanges</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span>

<span class="va">unmap</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">unmap</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span>, <span class="va">annotateWithTranscripts</span>, <span class="va">transcripts</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
<span class="va">unmap</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">unmap</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="va">annotateWithTranscripts</span>, <span class="va">transcripts</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
<span class="va">unmap</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">unmap</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>, <span class="va">annotateWithTranscripts</span>, <span class="va">transcripts</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span></code></pre></div>
</div>
<div id="mapped-unaligned-regions" class="section level2">
<h2 class="hasAnchor">
<a href="#mapped-unaligned-regions" class="anchor"></a>Mapped unaligned regions</h2>
<p>We can pair the unaligned regions that are between two colinearly aligned regions.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">filterMappedUnaligned</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">gb</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">colinearRegions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/filterColinearRegions.html">filterColinearRegions</a></span><span class="op">(</span><span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/flagColinearAlignments.html">flagColinearAlignments</a></span><span class="op">(</span><span class="va">gb</span><span class="op">)</span>, rename <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
  <span class="co"># Turning the sequence of [(TRUE)n, FALSE]n into indices.</span>
  <span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="op">!</span><span class="va">colinearRegions</span><span class="op">$</span><span class="va">colinear</span><span class="op">)</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>
  <span class="va">gbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span><span class="va">colinearRegions</span>, <span class="va">idx</span><span class="op">)</span>
  <span class="va">unalMap</span> <span class="op">&lt;-</span> <span class="fu">endoapply</span><span class="op">(</span><span class="va">gbl</span>, \<span class="op">(</span><span class="va">gb</span><span class="op">)</span> <span class="op">{</span>
    <span class="co"># Check strand</span>
    <span class="va">onMinus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="fu">strand</span><span class="op">(</span><span class="va">gb</span><span class="op">)</span> <span class="op">==</span> <span class="st">"-"</span><span class="op">)</span>
    <span class="co"># Need to subtract 1 because some ranges are adjacent (no gap)</span>
    <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/GBreaks-class.html">GBreaks</a></span><span class="op">(</span>target <span class="op">=</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/cleanGaps.html">cleanGaps</a></span><span class="op">(</span><span class="va">gb</span>      <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>,
            query  <span class="op">=</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/cleanGaps.html">cleanGaps</a></span><span class="op">(</span><span class="va">gb</span><span class="op">$</span><span class="va">query</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span>decreasing <span class="op">=</span> <span class="va">onMinus</span><span class="op">)</span><span class="op">)</span>
  <span class="op">}</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">unalMap</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
  <span class="va">unalMap</span>
<span class="op">}</span>

<span class="va">unalMap</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">gbs</span>, <span class="va">filterMappedUnaligned</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/as.html">as</a></span><span class="op">(</span><span class="st">"SimpleList"</span><span class="op">)</span>

<span class="va">unalMap</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">unalMap</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
<span class="va">unalMap</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">unalMap</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
<span class="va">unalMap</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">unalMap</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span>

<span class="va">unalMap</span> <span class="op">&lt;-</span> <span class="fu">annotateWithReps.GBreaksSimpleList</span><span class="op">(</span><span class="va">unalMap</span>, <span class="va">reps</span><span class="op">)</span>
<span class="va">unalMap</span> <span class="op">&lt;-</span> <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">unalMap</span>, <span class="va">transcripts</span><span class="op">)</span>
<span class="va">unalMap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">unalMap</span>, <span class="va">flagAll</span><span class="op">)</span> |&gt; <span class="fu">SimpleList</span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div id="translocated-regions" class="section level2">
<h2 class="hasAnchor">
<a href="#translocated-regions" class="anchor"></a>Translocated regions</h2>
<p>Here we compute new <code>GBreaks</code> objects representing the intervals between two regions that would be colinear if there would not be a translocation separating them.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">removeTranslocations</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">gb</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op">(</span><span class="va">gb</span><span class="op">$</span><span class="va">tra</span><span class="op">)</span><span class="op">)</span>
    <span class="va">gb</span> <span class="op">&lt;-</span> <span class="va">gb</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">gb</span><span class="op">$</span><span class="va">tra</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">]</span>
  <span class="va">gb</span>
<span class="op">}</span>

<span class="va">traGaps</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">coa</span><span class="op">)</span> <span class="op">{</span>
  <span class="co"># The input MUST already be coalesced.</span>
  <span class="co"># First, flag translocations on the target genome</span>
  <span class="va">tra.target</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/flagTranslocations.html">flagTranslocations</a></span><span class="op">(</span><span class="va">coa</span><span class="op">)</span><span class="op">$</span><span class="va">tra</span>
  <span class="co"># Second, do it again on the query genome</span>
  <span class="va">tra</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/swap.html">swap</a></span><span class="op">(</span><span class="va">coa</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span>ignore.strand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/flagTranslocations.html">flagTranslocations</a></span><span class="op">(</span><span class="op">)</span>
  <span class="va">tra.query</span> <span class="op">&lt;-</span> <span class="va">tra</span><span class="op">$</span><span class="va">tra</span>
  <span class="va">tra</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/swap.html">swap</a></span><span class="op">(</span><span class="va">tra</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span>ignore.strand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
  <span class="va">tra</span><span class="op">$</span><span class="va">tra</span> <span class="op">&lt;-</span> <span class="va">tra.target</span> <span class="op">|</span> <span class="va">tra.query</span>
  <span class="co"># Then, remove translocated regions</span>
  <span class="va">tra</span> <span class="op">&lt;-</span> <span class="fu">removeTranslocations</span><span class="op">(</span><span class="va">tra</span><span class="op">)</span>
  <span class="co"># Then extract the newly "unaligned mapped" regions</span>
  <span class="co"># They contain the gaps left by the removal of the translocated regions.</span>
  <span class="fu">filterMappedUnaligned</span><span class="op">(</span><span class="va">tra</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">tra</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">coa</span>, <span class="va">traGaps</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/as.html">as</a></span><span class="op">(</span><span class="st">"SimpleList"</span><span class="op">)</span>

<span class="va">tra</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">tra</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
<span class="va">tra</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">tra</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
<span class="va">tra</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">tra</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span>

<span class="va">tra</span> <span class="op">&lt;-</span> <span class="fu">annotateWithReps.GBreaksSimpleList</span><span class="op">(</span><span class="va">tra</span>, <span class="va">reps</span><span class="op">)</span>
<span class="va">tra</span> <span class="op">&lt;-</span> <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">tra</span>, <span class="va">transcripts</span><span class="op">)</span>
<span class="va">tra</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">tra</span>, <span class="va">flagAll</span><span class="op">)</span> |&gt; <span class="fu">SimpleList</span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div id="coalesce-again" class="section level2">
<h2 class="hasAnchor">
<a href="#coalesce-again" class="anchor"></a>Coalesce again</h2>
<p>We remove the translocated regions that interrupt colinearity, where one of the colinear pairs is closer than 200 bp.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">removeTranslocationsOnTargetGenome</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">gb</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">gb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/flagTranslocations.html">flagTranslocations</a></span><span class="op">(</span><span class="va">gb</span><span class="op">)</span>
  <span class="va">gb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/dist2next.html">dist2next</a></span><span class="op">(</span><span class="va">gb</span>, step <span class="op">=</span> <span class="fl">2</span>, ignore.strand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
  <span class="va">idx</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span> <span class="va">gb</span><span class="op">$</span><span class="va">tra</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">gb</span><span class="op">$</span><span class="va">tdist</span> <span class="op">&lt;</span> <span class="fl">200</span> <span class="op">|</span> <span class="va">gb</span><span class="op">$</span><span class="va">qdist</span> <span class="op">&lt;</span> <span class="fl">200</span><span class="op">)</span> <span class="op">)</span>
  <span class="va">gb</span> <span class="op">&lt;-</span> <span class="va">gb</span><span class="op">[</span><span class="op">-</span><span class="va">idx</span><span class="op">]</span>
  <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/coalesce_contigs.html">coalesce_contigs</a></span><span class="op">(</span><span class="va">gb</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">removeTranslocationsOnBothGenomes</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">gb</span><span class="op">)</span>
  <span class="va">gb</span> |&gt;
    <span class="fu">removeTranslocationsOnTargetGenome</span><span class="op">(</span><span class="op">)</span> |&gt;
    <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/swap.html">swap</a></span><span class="op">(</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span>i<span class="op">=</span><span class="cn">T</span><span class="op">)</span> |&gt;
    <span class="fu">removeTranslocationsOnTargetGenome</span><span class="op">(</span><span class="op">)</span> |&gt;
    <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/swap.html">swap</a></span><span class="op">(</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span>i<span class="op">=</span><span class="cn">T</span><span class="op">)</span>

<span class="va">coa2</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">coa</span>, <span class="va">removeTranslocationsOnBothGenomes</span><span class="op">)</span> |&gt; <span class="fu">SimpleList</span><span class="op">(</span><span class="op">)</span>
<span class="va">coa2</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">coa2</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,  <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
<span class="va">coa2</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">coa2</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
<span class="va">coa2</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">coa2</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span>

<span class="va">coa2</span> <span class="op">&lt;-</span> <span class="fu">annotateWithReps.GBreaksSimpleList</span><span class="op">(</span><span class="va">coa2</span>, <span class="va">reps</span><span class="op">)</span>
<span class="va">coa2</span> <span class="op">&lt;-</span> <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">coa2</span>, <span class="va">transcripts</span><span class="op">)</span>
<span class="va">coa2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">coa2</span>, <span class="va">flagAll</span><span class="op">)</span> |&gt; <span class="fu">SimpleList</span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div id="unmapped-regions-2" class="section level2">
<h2 class="hasAnchor">
<a href="#unmapped-regions-2" class="anchor"></a>Unmapped regions 2</h2>
<p>The intervals between double-coalesced regions.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">unmap2</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">coa2</span>, <span class="va">cleanGaps</span><span class="op">)</span> |&gt; <span class="fu">SimpleList</span><span class="op">(</span><span class="op">)</span>

<span class="va">unmap2</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">unmap2</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
<span class="va">unmap2</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">unmap2</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
<span class="va">unmap2</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">unmap2</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span>

<span class="va">unmap2</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">unmap2</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span>, <span class="va">annotateWithReps.GRanges</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
<span class="va">unmap2</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">unmap2</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="va">annotateWithReps.GRanges</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
<span class="va">unmap2</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">unmap2</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>, <span class="va">annotateWithReps.GRanges</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span>

<span class="va">unmap2</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">unmap2</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span>, <span class="va">annotateWithTranscripts</span>, <span class="va">transcripts</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
<span class="va">unmap2</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">unmap2</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="va">annotateWithTranscripts</span>, <span class="va">transcripts</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
<span class="va">unmap2</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">unmap2</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>, <span class="va">annotateWithTranscripts</span>, <span class="va">transcripts</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span></code></pre></div>
</div>
<div id="translocated-regions-2" class="section level2">
<h2 class="hasAnchor">
<a href="#translocated-regions-2" class="anchor"></a>Translocated regions 2</h2>
<p>To check that we really removed the small ones as intented.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tra2</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">coa2</span>, <span class="va">traGaps</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/as.html">as</a></span><span class="op">(</span><span class="st">"SimpleList"</span><span class="op">)</span>

<span class="va">tra2</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">tra2</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
<span class="va">tra2</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">tra2</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
<span class="va">tra2</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html">bplapply</a></span><span class="op">(</span><span class="va">tra2</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span>

<span class="va">tra2</span> <span class="op">&lt;-</span> <span class="fu">annotateWithReps.GBreaksSimpleList</span><span class="op">(</span><span class="va">tra2</span>, <span class="va">reps</span><span class="op">)</span>
<span class="va">tra2</span> <span class="op">&lt;-</span> <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">tra2</span>, <span class="va">transcripts</span><span class="op">)</span>

<span class="va">tra2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">tra2</span>, <span class="va">flagAll</span><span class="op">)</span> |&gt; <span class="fu">SimpleList</span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div id="numbers-of-blocks" class="section level2">
<h2 class="hasAnchor">
<a href="#numbers-of-blocks" class="anchor"></a>Numbers of blocks</h2>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bp_summary</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span>
    gbs     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">gbs</span>, <span class="va">length</span><span class="op">)</span>,
    unal    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">unal</span>, <span class="va">length</span><span class="op">)</span>,
    coa     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">coa</span>, <span class="va">length</span><span class="op">)</span>,
    unmap   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">unmap</span>, <span class="va">length</span><span class="op">)</span>,
    unmap2  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">unmap2</span>, <span class="va">length</span><span class="op">)</span>,
    unalMap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">unalMap</span>, <span class="va">length</span><span class="op">)</span>,
    tra     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">tra</span>, <span class="va">length</span><span class="op">)</span>,
    tra2    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">tra2</span>, <span class="va">length</span><span class="op">)</span>,
    coa2    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">coa2</span>, <span class="va">length</span><span class="op">)</span>
  <span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">bp_summary</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html">tapply</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">bp_summary</span><span class="op">)</span> |&gt; <span class="fu">OikScrambling</span><span class="fu">:::</span><span class="fu"><a href="../reference/compDistance.html">compDistance</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">mean</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##                               gbs     unal      coa    unmap   unmap2   unalMap
## North \342\200\223 North 24623.75 24125.25 4394.500 4333.000 3630.250 20229.250
## Oki \342\200\223 North   31309.00 31115.50 8718.625 8700.875 8033.875 22590.375
## same_pop                 15177.00 12652.67 5520.667 4465.333 2446.333  9656.333
##                              tra     tra2     coa2
## North \342\200\223 North  469.50 227.7500 3670.750
## Oki \342\200\223 North    510.25 287.8750 8046.500
## same_pop                 1297.00 342.6667 2733.333</code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">bp_summary</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html">tapply</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">bp_summary</span><span class="op">)</span> |&gt; <span class="fu">OikScrambling</span><span class="fu">:::</span><span class="fu"><a href="../reference/compDistance.html">compDistance</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">median</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##                            gbs    unal  coa  unmap unmap2 unalMap    tra  tra2
## North \342\200\223 North 24607 24103.5 4139 4081.5 3369.0 20434.5  458.5 202.5
## Oki \342\200\223 North   31252 31041.5 8806 8785.0 8090.5 22446.0  501.5 285.5
## same_pop                 15184 12425.0 5424 4119.0 2042.0  9662.0 1279.0 268.0
##                            coa2
## North \342\200\223 North 3412.5
## Oki \342\200\223 North   8105.0
## same_pop                 2256.0</code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">bp_summary</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html">tapply</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">bp_summary</span><span class="op">)</span> |&gt; <span class="fu">OikScrambling</span><span class="fu">:::</span><span class="fu"><a href="../reference/compDistance.html">compDistance</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">sd</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##                                gbs     unal      coa    unmap    unmap2
## North \342\200\223 North 194.88693 114.1034 557.8850 554.4445  549.0036
## Oki \342\200\223 North   772.56974 758.8316 168.7965 165.4478  164.1380
## same_pop                  87.70975 428.5491 624.6354 648.9687 1252.4457
##                           unalMap       tra      tra2      coa2
## North \342\200\223 North 663.3658  67.05470  76.04111  554.3689
## Oki \342\200\223 North   839.2139  32.67918  27.54444  166.2606
## same_pop                 657.5183 269.45129 138.07727 1409.0047</code></pre>
</div>
<div id="summary" class="section level2">
<h2 class="hasAnchor">
<a href="#summary" class="anchor"></a>Summary</h2>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>
  gbs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">gbs</span>, <span class="va">length</span><span class="op">)</span>,
  coa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">coa</span>, <span class="va">length</span><span class="op">)</span>,
  coa2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">coa2</span>, <span class="va">length</span><span class="op">)</span>
<span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> |&gt;
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span>gbs <span class="op">=</span> <span class="va">gbs</span> <span class="op">-</span> <span class="va">coa</span> <span class="op">-</span> <span class="va">coa2</span>, coa <span class="op">=</span> <span class="va">coa</span> <span class="op">-</span> <span class="va">coa2</span><span class="op">)</span>

<span class="va">df</span><span class="op">$</span><span class="va">pair</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span> |&gt; <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="op">!</span><span class="va">pair</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">pair</span>, <span class="va">value</span>, fill <span class="op">=</span> <span class="va">name</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span> stat <span class="op">=</span> <span class="st">"identity"</span> <span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Cumulative plot (gbs ⊃ coa ⊃ coa2) of the computed genomic regions"</span><span class="op">)</span></code></pre></div>
<p><img src="LoadGenomicBreaks_files/figure-html/summary-1.png" width="700"></p>
</div>
</div>
<div id="save-data" class="section level1">
<h1 class="hasAnchor">
<a href="#save-data" class="anchor"></a>Save data</h1>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span><span class="op">(</span><span class="va">gbs</span>, <span class="va">unal</span>, <span class="va">coa</span>, <span class="va">unmap</span>, <span class="va">unalMap</span>, <span class="va">tra</span>, <span class="va">tra2</span>, <span class="va">coa2</span>, <span class="va">unmap2</span>, <span class="va">longShort</span>, file <span class="op">=</span> <span class="st">"BreakPoints.Rdata"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/system.html">system</a></span><span class="op">(</span><span class="st">"echo '9f273f099ecbfa44899b6c343d1382f1  BreakPoints.Rdata' | md5sum -c"</span>, intern <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning in system("echo '9f273f099ecbfa44899b6c343d1382f1 BreakPoints.Rdata'
## | md5sum -c", : running command 'echo '9f273f099ecbfa44899b6c343d1382f1
## BreakPoints.Rdata' | md5sum -c' had status 1</code></pre>
<pre><code>## [1] "BreakPoints.Rdata: FAILED"
## attr(,"status")
## [1] 1</code></pre>
</div>
<div id="session-information" class="section level1">
<h1 class="hasAnchor">
<a href="#session-information" class="anchor"></a>Session information</h1>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## R version 4.1.1 (2021-08-10)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Debian GNU/Linux bookworm/sid
## 
## Matrix products: default
## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0
## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0
## 
## locale:
## [1] C
## 
## attached base packages:
## [1] parallel  stats4    stats     graphics  grDevices utils     datasets 
## [8] methods   base     
## 
## other attached packages:
##  [1] BSgenome.Odioica.local.Odioica.reference.v3.0_1.0.1
##  [2] BSgenome.Odioica.local.AOM.5_1.0.0                 
##  [3] BSgenome.Odioica.local.KUM.M3_1.0.0                
##  [4] BSgenome.Odioica.local.Bar2.p4_1.0.0               
##  [5] BSgenome.Odioica.local.OSKA2016v1.9_1.0.0          
##  [6] BSgenome.Odioica.local.OKI2018.I69_1.0.0           
##  [7] BSgenome_1.60.0                                    
##  [8] rtracklayer_1.52.1                                 
##  [9] Biostrings_2.60.2                                  
## [10] XVector_0.32.0                                     
## [11] BreakpointsData_3.5.0                              
## [12] ggplot2_3.3.5                                      
## [13] GenomicBreaks_0.10.0                               
## [14] GenomicRanges_1.44.0                               
## [15] GenomeInfoDb_1.28.4                                
## [16] IRanges_2.26.0                                     
## [17] S4Vectors_0.30.2                                   
## [18] BiocGenerics_0.38.0                                
## 
## loaded via a namespace (and not attached):
##   [1] backports_1.3.0             Hmisc_4.6-0                
##   [3] BiocFileCache_2.0.0         systemfonts_1.0.3          
##   [5] plyr_1.8.6                  splines_4.1.1              
##   [7] BiocParallel_1.26.2         digest_0.6.28              
##   [9] htmltools_0.5.2             tiff_0.1-10                
##  [11] GO.db_3.13.0                gdata_2.18.0               
##  [13] fansi_0.5.0                 magrittr_2.0.1             
##  [15] checkmate_2.0.0             memoise_2.0.0              
##  [17] cluster_2.1.2               tzdb_0.2.0                 
##  [19] readr_2.1.0                 annotate_1.72.0            
##  [21] matrixStats_0.61.0          R.utils_2.11.0             
##  [23] pkgdown_1.6.1               prettyunits_1.1.1          
##  [25] jpeg_0.1-9                  colorspace_2.0-2           
##  [27] rappdirs_0.3.3              blob_1.2.2                 
##  [29] textshaping_0.3.6           xfun_0.28                  
##  [31] dplyr_1.0.7                 crayon_1.4.2               
##  [33] RCurl_1.98-1.5              lme4_1.1-27.1              
##  [35] survival_3.2-13             glue_1.5.0                 
##  [37] gtable_0.3.0                zlibbioc_1.38.0            
##  [39] DelayedArray_0.18.0         weights_1.0.4              
##  [41] abind_1.4-5                 scales_1.1.1               
##  [43] DBI_1.1.1                   Rcpp_1.0.7                 
##  [45] plotrix_3.8-2               progress_1.2.2             
##  [47] genoPlotR_0.8.11            xtable_1.8-4               
##  [49] htmlTable_2.3.0             foreign_0.8-81             
##  [51] bit_4.0.4                   Formula_1.2-4              
##  [53] htmlwidgets_1.5.4           httr_1.4.2                 
##  [55] RColorBrewer_1.1-2          ellipsis_0.3.2             
##  [57] mice_3.13.0                 farver_2.1.0               
##  [59] pkgconfig_2.0.3             XML_3.99-0.8               
##  [61] R.methodsS3_1.8.1           dbplyr_2.1.1               
##  [63] nnet_7.3-16                 locfit_1.5-9.4             
##  [65] utf8_1.2.2                  labeling_0.4.2             
##  [67] tidyselect_1.1.1            rlang_0.4.12               
##  [69] reshape2_1.4.4              AnnotationDbi_1.56.1       
##  [71] munsell_0.5.0               tools_4.1.1                
##  [73] cachem_1.0.6                generics_0.1.1             
##  [75] RSQLite_2.2.8               ade4_1.7-18                
##  [77] broom_0.7.10                evaluate_0.14              
##  [79] stringr_1.4.0               OikScrambling_0.3.0        
##  [81] fastmap_1.1.0               fftwtools_0.9-11           
##  [83] yaml_2.2.1                  ragg_1.1.3                 
##  [85] knitr_1.36                  bit64_4.0.5                
##  [87] fs_1.5.0                    purrr_0.3.4                
##  [89] heatmaps_1.16.0             KEGGREST_1.34.0            
##  [91] nlme_3.1-153                R.oo_1.24.0                
##  [93] poweRlaw_0.70.6             xml2_1.3.2                 
##  [95] pracma_2.3.3                biomaRt_2.48.3             
##  [97] compiler_4.1.1              rstudioapi_0.13            
##  [99] filelock_1.0.2              curl_4.3.2                 
## [101] png_0.1-7                   tibble_3.1.6               
## [103] stringi_1.7.5               highr_0.9                  
## [105] GenomicFeatures_1.44.2      desc_1.4.0                 
## [107] lattice_0.20-45             CNEr_1.28.0                
## [109] Matrix_1.3-4                nloptr_1.2.2.3             
## [111] vctrs_0.3.8                 pillar_1.6.4               
## [113] lifecycle_1.0.1             data.table_1.14.2          
## [115] bitops_1.0-7                R6_2.5.1                   
## [117] BiocIO_1.2.0                latticeExtra_0.6-29        
## [119] KernSmooth_2.23-20          gridExtra_2.3              
## [121] codetools_0.2-18            boot_1.3-28                
## [123] MASS_7.3-54                 gtools_3.9.2               
## [125] assertthat_0.2.1            SummarizedExperiment_1.22.0
## [127] rprojroot_2.0.2             rjson_0.2.20               
## [129] withr_2.4.2                 GenomicAlignments_1.28.0   
## [131] Rsamtools_2.8.0             GenomeInfoDbData_1.2.6     
## [133] hms_1.1.1                   EBImage_4.34.0             
## [135] grid_4.1.1                  rpart_4.1-15               
## [137] tidyr_1.1.4                 minqa_1.2.4                
## [139] rmarkdown_2.11              MatrixGenerics_1.4.3       
## [141] Biobase_2.52.0              base64enc_0.1-3            
## [143] restfulr_0.0.13</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Charles Plessy.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
