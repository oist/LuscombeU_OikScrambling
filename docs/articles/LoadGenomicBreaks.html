<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Load genomic break data • OikScrambling</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Load genomic break data">
<meta property="og:description" content="OikScrambling">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">OikScrambling</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.8.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/OikScrambling.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/CNEs.html">Conserved non-coding elements</a>
    </li>
    <li>
      <a href="../articles/CoalescingCutoffs.html">Modifying coalescent cutoffs</a>
    </li>
    <li>
      <a href="../articles/ColinearityInterruptors.html">Regions interrupting colinearity</a>
    </li>
    <li>
      <a href="../articles/DistanceMeasures.html">Distance Measures</a>
    </li>
    <li>
      <a href="../articles/GenomicFeatures.html">Genomic features of the breakpoints</a>
    </li>
    <li>
      <a href="../articles/Inversions.html">Inversions</a>
    </li>
    <li>
      <a href="../articles/LoadGenomicBreaks.html">Load genomic break data</a>
    </li>
    <li>
      <a href="../articles/OrthogroupSyntenies.html">Orthogroup syntenies</a>
    </li>
    <li>
      <a href="../articles/OxfordPlots.html">Whole-genome dot-plots</a>
    </li>
    <li>
      <a href="../articles/PWM.html">Motif finding and analysis</a>
    </li>
    <li>
      <a href="../articles/ParallelPlots.html">Whole-chromosome parallel plots</a>
    </li>
    <li>
      <a href="../articles/RegionWidths.html">Width of the aligned and mapped regions.</a>
    </li>
    <li>
      <a href="../articles/RegionsOfInterest.html">Regions interrupting colinearity</a>
    </li>
    <li>
      <a href="../articles/RepeatRegions.html">Repeat regions</a>
    </li>
    <li>
      <a href="../articles/SegmentMovements.html">Segment movement distances</a>
    </li>
    <li>
      <a href="../articles/TFBS.html">Transcription factor binding sites</a>
    </li>
    <li>
      <a href="../articles/Translocations.html">Translocations</a>
    </li>
    <li>
      <a href="../articles/test.html">Regions interrupting colinearity</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/oist/LuscombeU_OikScrambling/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="LoadGenomicBreaks_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Load genomic break data</h1>
                        <h4 data-toc-skip class="author">Charles Plessy</h4>
            
            <h4 data-toc-skip class="date">09 February, 2022</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/oist/LuscombeU_OikScrambling/blob/HEAD/vignettes/LoadGenomicBreaks.Rmd" class="external-link"><code>vignettes/LoadGenomicBreaks.Rmd</code></a></small>
      <div class="hidden name"><code>LoadGenomicBreaks.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_knit.html" class="external-link">opts_knit</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>verbose <span class="op">=</span> <span class="cn">TRUE</span>, cache <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="section level1">
<h1 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h1>
<p>This vignette loads the genomic breaks data, consolidates colinear regions, extracts unaligned and unmapped regions, transfers annotation data and saves the resulting objects in a serialised R object (<code>RData</code> file) for reuse in other vignettes.</p>
<p>Related objects are stored in lists to avoid cluttering the environment.</p>
</div>
<div class="section level1">
<h1 id="packages-and-data">Packages and data<a class="anchor" aria-label="anchor" href="#packages-and-data"></a>
</h1>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">{</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://oist.github.io/GenomicBreaks" class="external-link">'GenomicBreaks'</a></span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">'ggplot2'</a></span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"BreakpointsData"</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span>
<span class="op">(</span><span class="va">genomes</span> <span class="op">&lt;-</span> <span class="fu">OikScrambling</span><span class="fu">:::</span><span class="fu"><a href="../reference/loadAllGenomes.html">loadAllGenomes</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Loading required package: BSgenome</span></code></pre>
<pre><code><span class="co">## Loading required package: Biostrings</span></code></pre>
<pre><code><span class="co">## Loading required package: XVector</span></code></pre>
<pre><code><span class="co">## </span>
<span class="co">## Attaching package: 'Biostrings'</span></code></pre>
<pre><code><span class="co">## The following object is masked from 'package:base':</span>
<span class="co">## </span>
<span class="co">##     strsplit</span></code></pre>
<pre><code><span class="co">## Loading required package: rtracklayer</span></code></pre>
<pre><code><span class="co">## List of length 6</span>
<span class="co">## names(6): Oki Osa Bar Kum Aom Nor</span></code></pre>
</div>
<div class="section level1">
<h1 id="genomic-breaks">Genomic breaks<a class="anchor" aria-label="anchor" href="#genomic-breaks"></a>
</h1>
<div class="section level2">
<h2 id="longshort-arm-information">Long/short arm information<a class="anchor" aria-label="anchor" href="#longshort-arm-information"></a>
</h2>
<p>Short / long arm annotation will be done by the <code><a href="https://oist.github.io/GenomicBreaks/reference/flagLongShort.html" class="external-link">GenomicBreaks::flagLongShort()</a></code> function.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">loadLongShort</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">file</span>, <span class="va">genome</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"extdata/Annotations/"</span>, <span class="va">file</span><span class="op">)</span>, package <span class="op">=</span> <span class="st">"BreakpointsData"</span><span class="op">)</span>
  <span class="va">gr</span> <span class="op">&lt;-</span> <span class="fu">rtracklayer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rtracklayer/man/GFFFile-class.html" class="external-link">import.gff3</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span>
  <span class="va">gr</span><span class="op">$</span><span class="va">source</span> <span class="op">&lt;-</span> <span class="va">gr</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="va">gr</span><span class="op">$</span><span class="va">score</span> <span class="op">&lt;-</span> <span class="va">gr</span><span class="op">$</span><span class="va">phase</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
  <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/GRanges-class.html" class="external-link">GRanges</a></span><span class="op">(</span><span class="va">gr</span>, seqinfo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomeInfoDb/man/seqinfo.html" class="external-link">seqinfo</a></span><span class="op">(</span><span class="va">genome</span><span class="op">)</span>, strand <span class="op">=</span> <span class="st">"*"</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">longShort</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/SimpleList-class.html" class="external-link">SimpleList</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">longShort</span><span class="op">$</span><span class="va">Oki</span> <span class="op">&lt;-</span> <span class="fu">loadLongShort</span><span class="op">(</span><span class="st">"OKI2018_I69.v2/OKI2018_I69.arms.gff3"</span>, <span class="va">OKI2018_I69</span><span class="op">)</span>
<span class="va">longShort</span><span class="op">$</span><span class="va">Osa</span> <span class="op">&lt;-</span> <span class="fu">loadLongShort</span><span class="op">(</span><span class="st">"OSKA2016v1.9/OSKA2016v1.9.arms.gff3"</span>, <span class="va">OSKA2016v1.9</span><span class="op">)</span>
<span class="va">longShort</span><span class="op">$</span><span class="va">Bar</span> <span class="op">&lt;-</span> <span class="fu">loadLongShort</span><span class="op">(</span><span class="st">"Bar2_p4.Flye/Bar2_p4.Flye.arms.gff3"</span>, <span class="va">Bar2_p4</span><span class="op">)</span>

<span class="va">longShort</span></code></pre></div>
<pre><code><span class="co">## List of length 3</span>
<span class="co">## names(3): Oki Osa Bar</span></code></pre>
</div>
<div class="section level2">
<h2 id="repeat-regions">Repeat regions<a class="anchor" aria-label="anchor" href="#repeat-regions"></a>
</h2>
<p>Load from <code>BreakpointsData</code> package via <code>OikScrambling:::loadAllRepeats()</code></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">reps</span> <span class="op">&lt;-</span> <span class="fu">OikScrambling</span><span class="fu">:::</span><span class="fu"><a href="../reference/loadAllRepeats.html">loadAllRepeats</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## List of length 6</span>
<span class="co">## names(6): Oki Osa Bar Kum Aom Nor</span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">annotateWithReps.GRanges</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">gr</span>, <span class="va">rep</span><span class="op">)</span> <span class="op">{</span>
  <span class="co"># Inspired from CAGEr:::ranges2names</span>
  <span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/findOverlaps-methods.html" class="external-link">findOverlaps</a></span><span class="op">(</span><span class="va">gr</span>, <span class="va">rep</span>, ignore.strand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
  <span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/as.html" class="external-link">as</a></span><span class="op">(</span><span class="va">o</span>, <span class="st">"List"</span><span class="op">)</span>
  <span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/extractList.html" class="external-link">extractList</a></span><span class="op">(</span><span class="va">rep</span><span class="op">$</span><span class="va">Class</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">o</span><span class="op">)</span>
  <span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/List-utils.html" class="external-link">endoapply</a></span><span class="op">(</span><span class="va">o</span>, <span class="va">unique</span><span class="op">)</span>
  <span class="va">o</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">o</span>, <span class="va">length</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span>
  <span class="va">gr</span><span class="op">$</span><span class="va">rep</span> <span class="op">&lt;-</span> <span class="va">o</span>
  <span class="va">gr</span>
<span class="op">}</span>

<span class="va">overlapLength.GRanges</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">gr</span>, <span class="va">rep</span><span class="op">)</span> <span class="op">{</span>
  <span class="co"># Inspired from CAGEr:::ranges2names</span>
  <span class="va">redRep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/inter-range-methods.html" class="external-link">reduce</a></span><span class="op">(</span><span class="va">rep</span><span class="op">)</span>
  <span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/findOverlaps-methods.html" class="external-link">findOverlaps</a></span><span class="op">(</span><span class="va">gr</span>, <span class="va">redRep</span>, ignore.strand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
  <span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/as.html" class="external-link">as</a></span><span class="op">(</span><span class="va">o</span>, <span class="st">"List"</span><span class="op">)</span>
  <span class="va">repGrl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/extractList.html" class="external-link">extractList</a></span><span class="op">(</span><span class="va">redRep</span>, <span class="va">o</span><span class="op">)</span>
  <span class="va">gr</span><span class="op">$</span><span class="va">repOvlp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/setops-methods.html" class="external-link">pintersect</a></span><span class="op">(</span><span class="va">gr</span>, <span class="va">repGrl</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/start.html" class="external-link">width</a></span><span class="op">(</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">)</span>
  <span class="va">gr</span>
<span class="op">}</span>

<span class="va">annotateWithReps.GBreaks</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">gb</span>, <span class="va">repT</span>, <span class="va">repQ</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">gb</span><span class="op">$</span><span class="va">query</span> <span class="op">&lt;-</span> <span class="fu">annotateWithReps.GRanges</span><span class="op">(</span><span class="va">gb</span><span class="op">$</span><span class="va">query</span>, <span class="va">repQ</span><span class="op">)</span>
  <span class="va">gb</span>       <span class="op">&lt;-</span> <span class="fu">annotateWithReps.GRanges</span><span class="op">(</span><span class="va">gb</span>,       <span class="va">repT</span><span class="op">)</span>
  <span class="va">gb</span><span class="op">$</span><span class="va">query</span> <span class="op">&lt;-</span> <span class="fu">overlapLength.GRanges</span>   <span class="op">(</span><span class="va">gb</span><span class="op">$</span><span class="va">query</span>, <span class="va">repQ</span><span class="op">)</span>
  <span class="va">gb</span>       <span class="op">&lt;-</span> <span class="fu">overlapLength.GRanges</span>   <span class="op">(</span><span class="va">gb</span>,       <span class="va">repT</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">annotateWithReps.GBreaksSimpleList</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">gbl</span>, <span class="va">reps</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">gbl</span><span class="op">$</span><span class="va">Oki_Osa</span> <span class="op">&lt;-</span> <span class="va">gbl</span><span class="op">$</span><span class="va">Oki_Osa</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Oki</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
  <span class="va">gbl</span><span class="op">$</span><span class="va">Oki_Bar</span> <span class="op">&lt;-</span> <span class="va">gbl</span><span class="op">$</span><span class="va">Oki_Bar</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Oki</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span>
  <span class="va">gbl</span><span class="op">$</span><span class="va">Oki_Kum</span> <span class="op">&lt;-</span> <span class="va">gbl</span><span class="op">$</span><span class="va">Oki_Kum</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Oki</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Kum</span><span class="op">)</span>
  <span class="va">gbl</span><span class="op">$</span><span class="va">Oki_Aom</span> <span class="op">&lt;-</span> <span class="va">gbl</span><span class="op">$</span><span class="va">Oki_Aom</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Oki</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Aom</span><span class="op">)</span>
  <span class="va">gbl</span><span class="op">$</span><span class="va">Oki_Nor</span> <span class="op">&lt;-</span> <span class="va">gbl</span><span class="op">$</span><span class="va">Oki_Nor</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Oki</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Nor</span><span class="op">)</span>
  
  <span class="va">gbl</span><span class="op">$</span><span class="va">Osa_Oki</span> <span class="op">&lt;-</span> <span class="va">gbl</span><span class="op">$</span><span class="va">Osa_Oki</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Osa</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
  <span class="va">gbl</span><span class="op">$</span><span class="va">Osa_Bar</span> <span class="op">&lt;-</span> <span class="va">gbl</span><span class="op">$</span><span class="va">Osa_Bar</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Osa</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span>
  <span class="va">gbl</span><span class="op">$</span><span class="va">Osa_Kum</span> <span class="op">&lt;-</span> <span class="va">gbl</span><span class="op">$</span><span class="va">Osa_Kum</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Osa</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Kum</span><span class="op">)</span>
  <span class="va">gbl</span><span class="op">$</span><span class="va">Osa_Aom</span> <span class="op">&lt;-</span> <span class="va">gbl</span><span class="op">$</span><span class="va">Osa_Aom</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Osa</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Aom</span><span class="op">)</span>
  <span class="va">gbl</span><span class="op">$</span><span class="va">Osa_Nor</span> <span class="op">&lt;-</span> <span class="va">gbl</span><span class="op">$</span><span class="va">Osa_Nor</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Osa</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Nor</span><span class="op">)</span>
  
  <span class="va">gbl</span><span class="op">$</span><span class="va">Bar_Oki</span> <span class="op">&lt;-</span> <span class="va">gbl</span><span class="op">$</span><span class="va">Bar_Oki</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Bar</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
  <span class="va">gbl</span><span class="op">$</span><span class="va">Bar_Osa</span> <span class="op">&lt;-</span> <span class="va">gbl</span><span class="op">$</span><span class="va">Bar_Osa</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Bar</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
  <span class="va">gbl</span><span class="op">$</span><span class="va">Bar_Kum</span> <span class="op">&lt;-</span> <span class="va">gbl</span><span class="op">$</span><span class="va">Bar_Kum</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Bar</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Kum</span><span class="op">)</span>
  <span class="va">gbl</span><span class="op">$</span><span class="va">Bar_Aom</span> <span class="op">&lt;-</span> <span class="va">gbl</span><span class="op">$</span><span class="va">Bar_Aom</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Bar</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Aom</span><span class="op">)</span>
  <span class="va">gbl</span><span class="op">$</span><span class="va">Bar_Nor</span> <span class="op">&lt;-</span> <span class="va">gbl</span><span class="op">$</span><span class="va">Bar_Nor</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Bar</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Nor</span><span class="op">)</span>
  <span class="va">gbl</span>
<span class="op">}</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="transcript-annotations">Transcript annotations<a class="anchor" aria-label="anchor" href="#transcript-annotations"></a>
</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">transcripts</span> <span class="op">&lt;-</span> <span class="fu">OikScrambling</span><span class="fu">:::</span><span class="fu"><a href="../reference/loadAllTranscriptsGR.html">loadAllTranscriptsGR</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## List of length 8</span>
<span class="co">## names(8): Oki Osa Bar Kum Aom Nor Ply Ros</span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">annotateWithTranscripts</span> <span class="op">&lt;-</span>  <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">annotT</span>, <span class="va">annotQ</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/UseMethod.html" class="external-link">UseMethod</a></span><span class="op">(</span><span class="st">"annotateWithTranscripts"</span><span class="op">)</span>

<span class="va">annotateWithTranscripts.GRanges</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">annotT</span>, <span class="va">annotQ</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span>
  <span class="co"># Taken from CAGEr (and I am the author)</span>
  <span class="va">ranges2names</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">rangesA</span>, <span class="va">rangesB</span><span class="op">)</span> <span class="op">{</span>
    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">rangesB</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> 
        <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sQuote.html" class="external-link">sQuote</a></span><span class="op">(</span><span class="st">"rangesB"</span><span class="op">)</span>, <span class="st">" must contain have names."</span><span class="op">)</span>
    <span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GenomicRanges/man/findOverlaps-methods.html" class="external-link">findOverlaps</a></span><span class="op">(</span><span class="va">rangesA</span>, <span class="va">rangesB</span><span class="op">)</span>
    <span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/as.html" class="external-link">as</a></span><span class="op">(</span><span class="va">names</span>, <span class="st">"List"</span><span class="op">)</span>
    <span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/IRanges/man/extractList.html" class="external-link">extractList</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">rangesB</span><span class="op">)</span>, <span class="va">names</span><span class="op">)</span>
    <span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span>
    <span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/character-utils.html" class="external-link">unstrsplit</a></span><span class="op">(</span><span class="va">names</span>, <span class="st">";"</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Rle-class.html" class="external-link">Rle</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="va">x</span><span class="op">$</span><span class="va">transcripts</span> <span class="op">&lt;-</span> <span class="fu">ranges2names</span><span class="op">(</span><span class="va">x</span>, <span class="va">annotT</span><span class="op">)</span>
  <span class="va">x</span><span class="op">$</span><span class="va">transcripts</span><span class="op">[</span><span class="va">x</span><span class="op">$</span><span class="va">transcripts</span> <span class="op">==</span> <span class="st">''</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span>
  <span class="va">x</span>
<span class="op">}</span>

<span class="va">annotateWithTranscripts.GBreaks</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">annotT</span>, <span class="va">annotQ</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">x</span><span class="op">$</span><span class="va">query</span> <span class="op">&lt;-</span> <span class="fu">annotateWithTranscripts.GRanges</span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">query</span>, <span class="va">annotQ</span><span class="op">)</span>
  <span class="va">x</span>       <span class="op">&lt;-</span> <span class="fu">annotateWithTranscripts.GRanges</span><span class="op">(</span><span class="va">x</span>,       <span class="va">annotT</span><span class="op">)</span>
  <span class="va">x</span>
<span class="op">}</span>

<span class="va">annotateWithTranscripts.GRangesList</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">annotT</span>, <span class="va">annotQ</span> <span class="op">=</span> <span class="va">annotT</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">x</span><span class="op">$</span><span class="va">Oki_Osa</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">Oki_Osa</span> |&gt; <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">annotT</span><span class="op">$</span><span class="va">Oki</span>, <span class="va">annotQ</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
  <span class="va">x</span><span class="op">$</span><span class="va">Oki_Bar</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">Oki_Bar</span> |&gt; <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">annotT</span><span class="op">$</span><span class="va">Oki</span>, <span class="va">annotQ</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span>
  <span class="va">x</span><span class="op">$</span><span class="va">Oki_Kum</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">Oki_Kum</span> |&gt; <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">annotT</span><span class="op">$</span><span class="va">Oki</span>, <span class="va">annotQ</span><span class="op">$</span><span class="va">Kum</span><span class="op">)</span>
  <span class="va">x</span><span class="op">$</span><span class="va">Oki_Aom</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">Oki_Aom</span> |&gt; <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">annotT</span><span class="op">$</span><span class="va">Oki</span>, <span class="va">annotQ</span><span class="op">$</span><span class="va">Aom</span><span class="op">)</span>
  <span class="va">x</span><span class="op">$</span><span class="va">Oki_Nor</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">Oki_Nor</span> |&gt; <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">annotT</span><span class="op">$</span><span class="va">Oki</span>, <span class="va">annotQ</span><span class="op">$</span><span class="va">Nor</span><span class="op">)</span>
  
  <span class="va">x</span><span class="op">$</span><span class="va">Osa_Oki</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">Osa_Oki</span> |&gt; <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">annotT</span><span class="op">$</span><span class="va">Osa</span>, <span class="va">annotQ</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
  <span class="va">x</span><span class="op">$</span><span class="va">Osa_Bar</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">Osa_Bar</span> |&gt; <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">annotT</span><span class="op">$</span><span class="va">Osa</span>, <span class="va">annotQ</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span>
  <span class="va">x</span><span class="op">$</span><span class="va">Osa_Kum</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">Osa_Kum</span> |&gt; <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">annotT</span><span class="op">$</span><span class="va">Osa</span>, <span class="va">annotQ</span><span class="op">$</span><span class="va">Kum</span><span class="op">)</span>
  <span class="va">x</span><span class="op">$</span><span class="va">Osa_Aom</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">Osa_Aom</span> |&gt; <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">annotT</span><span class="op">$</span><span class="va">Osa</span>, <span class="va">annotQ</span><span class="op">$</span><span class="va">Aom</span><span class="op">)</span>
  <span class="va">x</span><span class="op">$</span><span class="va">Osa_Nor</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">Osa_Nor</span> |&gt; <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">annotT</span><span class="op">$</span><span class="va">Osa</span>, <span class="va">annotQ</span><span class="op">$</span><span class="va">Nor</span><span class="op">)</span>
  
  <span class="va">x</span><span class="op">$</span><span class="va">Bar_Oki</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">Bar_Oki</span> |&gt; <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">annotT</span><span class="op">$</span><span class="va">Bar</span>, <span class="va">annotQ</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
  <span class="va">x</span><span class="op">$</span><span class="va">Bar_Osa</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">Bar_Osa</span> |&gt; <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">annotT</span><span class="op">$</span><span class="va">Bar</span>, <span class="va">annotQ</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
  <span class="va">x</span><span class="op">$</span><span class="va">Bar_Kum</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">Bar_Kum</span> |&gt; <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">annotT</span><span class="op">$</span><span class="va">Bar</span>, <span class="va">annotQ</span><span class="op">$</span><span class="va">Kum</span><span class="op">)</span>
  <span class="va">x</span><span class="op">$</span><span class="va">Bar_Aom</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">Bar_Aom</span> |&gt; <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">annotT</span><span class="op">$</span><span class="va">Bar</span>, <span class="va">annotQ</span><span class="op">$</span><span class="va">Aom</span><span class="op">)</span>
  <span class="va">x</span><span class="op">$</span><span class="va">Bar_Nor</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">Bar_Nor</span> |&gt; <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">annotT</span><span class="op">$</span><span class="va">Bar</span>, <span class="va">annotQ</span><span class="op">$</span><span class="va">Nor</span><span class="op">)</span>
  <span class="va">x</span>
<span class="op">}</span>

<span class="va">annotateWithTranscripts.SimpleList</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">annotT</span>, <span class="va">annotQ</span> <span class="op">=</span> <span class="va">annotT</span><span class="op">)</span>
  <span class="fu">annotateWithTranscripts.GRangesList</span><span class="op">(</span><span class="va">x</span>, annotT <span class="op">=</span> <span class="va">annotT</span>, annotQ <span class="op">=</span> <span class="va">annotQ</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="mapped-alignments">Mapped alignments<a class="anchor" aria-label="anchor" href="#mapped-alignments"></a>
</h2>
<p>Let’s load data from genome alignments, using the copy distributed in the <code>BreakpointsData</code> package.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Local function to add extra annotation on long/short arms while loading data</span>
<span class="va">load_genomic_breaks_</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">file</span>, <span class="va">genomeT</span>, <span class="va">genomeQ</span>, <span class="va">longShort</span><span class="op">=</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"extdata/Oidioi_pairwise_v3/"</span>, <span class="va">file</span><span class="op">)</span>, package <span class="op">=</span> <span class="st">"BreakpointsData"</span><span class="op">)</span>
  <span class="va">gb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/load_genomic_breaks.html" class="external-link">load_genomic_breaks</a></span><span class="op">(</span><span class="va">file</span>, <span class="va">genomeT</span>,  <span class="va">genomeQ</span><span class="op">)</span>
  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span> <span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">longShort</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">gb</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/flagLongShort.html" class="external-link">flagLongShort</a></span><span class="op">(</span><span class="va">gb</span>, <span class="va">longShort</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="va">gb</span>
<span class="op">}</span>

<span class="va">gbs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/SimpleList-class.html" class="external-link">SimpleList</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">gbs</span><span class="op">$</span><span class="va">Oki_Osa</span> <span class="op">&lt;-</span> <span class="fu">load_genomic_breaks_</span><span class="op">(</span><span class="st">"OKI2018_I69_1.0__OSKA2016v1.9.gff.gz"</span>, <span class="va">OKI2018_I69</span>,  <span class="va">OSKA2016v1.9</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Oki</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
<span class="va">gbs</span><span class="op">$</span><span class="va">Oki_Bar</span> <span class="op">&lt;-</span> <span class="fu">load_genomic_breaks_</span><span class="op">(</span><span class="st">"OKI2018_I69_1.0__Bar2_p4.gff.gz"</span>,      <span class="va">OKI2018_I69</span>,  <span class="va">Bar2_p4</span>,      <span class="va">longShort</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Oki</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span>
<span class="va">gbs</span><span class="op">$</span><span class="va">Oki_Kum</span> <span class="op">&lt;-</span> <span class="fu">load_genomic_breaks_</span><span class="op">(</span><span class="st">"OKI2018_I69_1.0__KUM-M3-7f.gff.gz"</span>,    <span class="va">OKI2018_I69</span>,  <span class="va">KUM_M3</span>,       <span class="va">longShort</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Oki</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Kum</span><span class="op">)</span>
<span class="va">gbs</span><span class="op">$</span><span class="va">Oki_Aom</span> <span class="op">&lt;-</span> <span class="fu">load_genomic_breaks_</span><span class="op">(</span><span class="st">"OKI2018_I69_1.0__AOM-5-5f.gff.gz"</span>,     <span class="va">OKI2018_I69</span>,  <span class="va">AOM_5</span>,        <span class="va">longShort</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Oki</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Aom</span><span class="op">)</span>
<span class="va">gbs</span><span class="op">$</span><span class="va">Oki_Nor</span> <span class="op">&lt;-</span> <span class="fu">load_genomic_breaks_</span><span class="op">(</span><span class="st">"OKI2018_I69_1.0__OdB3.gff.gz"</span>,         <span class="va">OKI2018_I69</span>,  <span class="va">OdB3</span>,         <span class="va">longShort</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Oki</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Nor</span><span class="op">)</span>

<span class="va">gbs</span><span class="op">$</span><span class="va">Osa_Oki</span> <span class="op">&lt;-</span> <span class="fu">load_genomic_breaks_</span><span class="op">(</span><span class="st">"OSKA2016v1.9__OKI2018_I69_1.0.gff.gz"</span>, <span class="va">OSKA2016v1.9</span>, <span class="va">OKI2018_I69</span>,  <span class="va">longShort</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Osa</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
<span class="va">gbs</span><span class="op">$</span><span class="va">Osa_Bar</span> <span class="op">&lt;-</span> <span class="fu">load_genomic_breaks_</span><span class="op">(</span><span class="st">"OSKA2016v1.9__Bar2_p4.gff.gz"</span>,         <span class="va">OSKA2016v1.9</span>, <span class="va">Bar2_p4</span>,      <span class="va">longShort</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Osa</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span>
<span class="va">gbs</span><span class="op">$</span><span class="va">Osa_Kum</span> <span class="op">&lt;-</span> <span class="fu">load_genomic_breaks_</span><span class="op">(</span><span class="st">"OSKA2016v1.9__KUM-M3-7f.gff.gz"</span>,       <span class="va">OSKA2016v1.9</span>, <span class="va">KUM_M3</span>,       <span class="va">longShort</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Osa</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Kum</span><span class="op">)</span>
<span class="va">gbs</span><span class="op">$</span><span class="va">Osa_Aom</span> <span class="op">&lt;-</span> <span class="fu">load_genomic_breaks_</span><span class="op">(</span><span class="st">"OSKA2016v1.9__AOM-5-5f.gff.gz"</span>,        <span class="va">OSKA2016v1.9</span>, <span class="va">AOM_5</span>,        <span class="va">longShort</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Osa</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Aom</span><span class="op">)</span>
<span class="va">gbs</span><span class="op">$</span><span class="va">Osa_Nor</span> <span class="op">&lt;-</span> <span class="fu">load_genomic_breaks_</span><span class="op">(</span><span class="st">"OSKA2016v1.9__OdB3.gff.gz"</span>,            <span class="va">OSKA2016v1.9</span>, <span class="va">OdB3</span>,         <span class="va">longShort</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Osa</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Nor</span><span class="op">)</span>

<span class="va">gbs</span><span class="op">$</span><span class="va">Bar_Oki</span> <span class="op">&lt;-</span> <span class="fu">load_genomic_breaks_</span><span class="op">(</span><span class="st">"Bar2_p4__OKI2018_I69_1.0.gff.gz"</span>,      <span class="va">Bar2_p4</span>,     <span class="va">OKI2018_I69</span>,   <span class="va">longShort</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Bar</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
<span class="va">gbs</span><span class="op">$</span><span class="va">Bar_Osa</span> <span class="op">&lt;-</span> <span class="fu">load_genomic_breaks_</span><span class="op">(</span><span class="st">"Bar2_p4__OSKA2016v1.9.gff.gz"</span>,         <span class="va">Bar2_p4</span>,     <span class="va">OSKA2016v1.9</span>,  <span class="va">longShort</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Bar</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
<span class="va">gbs</span><span class="op">$</span><span class="va">Bar_Kum</span> <span class="op">&lt;-</span> <span class="fu">load_genomic_breaks_</span><span class="op">(</span><span class="st">"Bar2_p4__KUM-M3-7f.gff.gz"</span>,            <span class="va">Bar2_p4</span>,     <span class="va">KUM_M3</span>,        <span class="va">longShort</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Bar</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Kum</span><span class="op">)</span>
<span class="va">gbs</span><span class="op">$</span><span class="va">Bar_Aom</span> <span class="op">&lt;-</span> <span class="fu">load_genomic_breaks_</span><span class="op">(</span><span class="st">"Bar2_p4__AOM-5-5f.gff.gz"</span>,             <span class="va">Bar2_p4</span>,     <span class="va">AOM_5</span>,         <span class="va">longShort</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Bar</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Aom</span><span class="op">)</span>
<span class="va">gbs</span><span class="op">$</span><span class="va">Bar_Nor</span> <span class="op">&lt;-</span> <span class="fu">load_genomic_breaks_</span><span class="op">(</span><span class="st">"Bar2_p4__OdB3.gff.gz"</span>,                 <span class="va">Bar2_p4</span>,     <span class="va">OdB3</span>,          <span class="va">longShort</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span> |&gt; <span class="fu">annotateWithReps.GBreaks</span><span class="op">(</span><span class="va">reps</span><span class="op">$</span><span class="va">Bar</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Nor</span><span class="op">)</span>

<span class="va">Oik_Oik</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">gbs</span><span class="op">)</span>

<span class="va">gbs</span><span class="op">$</span><span class="va">Ply_Ros</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/load_genomic_breaks.html" class="external-link">load_genomic_breaks</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/Ciona_pairwise_v3/C_int_P__C_int_R.gff.gz"</span>,          package <span class="op">=</span> <span class="st">"BreakpointsData"</span><span class="op">)</span>,    <span class="cn">NULL</span>,     <span class="cn">NULL</span><span class="op">)</span>
<span class="va">gbs</span><span class="op">$</span><span class="va">Ply_Rob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/load_genomic_breaks.html" class="external-link">load_genomic_breaks</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/Ciona_pairwise_v3/C_int_P__C_rob_HT.gff.gz"</span>,         package <span class="op">=</span> <span class="st">"BreakpointsData"</span><span class="op">)</span>,    <span class="cn">NULL</span>,     <span class="cn">NULL</span><span class="op">)</span>
<span class="va">gbs</span><span class="op">$</span><span class="va">Ply_Sav</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/load_genomic_breaks.html" class="external-link">load_genomic_breaks</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/Ciona_pairwise_v3/C_int_P__C_sav.gff.gz"</span>,            package <span class="op">=</span> <span class="st">"BreakpointsData"</span><span class="op">)</span>,    <span class="cn">NULL</span>,     <span class="cn">NULL</span><span class="op">)</span>
<span class="va">gbs</span><span class="op">$</span><span class="va">Ply_Oki</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/load_genomic_breaks.html" class="external-link">load_genomic_breaks</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/Ciona_pairwise_v3/C_int_P__OKI2018_I69_1.0.gff.gz"</span>,  package <span class="op">=</span> <span class="st">"BreakpointsData"</span><span class="op">)</span>,    <span class="cn">NULL</span>,     <span class="va">OKI2018_I69</span><span class="op">)</span>

<span class="va">gbs</span><span class="op">$</span><span class="va">Rob_Ros</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/load_genomic_breaks.html" class="external-link">load_genomic_breaks</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/Ciona_pairwise_v3/C_rob_HT__C_int_R.gff.gz"</span>,         package <span class="op">=</span> <span class="st">"BreakpointsData"</span><span class="op">)</span>,    <span class="cn">NULL</span>,     <span class="cn">NULL</span><span class="op">)</span>
<span class="va">gbs</span><span class="op">$</span><span class="va">Rob_Ply</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/load_genomic_breaks.html" class="external-link">load_genomic_breaks</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/Ciona_pairwise_v3/C_rob_HT__C_int_P.gff.gz"</span>,         package <span class="op">=</span> <span class="st">"BreakpointsData"</span><span class="op">)</span>,    <span class="cn">NULL</span>,     <span class="cn">NULL</span><span class="op">)</span>
<span class="va">gbs</span><span class="op">$</span><span class="va">Rob_Sav</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/load_genomic_breaks.html" class="external-link">load_genomic_breaks</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/Ciona_pairwise_v3/C_rob_HT__C_sav.gff.gz"</span>,           package <span class="op">=</span> <span class="st">"BreakpointsData"</span><span class="op">)</span>,    <span class="cn">NULL</span>,     <span class="cn">NULL</span><span class="op">)</span>
<span class="va">gbs</span><span class="op">$</span><span class="va">Rob_Oki</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/load_genomic_breaks.html" class="external-link">load_genomic_breaks</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/Ciona_pairwise_v3/C_rob_HT__OKI2018_I69_1.0.gff.gz"</span>, package <span class="op">=</span> <span class="st">"BreakpointsData"</span><span class="op">)</span>,    <span class="cn">NULL</span>,     <span class="va">OKI2018_I69</span><span class="op">)</span>

<span class="va">gbs</span><span class="op">$</span><span class="va">Dme_Dbu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/load_genomic_breaks.html" class="external-link">load_genomic_breaks</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/Insects_pairwise_v3/Dmel__Dbus_ASM1175060v1.gff.gz"</span>,     package <span class="op">=</span> <span class="st">"BreakpointsData"</span><span class="op">)</span>,    <span class="cn">NULL</span>,     <span class="cn">NULL</span><span class="op">)</span>
<span class="va">gbs</span><span class="op">$</span><span class="va">Dme_Dsu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/load_genomic_breaks.html" class="external-link">load_genomic_breaks</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/Insects_pairwise_v3/Dmel__RU_Dsub_v1.1.gff.gz"</span>,          package <span class="op">=</span> <span class="st">"BreakpointsData"</span><span class="op">)</span>,    <span class="cn">NULL</span>,     <span class="cn">NULL</span><span class="op">)</span>
<span class="va">gbs</span><span class="op">$</span><span class="va">Dme_Dya</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/load_genomic_breaks.html" class="external-link">load_genomic_breaks</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/Insects_pairwise_v3/Dmel__Prin_Dyak_Tai18E2_2.0.gff.gz"</span>, package <span class="op">=</span> <span class="st">"BreakpointsData"</span><span class="op">)</span>,    <span class="cn">NULL</span>,     <span class="cn">NULL</span><span class="op">)</span>
<span class="va">gbs</span><span class="op">$</span><span class="va">Dme_Dma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/load_genomic_breaks.html" class="external-link">load_genomic_breaks</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/Insects_pairwise_v3/Dmel__Dmau_ASM438214v1.gff.gz"</span>,      package <span class="op">=</span> <span class="st">"BreakpointsData"</span><span class="op">)</span>,    <span class="cn">NULL</span>,     <span class="cn">NULL</span><span class="op">)</span>

<span class="va">gbs</span><span class="op">[</span><span class="va">Oik_Oik</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">gbs</span><span class="op">[</span><span class="va">Oik_Oik</span><span class="op">]</span>, <span class="va">transcripts</span><span class="op">)</span>
<span class="va">gbs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">gbs</span>, <span class="va">flagAll</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/SimpleList-class.html" class="external-link">SimpleList</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="unaligned-regions">Unaligned regions<a class="anchor" aria-label="anchor" href="#unaligned-regions"></a>
</h2>
<p>Note that the unaligned regions are strandless and unpaired by definition.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">unal</span>  <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">gbs</span>, <span class="va">cleanGaps</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/SimpleList-class.html" class="external-link">SimpleList</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">unal</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">unal</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
<span class="va">unal</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">unal</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
<span class="va">unal</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">unal</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span>

<span class="va">unal</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">unal</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span>, <span class="va">annotateWithReps.GRanges</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
<span class="va">unal</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">unal</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="va">annotateWithReps.GRanges</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
<span class="va">unal</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">unal</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>, <span class="va">annotateWithReps.GRanges</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span>

<span class="va">unal</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">unal</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span>, <span class="va">annotateWithTranscripts</span>, <span class="va">transcripts</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
<span class="va">unal</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">unal</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="va">annotateWithTranscripts</span>, <span class="va">transcripts</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
<span class="va">unal</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">unal</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>, <span class="va">annotateWithTranscripts</span>, <span class="va">transcripts</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="coalescing-alignments">Coalescing alignments<a class="anchor" aria-label="anchor" href="#coalescing-alignments"></a>
</h2>
<div class="section level3">
<h3 id="coalesce">Coalesce<a class="anchor" aria-label="anchor" href="#coalesce"></a>
</h3>
<p>We call these coalesced regions “mapped regions”. Some of the bases in the region are aligned and some not (see the “mapped unaligned regions” later).</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">coa</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">gbs</span>, <span class="va">coalesce_contigs</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/SimpleList-class.html" class="external-link">SimpleList</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">coa</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">coa</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,  <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
<span class="va">coa</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">coa</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
<span class="va">coa</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">coa</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span>

<span class="va">coa</span><span class="op">[</span><span class="va">Oik_Oik</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">annotateWithReps.GBreaksSimpleList</span><span class="op">(</span><span class="va">coa</span><span class="op">[</span><span class="va">Oik_Oik</span><span class="op">]</span>, <span class="va">reps</span><span class="op">)</span>
<span class="va">coa</span><span class="op">[</span><span class="va">Oik_Oik</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">coa</span><span class="op">[</span><span class="va">Oik_Oik</span><span class="op">]</span>, <span class="va">transcripts</span><span class="op">)</span>

<span class="va">coa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">coa</span>, <span class="va">flagAll</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/SimpleList-class.html" class="external-link">SimpleList</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="flag-non-coalesced">Flag non-coalesced<a class="anchor" aria-label="anchor" href="#flag-non-coalesced"></a>
</h3>
<p>Mark the regions that are identical in the aligned and the mapped objects with a <code>nonCoa</code> flag meaning <em>non coalesced</em>.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">for</span><span class="op">(</span><span class="va">name</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">coa</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">coa</span><span class="op">[[</span><span class="va">name</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">nonCoa</span> <span class="op">&lt;-</span> <span class="va">coa</span><span class="op">[[</span><span class="va">name</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="va">gbs</span> <span class="op">[[</span><span class="va">name</span><span class="op">]</span><span class="op">]</span>
<span class="op">}</span>

<span class="kw">for</span><span class="op">(</span><span class="va">name</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">gbs</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">gbs</span><span class="op">[[</span><span class="va">name</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">nonCoa</span> <span class="op">&lt;-</span> <span class="va">gbs</span><span class="op">[[</span><span class="va">name</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="va">coa</span> <span class="op">[[</span><span class="va">name</span><span class="op">]</span><span class="op">]</span>
<span class="op">}</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="unmapped-regions">Unmapped regions<a class="anchor" aria-label="anchor" href="#unmapped-regions"></a>
</h2>
<div class="section level3">
<h3 id="generate">Generate<a class="anchor" aria-label="anchor" href="#generate"></a>
</h3>
<p>We can not call them “uncoalesced” because this would also qualify aligned regions that were not colinear with any other region.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">unmap</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">coa</span>, <span class="va">cleanGaps</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/SimpleList-class.html" class="external-link">SimpleList</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">unmap</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">unmap</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
<span class="va">unmap</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">unmap</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
<span class="va">unmap</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">unmap</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span>

<span class="va">unmap</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">unmap</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span>, <span class="va">annotateWithReps.GRanges</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
<span class="va">unmap</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">unmap</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="va">annotateWithReps.GRanges</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
<span class="va">unmap</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">unmap</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>, <span class="va">annotateWithReps.GRanges</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span>

<span class="va">unmap</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">unmap</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span>, <span class="va">annotateWithTranscripts</span>, <span class="va">transcripts</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
<span class="va">unmap</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">unmap</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="va">annotateWithTranscripts</span>, <span class="va">transcripts</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
<span class="va">unmap</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">unmap</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>, <span class="va">annotateWithTranscripts</span>, <span class="va">transcripts</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="flag-non-coalesced-1">Flag non-coalesced<a class="anchor" aria-label="anchor" href="#flag-non-coalesced-1"></a>
</h3>
<p>Mark the regions that are identical in the unaligned and the unmapped objects the same <code>nonCoa</code> flag. The flag is <code>TRUE</code> by definition in all unmapped objects, but we keep it so that objects have similar structures.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">for</span><span class="op">(</span><span class="va">name</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">unal</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">unal</span><span class="op">[[</span><span class="va">name</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">nonCoa</span>  <span class="op">&lt;-</span> <span class="va">unal</span><span class="op">[[</span><span class="va">name</span><span class="op">]</span><span class="op">]</span>  <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="va">unmap</span> <span class="op">[[</span><span class="va">name</span><span class="op">]</span><span class="op">]</span>
<span class="op">}</span>

<span class="kw">for</span><span class="op">(</span><span class="va">name</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">unmap</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">unmap</span><span class="op">[[</span><span class="va">name</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">nonCoa</span> <span class="op">&lt;-</span> <span class="va">unmap</span><span class="op">[[</span><span class="va">name</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="va">unal</span>  <span class="op">[[</span><span class="va">name</span><span class="op">]</span><span class="op">]</span>
<span class="op">}</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="whole-genome-objects">Whole-genome objects<a class="anchor" aria-label="anchor" href="#whole-genome-objects"></a>
</h2>
<p>Let’s have objects that cover the whole genomes (with the possible exception of the telomeric regions) and contain non-overlapping aligned, unaligned and syntenic regions. These are <code>GRanges</code> objects, not <code>GBreaks</code>, since they contain unaligned regions.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">makeWholeGenomeObject</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">aligned</span>, <span class="va">unaligned</span>, <span class="va">coalesced</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">aligned_nonCoa</span>   <span class="op">&lt;-</span> <span class="va">aligned</span><span class="op">[</span><span class="va">aligned</span><span class="op">$</span><span class="va">nonCoa</span><span class="op">]</span>
  <span class="va">unaligned_nonCoa</span> <span class="op">&lt;-</span> <span class="va">unaligned</span><span class="op">[</span><span class="va">unaligned</span><span class="op">$</span><span class="va">nonCoa</span><span class="op">]</span>
  <span class="va">syntenic</span>         <span class="op">&lt;-</span> <span class="va">coalesced</span><span class="op">[</span> <span class="op">!</span> <span class="va">coalesced</span><span class="op">$</span><span class="va">nonCoa</span><span class="op">]</span>
  
  <span class="co"># Let's keep only the common metadata</span>
  <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">mcols</a></span><span class="op">(</span><span class="va">aligned_nonCoa</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">mcols</a></span><span class="op">(</span><span class="va">aligned_nonCoa</span><span class="op">)</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">mcols</a></span><span class="op">(</span><span class="va">unaligned</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>
  <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">mcols</a></span><span class="op">(</span><span class="va">syntenic</span><span class="op">)</span>       <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">mcols</a></span><span class="op">(</span><span class="va">syntenic</span><span class="op">)</span><span class="op">[</span>      ,<span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">mcols</a></span><span class="op">(</span><span class="va">unaligned</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>
  
  <span class="co"># Let's replace the `nonCoa` flag by a `aligned`, `unaligned`, `syntenic` flag.</span>
  <span class="va">aligned_nonCoa</span><span class="op">$</span><span class="va">nonCoa</span> <span class="op">&lt;-</span> <span class="va">unaligned_nonCoa</span><span class="op">$</span><span class="va">nonCoa</span> <span class="op">&lt;-</span> <span class="va">syntenic</span><span class="op">$</span><span class="va">nonCoa</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
  <span class="va">aligned_nonCoa</span><span class="op">$</span><span class="va">type</span>   <span class="op">&lt;-</span> <span class="st">'aligned'</span>
  <span class="va">unaligned_nonCoa</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="st">'unaligned'</span>
  <span class="va">syntenic</span><span class="op">$</span><span class="va">type</span>         <span class="op">&lt;-</span> <span class="st">'syntenic'</span>

  <span class="va">wholeGenome</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="va">aligned_nonCoa</span>, <span class="va">unaligned_nonCoa</span>, <span class="va">syntenic</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/sort.html" class="external-link">sort</a></span><span class="op">(</span>ignore.strand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
  <span class="va">wholeGenome</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">wholeGenome</span><span class="op">$</span><span class="va">type</span><span class="op">)</span>
  <span class="va">wholeGenome</span>
<span class="op">}</span>

<span class="va">wgo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/mapply.html" class="external-link">mapply</a></span><span class="op">(</span><span class="va">makeWholeGenomeObject</span>, <span class="va">gbs</span>, <span class="va">unal</span>, <span class="va">coa</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/SimpleList-class.html" class="external-link">SimpleList</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="mapped-unaligned-regions">Mapped unaligned regions<a class="anchor" aria-label="anchor" href="#mapped-unaligned-regions"></a>
</h2>
<p>We can pair the unaligned regions that are between two colinearly aligned regions.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">filterMappedUnaligned</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">gb</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">colinearRegions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/filterColinearRegions.html" class="external-link">filterColinearRegions</a></span><span class="op">(</span><span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/flagColinearAlignments.html" class="external-link">flagColinearAlignments</a></span><span class="op">(</span><span class="va">gb</span><span class="op">)</span>, rename <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
  <span class="co"># Turning the sequence of [(TRUE)n, FALSE]n into indices.</span>
  <span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="op">!</span><span class="va">colinearRegions</span><span class="op">$</span><span class="va">colinear</span><span class="op">)</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>
  <span class="va">gbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/splitAsList.html" class="external-link">split</a></span><span class="op">(</span><span class="va">colinearRegions</span>, <span class="va">idx</span><span class="op">)</span>
  <span class="va">unalMap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/List-utils.html" class="external-link">endoapply</a></span><span class="op">(</span><span class="va">gbl</span>, \<span class="op">(</span><span class="va">gb</span><span class="op">)</span> <span class="op">{</span>
    <span class="co"># Check strand</span>
    <span class="va">onMinus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/strand.html" class="external-link">strand</a></span><span class="op">(</span><span class="va">gb</span><span class="op">)</span> <span class="op">==</span> <span class="st">"-"</span><span class="op">)</span>
    <span class="co"># Need to subtract 1 because some ranges are adjacent (no gap)</span>
    <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/GBreaks-class.html" class="external-link">GBreaks</a></span><span class="op">(</span>target <span class="op">=</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/cleanGaps.html" class="external-link">cleanGaps</a></span><span class="op">(</span><span class="va">gb</span>      <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>,
            query  <span class="op">=</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/cleanGaps.html" class="external-link">cleanGaps</a></span><span class="op">(</span><span class="va">gb</span><span class="op">$</span><span class="va">query</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/sort.html" class="external-link">sort</a></span><span class="op">(</span>decreasing <span class="op">=</span> <span class="va">onMinus</span><span class="op">)</span><span class="op">)</span>
  <span class="op">}</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">unalMap</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>
  <span class="va">unalMap</span>
<span class="op">}</span>

<span class="va">unalMap</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">gbs</span>, <span class="va">filterMappedUnaligned</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/as.html" class="external-link">as</a></span><span class="op">(</span><span class="st">"SimpleList"</span><span class="op">)</span>

<span class="va">unalMap</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">unalMap</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
<span class="va">unalMap</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">unalMap</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
<span class="va">unalMap</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">unalMap</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span>

<span class="va">unalMap</span><span class="op">[</span><span class="va">Oik_Oik</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">annotateWithReps.GBreaksSimpleList</span><span class="op">(</span><span class="va">unalMap</span><span class="op">[</span><span class="va">Oik_Oik</span><span class="op">]</span>, <span class="va">reps</span><span class="op">)</span>
<span class="va">unalMap</span><span class="op">[</span><span class="va">Oik_Oik</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">unalMap</span><span class="op">[</span><span class="va">Oik_Oik</span><span class="op">]</span>, <span class="va">transcripts</span><span class="op">)</span>
<span class="va">unalMap</span><span class="op">[</span><span class="va">Oik_Oik</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">unalMap</span><span class="op">[</span><span class="va">Oik_Oik</span><span class="op">]</span>, <span class="va">flagAll</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/SimpleList-class.html" class="external-link">SimpleList</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="translocated-regions">Translocated regions<a class="anchor" aria-label="anchor" href="#translocated-regions"></a>
</h2>
<p>Here we compute new <code>GBreaks</code> objects representing the intervals between two regions that would be colinear if there would not be a translocation separating them.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">removeTranslocations</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">gb</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">gb</span><span class="op">$</span><span class="va">tra</span><span class="op">)</span><span class="op">)</span>
    <span class="va">gb</span> <span class="op">&lt;-</span> <span class="va">gb</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">gb</span><span class="op">$</span><span class="va">tra</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">]</span>
  <span class="va">gb</span>
<span class="op">}</span>

<span class="va">traGaps</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">coa</span><span class="op">)</span> <span class="op">{</span>
  <span class="co"># The input MUST already be coalesced.</span>
  <span class="co"># First, flag translocations on the target genome</span>
  <span class="va">tra.target</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/flagTranslocations.html" class="external-link">flagTranslocations</a></span><span class="op">(</span><span class="va">coa</span><span class="op">)</span><span class="op">$</span><span class="va">tra</span>
  <span class="co"># Second, do it again on the query genome</span>
  <span class="va">tra</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/swap.html" class="external-link">swap</a></span><span class="op">(</span><span class="va">coa</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/sort.html" class="external-link">sort</a></span><span class="op">(</span>ignore.strand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/flagTranslocations.html" class="external-link">flagTranslocations</a></span><span class="op">(</span><span class="op">)</span>
  <span class="va">tra.query</span> <span class="op">&lt;-</span> <span class="va">tra</span><span class="op">$</span><span class="va">tra</span>
  <span class="va">tra</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/swap.html" class="external-link">swap</a></span><span class="op">(</span><span class="va">tra</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/sort.html" class="external-link">sort</a></span><span class="op">(</span>ignore.strand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
  <span class="va">tra</span><span class="op">$</span><span class="va">tra</span> <span class="op">&lt;-</span> <span class="va">tra.target</span> <span class="op">|</span> <span class="va">tra.query</span>
  <span class="co"># Then, remove translocated regions</span>
  <span class="va">tra</span> <span class="op">&lt;-</span> <span class="fu">removeTranslocations</span><span class="op">(</span><span class="va">tra</span><span class="op">)</span>
  <span class="co"># Then extract the newly "unaligned mapped" regions</span>
  <span class="co"># They contain the gaps left by the removal of the translocated regions.</span>
  <span class="fu">filterMappedUnaligned</span><span class="op">(</span><span class="va">tra</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">tra</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">coa</span>, <span class="va">traGaps</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/as.html" class="external-link">as</a></span><span class="op">(</span><span class="st">"SimpleList"</span><span class="op">)</span>

<span class="va">tra</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">tra</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
<span class="va">tra</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">tra</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
<span class="va">tra</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">tra</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span>

<span class="va">tra</span><span class="op">[</span><span class="va">Oik_Oik</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">annotateWithReps.GBreaksSimpleList</span><span class="op">(</span><span class="va">tra</span><span class="op">[</span><span class="va">Oik_Oik</span><span class="op">]</span>, <span class="va">reps</span><span class="op">)</span>
<span class="va">tra</span><span class="op">[</span><span class="va">Oik_Oik</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">tra</span><span class="op">[</span><span class="va">Oik_Oik</span><span class="op">]</span>, <span class="va">transcripts</span><span class="op">)</span>
<span class="va">tra</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">tra</span>, <span class="va">flagAll</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/SimpleList-class.html" class="external-link">SimpleList</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="coalesce-again">Coalesce again<a class="anchor" aria-label="anchor" href="#coalesce-again"></a>
</h2>
<p>We remove the translocated regions that interrupt colinearity, where one of the colinear pairs is closer than 200 bp.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">removeTranslocationsOnTargetGenome</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">gb</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">gb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/flagTranslocations.html" class="external-link">flagTranslocations</a></span><span class="op">(</span><span class="va">gb</span><span class="op">)</span>
  <span class="va">gb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/dist2next.html" class="external-link">dist2next</a></span><span class="op">(</span><span class="va">gb</span>, step <span class="op">=</span> <span class="fl">2</span>, ignore.strand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
  <span class="va">idx</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/which.html" class="external-link">which</a></span><span class="op">(</span> <span class="va">gb</span><span class="op">$</span><span class="va">tra</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">gb</span><span class="op">$</span><span class="va">tdist</span> <span class="op">&lt;</span> <span class="fl">200</span> <span class="op">|</span> <span class="va">gb</span><span class="op">$</span><span class="va">qdist</span> <span class="op">&lt;</span> <span class="fl">200</span><span class="op">)</span> <span class="op">)</span>
  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">idx</span><span class="op">)</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span>
    <span class="va">gb</span> <span class="op">&lt;-</span> <span class="va">gb</span><span class="op">[</span><span class="op">-</span><span class="va">idx</span><span class="op">]</span>
  <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/coalesce_contigs.html" class="external-link">coalesce_contigs</a></span><span class="op">(</span><span class="va">gb</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">removeTranslocationsOnBothGenomes</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">gb</span><span class="op">)</span>
  <span class="va">gb</span> |&gt;
    <span class="fu">removeTranslocationsOnTargetGenome</span><span class="op">(</span><span class="op">)</span> |&gt;
    <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/swap.html" class="external-link">swap</a></span><span class="op">(</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/sort.html" class="external-link">sort</a></span><span class="op">(</span>i<span class="op">=</span><span class="cn">T</span><span class="op">)</span> |&gt;
    <span class="fu">removeTranslocationsOnTargetGenome</span><span class="op">(</span><span class="op">)</span> |&gt;
    <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/swap.html" class="external-link">swap</a></span><span class="op">(</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/sort.html" class="external-link">sort</a></span><span class="op">(</span>i<span class="op">=</span><span class="cn">T</span><span class="op">)</span>

<span class="va">coa2</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">coa</span>, <span class="va">removeTranslocationsOnBothGenomes</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/SimpleList-class.html" class="external-link">SimpleList</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">coa2</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">coa2</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,  <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
<span class="va">coa2</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">coa2</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
<span class="va">coa2</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">coa2</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span>

<span class="va">coa2</span><span class="op">[</span><span class="va">Oik_Oik</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">annotateWithReps.GBreaksSimpleList</span><span class="op">(</span><span class="va">coa2</span><span class="op">[</span><span class="va">Oik_Oik</span><span class="op">]</span>, <span class="va">reps</span><span class="op">)</span>
<span class="va">coa2</span><span class="op">[</span><span class="va">Oik_Oik</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">coa2</span><span class="op">[</span><span class="va">Oik_Oik</span><span class="op">]</span>, <span class="va">transcripts</span><span class="op">)</span>
<span class="va">coa2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">coa2</span>, <span class="va">flagAll</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/SimpleList-class.html" class="external-link">SimpleList</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="unmapped-regions-2">Unmapped regions 2<a class="anchor" aria-label="anchor" href="#unmapped-regions-2"></a>
</h2>
<p>The intervals between double-coalesced regions.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">unmap2</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">coa2</span>, <span class="va">cleanGaps</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/SimpleList-class.html" class="external-link">SimpleList</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">unmap2</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">unmap2</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
<span class="va">unmap2</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">unmap2</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
<span class="va">unmap2</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">unmap2</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span>

<span class="va">unmap2</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">unmap2</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span>, <span class="va">annotateWithReps.GRanges</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
<span class="va">unmap2</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">unmap2</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="va">annotateWithReps.GRanges</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
<span class="va">unmap2</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">unmap2</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>, <span class="va">annotateWithReps.GRanges</span>, <span class="va">reps</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span>

<span class="va">unmap2</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">unmap2</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span>, <span class="va">annotateWithTranscripts</span>, <span class="va">transcripts</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
<span class="va">unmap2</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">unmap2</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="va">annotateWithTranscripts</span>, <span class="va">transcripts</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
<span class="va">unmap2</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">unmap2</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>, <span class="va">annotateWithTranscripts</span>, <span class="va">transcripts</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="translocated-regions-2">Translocated regions 2<a class="anchor" aria-label="anchor" href="#translocated-regions-2"></a>
</h2>
<p>To check that we really removed the small ones as intented.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tra2</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">coa2</span>, <span class="va">traGaps</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://oist.github.io/GenomicBreaks/reference/as.html" class="external-link">as</a></span><span class="op">(</span><span class="st">"SimpleList"</span><span class="op">)</span>

<span class="va">tra2</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">tra2</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span>
<span class="va">tra2</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">tra2</span><span class="op">[</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span>
<span class="va">tra2</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">BiocParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span><span class="va">tra2</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span>, <span class="va">flagLongShort</span>, <span class="va">longShort</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span>

<span class="va">tra2</span><span class="op">[</span><span class="va">Oik_Oik</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">annotateWithReps.GBreaksSimpleList</span><span class="op">(</span><span class="va">tra2</span><span class="op">[</span><span class="va">Oik_Oik</span><span class="op">]</span>, <span class="va">reps</span><span class="op">)</span>
<span class="va">tra2</span><span class="op">[</span><span class="va">Oik_Oik</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">annotateWithTranscripts</span><span class="op">(</span><span class="va">tra2</span><span class="op">[</span><span class="va">Oik_Oik</span><span class="op">]</span>, <span class="va">transcripts</span><span class="op">)</span>

<span class="va">tra2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">tra2</span>, <span class="va">flagAll</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/SimpleList-class.html" class="external-link">SimpleList</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="numbers-of-blocks">Numbers of blocks<a class="anchor" aria-label="anchor" href="#numbers-of-blocks"></a>
</h2>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bp_summary</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/cbind.html" class="external-link">rbind</a></span><span class="op">(</span>
    gbs     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">gbs</span>, <span class="va">length</span><span class="op">)</span>,
    unal    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">unal</span>, <span class="va">length</span><span class="op">)</span>,
    coa     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">coa</span>, <span class="va">length</span><span class="op">)</span>,
    unmap   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">unmap</span>, <span class="va">length</span><span class="op">)</span>,
    unmap2  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">unmap2</span>, <span class="va">length</span><span class="op">)</span>,
    unalMap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">unalMap</span>, <span class="va">length</span><span class="op">)</span>,
    tra     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">tra</span>, <span class="va">length</span><span class="op">)</span>,
    tra2    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">tra2</span>, <span class="va">length</span><span class="op">)</span>,
    coa2    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">coa2</span>, <span class="va">length</span><span class="op">)</span>
  <span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/t.html" class="external-link">t</a></span><span class="op">(</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">bp_summary</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">bp_summary</span><span class="op">)</span> |&gt; <span class="fu">OikScrambling</span><span class="fu">:::</span><span class="fu"><a href="../reference/compDistance.html">compDistance</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">mean</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##                    gbs     unal      coa    unmap   unmap2   unalMap       tra</span>
<span class="co">## Dme_Dbu       47893.00 47867.00 5959.000 5951.000 5869.000 41934.000  411.0000</span>
<span class="co">## Dme_Dma        9732.00  9138.00 2706.000 2616.000 2215.000  7026.000  281.0000</span>
<span class="co">## Dme_Dsu       68750.00 68626.00  992.000  984.000  870.000 67758.000  145.0000</span>
<span class="co">## Dme_Dya       23059.00 22743.00 1816.000 1776.000 1553.000 21243.000  194.0000</span>
<span class="co">## In same pop   15177.00 12652.67 5520.667 4465.333 2446.333  9656.333 1297.0000</span>
<span class="co">## Int – Int     40659.00 36133.00 7701.000 6304.000 3727.000 32958.000 1578.0000</span>
<span class="co">## Int – Rob     58863.00 56141.33 4782.333 4432.667 2975.333 54080.667  897.3333</span>
<span class="co">## Int/Rob – Oki  2237.00  2221.50 1354.000 1339.500 1337.500   883.000    5.0000</span>
<span class="co">## Int/Rob – Sav 69332.00 69275.00 4094.500 4068.500 4063.500 65237.500  239.5000</span>
<span class="co">## North – North 24623.75 24125.25 4394.500 4333.000 3630.250 20229.250  469.5000</span>
<span class="co">## Oki – North   31309.00 31115.50 8718.625 8700.875 8033.875 22590.375  510.2500</span>
<span class="co">##                   tra2     coa2</span>
<span class="co">## Dme_Dbu       405.0000 5877.000</span>
<span class="co">## Dme_Dma       153.0000 2272.000</span>
<span class="co">## Dme_Dsu       124.0000  878.000</span>
<span class="co">## Dme_Dya       113.0000 1582.000</span>
<span class="co">## In same pop   342.6667 2733.333</span>
<span class="co">## Int – Int     489.0000 4224.000</span>
<span class="co">## Int – Rob     450.6667 3172.333</span>
<span class="co">## Int/Rob – Oki   5.0000 1352.000</span>
<span class="co">## Int/Rob – Sav 240.5000 4089.500</span>
<span class="co">## North – North 227.7500 3670.750</span>
<span class="co">## Oki – North   287.8750 8046.500</span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">bp_summary</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">bp_summary</span><span class="op">)</span> |&gt; <span class="fu">OikScrambling</span><span class="fu">:::</span><span class="fu"><a href="../reference/compDistance.html">compDistance</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">median</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##                 gbs    unal    coa  unmap unmap2 unalMap    tra  tra2   coa2</span>
<span class="co">## Dme_Dbu       47893 47867.0 5959.0 5951.0 5869.0 41934.0  411.0 405.0 5877.0</span>
<span class="co">## Dme_Dma        9732  9138.0 2706.0 2616.0 2215.0  7026.0  281.0 153.0 2272.0</span>
<span class="co">## Dme_Dsu       68750 68626.0  992.0  984.0  870.0 67758.0  145.0 124.0  878.0</span>
<span class="co">## Dme_Dya       23059 22743.0 1816.0 1776.0 1553.0 21243.0  194.0 113.0 1582.0</span>
<span class="co">## In same pop   15184 12425.0 5424.0 4119.0 2042.0  9662.0 1279.0 268.0 2256.0</span>
<span class="co">## Int – Int     40659 36133.0 7701.0 6304.0 3727.0 32958.0 1578.0 489.0 4224.0</span>
<span class="co">## Int – Rob     60205 57513.0 4812.0 4431.0 3006.0 55393.0  894.0 440.0 3152.0</span>
<span class="co">## Int/Rob – Oki  2237  2221.5 1354.0 1339.5 1337.5   883.0    5.0   5.0 1352.0</span>
<span class="co">## Int/Rob – Sav 69332 69275.0 4094.5 4068.5 4063.5 65237.5  239.5 240.5 4089.5</span>
<span class="co">## North – North 24607 24103.5 4139.0 4081.5 3369.0 20434.5  458.5 202.5 3412.5</span>
<span class="co">## Oki – North   31252 31041.5 8806.0 8785.0 8090.5 22446.0  501.5 285.5 8105.0</span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">bp_summary</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">bp_summary</span><span class="op">)</span> |&gt; <span class="fu">OikScrambling</span><span class="fu">:::</span><span class="fu"><a href="../reference/compDistance.html">compDistance</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">sd</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##                      gbs      unal       coa     unmap     unmap2    unalMap</span>
<span class="co">## Dme_Dbu               NA        NA        NA        NA         NA         NA</span>
<span class="co">## Dme_Dma               NA        NA        NA        NA         NA         NA</span>
<span class="co">## Dme_Dsu               NA        NA        NA        NA         NA         NA</span>
<span class="co">## Dme_Dya               NA        NA        NA        NA         NA         NA</span>
<span class="co">## In same pop     87.70975  428.5491 624.63536 648.96867 1252.44574  657.51831</span>
<span class="co">## Int – Int             NA        NA        NA        NA         NA         NA</span>
<span class="co">## Int – Rob     2481.04555 2535.0468 203.13132 234.50444   97.67975 2649.62381</span>
<span class="co">## Int/Rob – Oki  155.56349  154.8564  67.88225  67.17514   67.17514   87.68124</span>
<span class="co">## Int/Rob – Sav 1228.95159 1210.5668  75.66043  58.68986   58.68986 1153.29116</span>
<span class="co">## North – North  194.88693  114.1034 557.88499 554.44447  549.00357  663.36585</span>
<span class="co">## Oki – North    772.56974  758.8316 168.79653 165.44782  164.13795  839.21391</span>
<span class="co">##                       tra       tra2       coa2</span>
<span class="co">## Dme_Dbu                NA         NA         NA</span>
<span class="co">## Dme_Dma                NA         NA         NA</span>
<span class="co">## Dme_Dsu                NA         NA         NA</span>
<span class="co">## Dme_Dya                NA         NA         NA</span>
<span class="co">## In same pop   269.4512943 138.077273 1409.00473</span>
<span class="co">## Int – Int              NA         NA         NA</span>
<span class="co">## Int – Rob      29.1433240  28.536526  107.94597</span>
<span class="co">## Int/Rob – Oki   2.8284271   2.828427   67.88225</span>
<span class="co">## Int/Rob – Sav   0.7071068   2.121320   75.66043</span>
<span class="co">## North – North  67.0547040  76.041107  554.36894</span>
<span class="co">## Oki – North    32.6791764  27.544445  166.26055</span></code></pre>
</div>
<div class="section level2">
<h2 id="fraction-of-the-genome-aligned-or-mapped">Fraction of the genome aligned or mapped<a class="anchor" aria-label="anchor" href="#fraction-of-the-genome-aligned-or-mapped"></a>
</h2>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R">  <span class="va">aligned_tot</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">gbs</span>,   \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/start.html" class="external-link">width</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  <span class="va">mapped_tot</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">coa</span>,   \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/start.html" class="external-link">width</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  <span class="va">mapped2_tot</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">coa2</span>,  \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/start.html" class="external-link">width</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">unaligned_tot</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">unal</span>,   \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/start.html" class="external-link">width</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">unmapped_tot</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">unmap</span>,  \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/start.html" class="external-link">width</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">unmapped2_tot</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">unmap2</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/start.html" class="external-link">width</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="op">(</span><span class="va">align_summary</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>
  align_frac <span class="op">=</span> <span class="va">aligned_tot</span> <span class="op">/</span> <span class="op">(</span> <span class="va">aligned_tot</span> <span class="op">+</span> <span class="va">unaligned_tot</span> <span class="op">)</span>,
  map_frac   <span class="op">=</span> <span class="va">mapped_tot</span>  <span class="op">/</span> <span class="op">(</span> <span class="va">mapped_tot</span>  <span class="op">+</span> <span class="va">unmapped_tot</span> <span class="op">)</span>,
  map2_frac  <span class="op">=</span> <span class="va">mapped2_tot</span> <span class="op">/</span> <span class="op">(</span> <span class="va">mapped2_tot</span> <span class="op">+</span> <span class="va">unmapped2_tot</span><span class="op">)</span>
 <span class="op">)</span>|&gt; <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##         align_frac  map_frac map2_frac</span>
<span class="co">## Oki_Osa 52.0159495 72.064774 72.591841</span>
<span class="co">## Oki_Bar 50.2331439 71.873745 72.439411</span>
<span class="co">## Oki_Kum 83.7160367 92.765000 94.480041</span>
<span class="co">## Oki_Aom 50.6089555 72.114976 72.741460</span>
<span class="co">## Oki_Nor 47.1467623 68.537624 69.073404</span>
<span class="co">## Osa_Oki 58.3631347 77.105711 77.170651</span>
<span class="co">## Osa_Bar 71.1871466 85.560773 86.174793</span>
<span class="co">## Osa_Kum 58.4606442 77.300551 77.474092</span>
<span class="co">## Osa_Aom 86.4673469 92.945330 94.144071</span>
<span class="co">## Osa_Nor 68.8797738 83.812429 84.344633</span>
<span class="co">## Bar_Oki 55.7960607 74.409334 74.396050</span>
<span class="co">## Bar_Osa 70.9620899 82.982915 83.029837</span>
<span class="co">## Bar_Kum 56.6319075 74.633503 74.605171</span>
<span class="co">## Bar_Aom 71.3391619 83.174402 83.438869</span>
<span class="co">## Bar_Nor 82.0574520 88.611295 89.137858</span>
<span class="co">## Ply_Ros 81.3622209 91.050237 92.176488</span>
<span class="co">## Ply_Rob 70.3529758 87.498052 88.962676</span>
<span class="co">## Ply_Sav 13.1367749 67.169476 67.181135</span>
<span class="co">## Ply_Oki  0.6063520  1.897941  1.897793</span>
<span class="co">## Rob_Ros 73.6319134 90.562151 91.221000</span>
<span class="co">## Rob_Ply 73.0152650 89.704745 90.321434</span>
<span class="co">## Rob_Sav 14.5141690 70.474445 70.494999</span>
<span class="co">## Rob_Oki  0.6696567  2.112460  2.112311</span>
<span class="co">## Dme_Dbu 21.7446598 71.124298 71.647394</span>
<span class="co">## Dme_Dsu 59.8730476 76.684629 76.712764</span>
<span class="co">## Dme_Dya 76.9451636 84.778190 84.900306</span>
<span class="co">## Dme_Dma 80.9637966 85.833201 86.001342</span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">align_summary</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">align_summary</span><span class="op">)</span> |&gt; <span class="fu">OikScrambling</span><span class="fu">:::</span><span class="fu"><a href="../reference/compDistance.html">compDistance</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">mean</span><span class="op">)</span><span class="op">)</span>   |&gt; <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##               align_frac map_frac map2_frac</span>
<span class="co">## Dme_Dbu             21.7     71.1      71.6</span>
<span class="co">## Dme_Dma             81.0     85.8      86.0</span>
<span class="co">## Dme_Dsu             59.9     76.7      76.7</span>
<span class="co">## Dme_Dya             76.9     84.8      84.9</span>
<span class="co">## In same pop         84.1     91.4      92.6</span>
<span class="co">## Int – Int           81.4     91.1      92.2</span>
<span class="co">## Int – Rob           72.3     89.3      90.2</span>
<span class="co">## Int/Rob – Oki        0.6      2.0       2.0</span>
<span class="co">## Int/Rob – Sav       13.8     68.8      68.8</span>
<span class="co">## North – North       70.6     83.9      84.2</span>
<span class="co">## Oki – North         53.7     73.5      73.8</span></code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">align_summary</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">align_summary</span><span class="op">)</span> |&gt; <span class="fu">OikScrambling</span><span class="fu">:::</span><span class="fu"><a href="../reference/compDistance.html">compDistance</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">median</span><span class="op">)</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##               align_frac map_frac map2_frac</span>
<span class="co">## Dme_Dbu             21.7     71.1      71.6</span>
<span class="co">## Dme_Dma             81.0     85.8      86.0</span>
<span class="co">## Dme_Dsu             59.9     76.7      76.7</span>
<span class="co">## Dme_Dya             76.9     84.8      84.9</span>
<span class="co">## In same pop         83.7     92.8      94.1</span>
<span class="co">## Int – Int           81.4     91.1      92.2</span>
<span class="co">## Int – Rob           73.0     89.7      90.3</span>
<span class="co">## Int/Rob – Oki        0.6      2.0       2.0</span>
<span class="co">## Int/Rob – Sav       13.8     68.8      68.8</span>
<span class="co">## North – North       71.1     83.5      83.9</span>
<span class="co">## Oki – North         53.9     73.3      73.6</span></code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">align_summary</span>, \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">align_summary</span><span class="op">)</span> |&gt; <span class="fu">OikScrambling</span><span class="fu">:::</span><span class="fu"><a href="../reference/compDistance.html">compDistance</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">sd</span><span class="op">)</span><span class="op">)</span>     |&gt; <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##               align_frac map_frac map2_frac</span>
<span class="co">## Dme_Dbu               NA       NA        NA</span>
<span class="co">## Dme_Dma               NA       NA        NA</span>
<span class="co">## Dme_Dsu               NA       NA        NA</span>
<span class="co">## Dme_Dya               NA       NA        NA</span>
<span class="co">## In same pop          2.2      2.5       3.0</span>
<span class="co">## Int – Int             NA       NA        NA</span>
<span class="co">## Int – Rob            1.7      1.6       1.1</span>
<span class="co">## Int/Rob – Oki        0.0      0.2       0.2</span>
<span class="co">## Int/Rob – Sav        1.0      2.3       2.3</span>
<span class="co">## North – North        1.2      1.2       1.4</span>
<span class="co">## Oki – North          4.2      2.9       2.7</span></code></pre>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>
  gbs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">gbs</span>, <span class="va">length</span><span class="op">)</span>,
  coa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">coa</span>, <span class="va">length</span><span class="op">)</span>,
  coa2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">coa2</span>, <span class="va">length</span><span class="op">)</span>
<span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> |&gt;
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span>gbs <span class="op">=</span> <span class="va">gbs</span> <span class="op">-</span> <span class="va">coa</span> <span class="op">-</span> <span class="va">coa2</span>, coa <span class="op">=</span> <span class="va">coa</span> <span class="op">-</span> <span class="va">coa2</span><span class="op">)</span>

<span class="va">df</span><span class="op">$</span><span class="va">pair</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span> |&gt; <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">!</span><span class="va">pair</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">pair</span>, <span class="va">value</span>, fill <span class="op">=</span> <span class="va">name</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span> stat <span class="op">=</span> <span class="st">"identity"</span> <span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Cumulative plot (gbs ⊃ coa ⊃ coa2) of the computed genomic regions"</span><span class="op">)</span></code></pre></div>
<p><img src="LoadGenomicBreaks_files/figure-html/summary-1.png" width="700"></p>
<p>NOTE: how does that compare with ANI (Average Nucleotide Identity) ?</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span>`Bar2_p4__AOM-5-5f` <span class="op">=</span> <span class="fl">87.489</span>, Bar2_p4__Bar2_p4 <span class="op">=</span> <span class="fl">100</span>, `Bar2_p4__KUM-M3-7f` <span class="op">=</span> <span class="fl">78.45822</span>, 
Bar2_p4__O_alb <span class="op">=</span> <span class="fl">69.79983</span>, Bar2_p4__O_lon <span class="op">=</span> <span class="fl">66.11535</span>, Bar2_p4__O_van <span class="op">=</span> <span class="fl">69.29796</span>, 
Bar2_p4__OdB3 <span class="op">=</span> <span class="fl">97.7499</span>, Bar2_p4__OKI2018_I69_1.0 <span class="op">=</span> <span class="fl">78.68358</span>, 
Bar2_p4__OSKA2016v1.9 <span class="op">=</span> <span class="fl">87.46913</span>, C_int_P__C_int_P <span class="op">=</span> <span class="fl">100</span>, C_int_P__C_int_R <span class="op">=</span> <span class="fl">96.16641</span>, 
C_int_P__C_rob_HT <span class="op">=</span> <span class="fl">90.49159</span>, C_int_P__C_sav <span class="op">=</span> <span class="fl">73.27976</span>, C_int_P__OKI2018_I69_1.0 <span class="op">=</span> <span class="fl">65.14351</span>, 
C_int_P__OSKA2016v1.9 <span class="op">=</span> <span class="fl">64.71592</span>, C_int_P__St_cla <span class="op">=</span> <span class="fl">68.16588</span>, 
C_rob_HT__C_int_P <span class="op">=</span> <span class="fl">90.41795</span>, C_rob_HT__C_int_R <span class="op">=</span> <span class="fl">90.4192</span>, C_rob_HT__C_rob_HT <span class="op">=</span> <span class="fl">100</span>, 
C_rob_HT__C_sav <span class="op">=</span> <span class="fl">73.16812</span>, C_rob_HT__OKI2018_I69_1.0 <span class="op">=</span> <span class="fl">65.53052</span>, 
C_rob_HT__OSKA2016v1.9 <span class="op">=</span> <span class="fl">65.09903</span>, C_rob_HT__St_cla <span class="op">=</span> <span class="fl">68.30626</span>, 
Dalb__AaegL5.0 <span class="op">=</span> <span class="fl">65.6799</span>, Dalb__AalbS3_pri_1.0 <span class="op">=</span> <span class="fl">68.17702</span>, Dalb__Cfrigida_v1.1 <span class="op">=</span> <span class="fl">72.42817</span>, 
`Dalb__Dalb_15112-1751.03v1` <span class="op">=</span> <span class="fl">100</span>, Dalb__Dath_EB_1.0 <span class="op">=</span> <span class="fl">80.60732</span>, 
Dalb__Dbif_1.0 <span class="op">=</span> <span class="fl">81.08233</span>, Dalb__Dbus_ASM1175060v1 <span class="op">=</span> <span class="fl">85.11277</span>, 
Dalb__Dinn_ASM435438v2 <span class="op">=</span> <span class="fl">87.86721</span>, Dalb__Dlow_1.0 <span class="op">=</span> <span class="fl">81.1923</span>, 
Dalb__Dmau_ASM438214v1 <span class="op">=</span> <span class="fl">81.65325</span>, Dalb__Dmel_BDGP6 <span class="op">=</span> <span class="fl">81.14</span>, 
Dalb__Dmir_PacBio2.1 <span class="op">=</span> <span class="fl">81.76273</span>, Dalb__Dpse_MV25 <span class="op">=</span> <span class="fl">81.20186</span>, 
Dalb__Eten_idEriTena2.1 <span class="op">=</span> <span class="fl">70.77767</span>, Dalb__Paka_ASM1839793v1 <span class="op">=</span> <span class="fl">66.22446</span>, 
Dalb__Prin_Dyak_Tai18E2_2.0 <span class="op">=</span> <span class="fl">81.21401</span>, Dalb__RU_Dsub_v1.1 <span class="op">=</span> <span class="fl">82.53274</span>, 
Dalb__RU_Dtri_1.1 <span class="op">=</span> <span class="fl">81.93057</span>, Dath__AaegL5.0 <span class="op">=</span> <span class="fl">66.28782</span>, Dath__AalbS3_pri_1.0 <span class="op">=</span> <span class="fl">69.08501</span>, 
Dath__Cfrigida_v1.1 <span class="op">=</span> <span class="fl">72.40521</span>, `Dath__Dalb_15112-1751.03v1` <span class="op">=</span> <span class="fl">81.90288</span>, 
Dath__Dath_EB_1.0 <span class="op">=</span> <span class="fl">100</span>, Dath__Dbif_1.0 <span class="op">=</span> <span class="fl">90.09103</span>, Dath__Dbus_ASM1175060v1 <span class="op">=</span> <span class="fl">81.89253</span>, 
Dath__Dinn_ASM435438v2 <span class="op">=</span> <span class="fl">82.2395</span>, Dath__Dlow_1.0 <span class="op">=</span> <span class="fl">92.30271</span>, 
Dath__Dmau_ASM438214v1 <span class="op">=</span> <span class="fl">85.84368</span>, Dath__Dmel_BDGP6 <span class="op">=</span> <span class="fl">85.72521</span>, 
Dath__Dmir_PacBio2.1 <span class="op">=</span> <span class="fl">91.84388</span>, Dath__Dpse_MV25 <span class="op">=</span> <span class="fl">91.87636</span>, 
Dath__Eten_idEriTena2.1 <span class="op">=</span> <span class="fl">71.32619</span>, Dath__Paka_ASM1839793v1 <span class="op">=</span> <span class="fl">65.05051</span>, 
Dath__Prin_Dyak_Tai18E2_2.0 <span class="op">=</span> <span class="fl">85.03599</span>, Dath__RU_Dsub_v1.1 <span class="op">=</span> <span class="fl">86.28124</span>, 
Dath__RU_Dtri_1.1 <span class="op">=</span> <span class="fl">86.45957</span>, Dinn__AaegL5.0 <span class="op">=</span> <span class="fl">66.17064</span>, Dinn__AalbS3_pri_1.0 <span class="op">=</span> <span class="fl">67.58017</span>, 
DDinn__Cfrigida_v1.1 <span class="op">=</span> <span class="fl">71.83029</span>, `Dinn__Dalb_15112-1751.03v1` <span class="op">=</span> <span class="fl">87.04083</span>, 
Dinn__Dath_EB_1.0 <span class="op">=</span> <span class="fl">79.57953</span>, Dinn__Dbif_1.0 <span class="op">=</span> <span class="fl">80.19957</span>, Dinn__Dbus_ASM1175060v1 <span class="op">=</span> <span class="fl">84.28436</span>, 
Dinn__Dinn_ASM435438v2 <span class="op">=</span> <span class="fl">100</span>, Dinn__Dlow_1.0 <span class="op">=</span> <span class="fl">80.67069</span>, Dinn__Dmau_ASM438214v1 <span class="op">=</span> <span class="fl">81.0131</span>, 
Dinn__Dmel_BDGP6 <span class="op">=</span> <span class="fl">80.77358</span>, Dinn__Dmir_PacBio2.1 <span class="op">=</span> <span class="fl">80.56467</span>, 
Dinn__Dpse_MV25 <span class="op">=</span> <span class="fl">79.94521</span>, Dinn__Eten_idEriTena2.1 <span class="op">=</span> <span class="fl">69.06343</span>, 
Dinn__Paka_ASM1839793v1 <span class="op">=</span> <span class="fl">66.33035</span>, Dinn__Prin_Dyak_Tai18E2_2.0 <span class="op">=</span> <span class="fl">80.57511</span>, 
Dinn__RU_Dsub_v1.1 <span class="op">=</span> <span class="fl">81.50381</span>, Dinn__RU_Dtri_1.1 <span class="op">=</span> <span class="fl">81.46686</span>, 
Dmel__AaegL5.0 <span class="op">=</span> <span class="fl">66.80427</span>, Dmel__AalbS3_pri_1.0 <span class="op">=</span> <span class="fl">68.20054</span>, Dmel__Cfrigida_v1.1 <span class="op">=</span> <span class="fl">72.50621</span>, 
`Dmel__Dalb_15112-1751.03v1` <span class="op">=</span> <span class="fl">80.26274</span>, Dmel__Dath_EB_1.0 <span class="op">=</span> <span class="fl">83.20431</span>, 
Dmel__Dbif_1.0 <span class="op">=</span> <span class="fl">82.25649</span>, Dmel__Dbus_ASM1175060v1 <span class="op">=</span> <span class="fl">80.08149</span>, 
Dmel__Dinn_ASM435438v2 <span class="op">=</span> <span class="fl">80.79603</span>, Dmel__Dlow_1.0 <span class="op">=</span> <span class="fl">83.56816</span>, 
Dmel__Dmau_ASM438214v1 <span class="op">=</span> <span class="fl">95.36722</span>, Dmel__Dmel_BDGP6 <span class="op">=</span> <span class="fl">100</span>, Dmel__Dmir_PacBio2.1 <span class="op">=</span> <span class="fl">84.10367</span>, 
Dmel__Dpse_MV25 <span class="op">=</span> <span class="fl">83.27086</span>, Dmel__Eten_idEriTena2.1 <span class="op">=</span> <span class="fl">70.18941</span>, 
Dmel__Paka_ASM1839793v1 <span class="op">=</span> <span class="fl">65.26859</span>, Dmel__Prin_Dyak_Tai18E2_2.0 <span class="op">=</span> <span class="fl">91.33685</span>, 
Dmel__RU_Dsub_v1.1 <span class="op">=</span> <span class="fl">88.09201</span>, Dmel__RU_Dtri_1.1 <span class="op">=</span> <span class="fl">86.06675</span>, 
Dpse__AaegL5.0 <span class="op">=</span> <span class="fl">67.05445</span>, Dpse__AalbS3_pri_1.0 <span class="op">=</span> <span class="fl">68.72562</span>, Dpse__Cfrigida_v1.1 <span class="op">=</span> <span class="fl">72.71335</span>, 
`Dpse__Dalb_15112-1751.03v1` <span class="op">=</span> <span class="fl">81.69273</span>, Dpse__Dath_EB_1.0 <span class="op">=</span> <span class="fl">91.50727</span>, 
Dpse__Dbif_1.0 <span class="op">=</span> <span class="fl">90.07924</span>, Dpse__Dbus_ASM1175060v1 <span class="op">=</span> <span class="fl">81.28797</span>, 
Dpse__Dinn_ASM435438v2 <span class="op">=</span> <span class="fl">81.96187</span>, Dpse__Dlow_1.0 <span class="op">=</span> <span class="fl">95.02922</span>, 
Dpse__Dmau_ASM438214v1 <span class="op">=</span> <span class="fl">85.43473</span>, Dpse__Dmel_BDGP6 <span class="op">=</span> <span class="fl">85.32083</span>, 
Dpse__Dmir_PacBio2.1 <span class="op">=</span> <span class="fl">97.38482</span>, Dpse__Dpse_MV25 <span class="op">=</span> <span class="fl">100</span>, Dpse__Eten_idEriTena2.1 <span class="op">=</span> <span class="fl">69.74893</span>, 
Dpse__Paka_ASM1839793v1 <span class="op">=</span> <span class="fl">64.9258</span>, Dpse__Prin_Dyak_Tai18E2_2.0 <span class="op">=</span> <span class="fl">84.58586</span>, 
Dpse__RU_Dsub_v1.1 <span class="op">=</span> <span class="fl">86.0418</span>, Dpse__RU_Dtri_1.1 <span class="op">=</span> <span class="fl">85.93798</span>, Dsub__AaegL5.0 <span class="op">=</span> <span class="fl">66.08828</span>, 
Dsub__AalbS3_pri_1.0 <span class="op">=</span> <span class="fl">68.42965</span>, Dsub__Cfrigida_v1.1 <span class="op">=</span> <span class="fl">71.28905</span>, 
`Dsub__Dalb_15112-1751.03v1` <span class="op">=</span> <span class="fl">80.48788</span>, Dsub__Dath_EB_1.0 <span class="op">=</span> <span class="fl">82.75689</span>, 
Dsub__Dbif_1.0 <span class="op">=</span> <span class="fl">83.14488</span>, Dsub__Dbus_ASM1175060v1 <span class="op">=</span> <span class="fl">80.4126</span>, 
Dsub__Dinn_ASM435438v2 <span class="op">=</span> <span class="fl">81.50499</span>, Dsub__Dlow_1.0 <span class="op">=</span> <span class="fl">84.02854</span>, 
Dsub__Dmau_ASM438214v1 <span class="op">=</span> <span class="fl">88.26478</span>, Dsub__Dmel_BDGP6 <span class="op">=</span> <span class="fl">87.81593</span>, 
Dsub__Dmir_PacBio2.1 <span class="op">=</span> <span class="fl">84.50135</span>, Dsub__Dpse_MV25 <span class="op">=</span> <span class="fl">82.88658</span>, 
Dsub__Eten_idEriTena2.1 <span class="op">=</span> <span class="fl">69.00946</span>, Dsub__Paka_ASM1839793v1 <span class="op">=</span> <span class="fl">64.88739</span>, 
Dsub__Prin_Dyak_Tai18E2_2.0 <span class="op">=</span> <span class="fl">87.79101</span>, Dsub__RU_Dsub_v1.1 <span class="op">=</span> <span class="fl">100</span>, 
Dsub__RU_Dtri_1.1 <span class="op">=</span> <span class="fl">87.23365</span>, Dyak__AaegL5.0 <span class="op">=</span> <span class="fl">65.96956</span>, Dyak__AalbS3_pri_1.0 <span class="op">=</span> <span class="fl">68.30608</span>, 
Dyak__Cfrigida_v1.1 <span class="op">=</span> <span class="fl">72.36378</span>, `Dyak__Dalb_15112-1751.03v1` <span class="op">=</span> <span class="fl">80.31928</span>, 
Dyak__Dath_EB_1.0 <span class="op">=</span> <span class="fl">82.77286</span>, Dyak__Dbif_1.0 <span class="op">=</span> <span class="fl">82.36289</span>, Dyak__Dbus_ASM1175060v1 <span class="op">=</span> <span class="fl">79.76272</span>, 
Dyak__Dinn_ASM435438v2 <span class="op">=</span> <span class="fl">80.83953</span>, Dyak__Dlow_1.0 <span class="op">=</span> <span class="fl">83.68068</span>, 
Dyak__Dmau_ASM438214v1 <span class="op">=</span> <span class="fl">91.8662</span>, Dyak__Dmel_BDGP6 <span class="op">=</span> <span class="fl">91.52635</span>, 
Dyak__Dmir_PacBio2.1 <span class="op">=</span> <span class="fl">84.21573</span>, Dyak__Dpse_MV25 <span class="op">=</span> <span class="fl">83.25226</span>, 
Dyak__Eten_idEriTena2.1 <span class="op">=</span> <span class="fl">70.75961</span>, Dyak__Paka_ASM1839793v1 <span class="op">=</span> <span class="fl">65.18495</span>, 
Dyak__Prin_Dyak_Tai18E2_2.0 <span class="op">=</span> <span class="fl">100</span>, Dyak__RU_Dsub_v1.1 <span class="op">=</span> <span class="fl">88.18683</span>, 
Dyak__RU_Dtri_1.1 <span class="op">=</span> <span class="fl">86.18934</span>, `OKI2018_I69_1.0__AOM-5-5f` <span class="op">=</span> <span class="fl">79.19197</span>, 
OKI2018_I69_1.0__Bar2_p4 <span class="op">=</span> <span class="fl">78.97216</span>, `OKI2018_I69_1.0__KUM-M3-7f` <span class="op">=</span> <span class="fl">96.6692</span>, 
OKI2018_I69_1.0__O_alb <span class="op">=</span> <span class="fl">69.58952</span>, OKI2018_I69_1.0__O_lon <span class="op">=</span> <span class="fl">65.9365</span>, 
OKI2018_I69_1.0__O_van <span class="op">=</span> <span class="fl">69.21153</span>, OKI2018_I69_1.0__OdB3 <span class="op">=</span> <span class="fl">78.80925</span>, 
OKI2018_I69_1.0__OKI2018_I69_1.0 <span class="op">=</span> <span class="fl">100</span>, OKI2018_I69_1.0__OSKA2016v1.9 <span class="op">=</span> <span class="fl">78.82942</span>, 
`OSKA2016v1.9__AOM-5-5f` <span class="op">=</span> <span class="fl">97.14968</span>, OSKA2016v1.9__Bar2_p4 <span class="op">=</span> <span class="fl">87.56705</span>, 
`OSKA2016v1.9__KUM-M3-7f` <span class="op">=</span> <span class="fl">78.52209</span>, OSKA2016v1.9__O_alb <span class="op">=</span> <span class="fl">68.88416</span>, 
OSKA2016v1.9__O_lon <span class="op">=</span> <span class="fl">66.94376</span>, OSKA2016v1.9__O_van <span class="op">=</span> <span class="fl">68.66089</span>, 
OSKA2016v1.9__OdB3 <span class="op">=</span> <span class="fl">87.51462</span>, OSKA2016v1.9__OKI2018_I69_1.0 <span class="op">=</span> <span class="fl">78.52812</span>, 
OSKA2016v1.9__OSKA2016v1.9 <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>

<span class="va">align_summary</span><span class="op">$</span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="va">sim</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span>
  <span class="st">"OKI2018_I69_1.0__OSKA2016v1.9"</span>,
  <span class="st">"OKI2018_I69_1.0__Bar2_p4"</span>,
  <span class="st">"OKI2018_I69_1.0__KUM-M3-7f"</span>,
  <span class="st">"OKI2018_I69_1.0__AOM-5-5f"</span>,
  <span class="st">"OKI2018_I69_1.0__OdB3"</span>,
  <span class="st">"OSKA2016v1.9__OKI2018_I69_1.0"</span>,
  <span class="st">"OSKA2016v1.9__Bar2_p4"</span>,
  <span class="st">"OSKA2016v1.9__KUM-M3-7f"</span>,
  <span class="st">"OSKA2016v1.9__AOM-5-5f"</span>,
  <span class="st">"OSKA2016v1.9__OdB3"</span>,
  <span class="st">"Bar2_p4__OKI2018_I69_1.0"</span>,
  <span class="st">"Bar2_p4__OSKA2016v1.9"</span>,
  <span class="st">"Bar2_p4__KUM-M3-7f"</span>,
  <span class="st">"Bar2_p4__AOM-5-5f"</span>,
  <span class="st">"Bar2_p4__OdB3"</span>,
  <span class="st">"C_int_P__C_int_R"</span>,
  <span class="st">"C_int_P__C_rob_HT"</span>,
  <span class="st">"C_int_P__C_sav"</span>,
  <span class="st">"C_int_P__OKI2018_I69_1.0"</span>,
  <span class="st">"C_rob_HT__C_int_R"</span>,
  <span class="st">"C_rob_HT__C_int_P"</span>,
  <span class="st">"C_rob_HT__C_sav"</span>,
  <span class="st">"C_rob_HT__OKI2018_I69_1.0"</span>,
  <span class="st">"Dmel__Dbus_ASM1175060v1"</span>,
  <span class="st">"Dmel__RU_Dsub_v1.1"</span>,
  <span class="st">"Dmel__Prin_Dyak_Tai18E2_2.0"</span>,
  <span class="st">"Dmel__Dmau_ASM438214v1"</span>
<span class="op">)</span><span class="op">]</span>

<span class="va">align_summary</span><span class="op">[</span><span class="st">"Hum_Mou"</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10.3264</span>, <span class="fl">54.39799</span>, <span class="cn">NA</span>, <span class="fl">75.20007</span><span class="op">)</span>

<span class="va">align_summary</span><span class="op">$</span><span class="va">pairname</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">align_summary</span><span class="op">)</span>
<span class="va">align_summary</span><span class="op">$</span><span class="va">dist</span> <span class="op">&lt;-</span> <span class="fu">OikScrambling</span><span class="fu">:::</span><span class="fu"><a href="../reference/compDistance.html">compDistance</a></span><span class="op">(</span><span class="va">align_summary</span><span class="op">$</span><span class="va">pairname</span><span class="op">)</span>
<span class="va">align_summary</span><span class="op">$</span><span class="va">genus</span> <span class="op">&lt;-</span> <span class="st">"Oikopleura"</span>
<span class="va">align_summary</span><span class="op">$</span><span class="va">genus</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Int"</span>, <span class="va">align_summary</span><span class="op">$</span><span class="va">dist</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Ciona"</span>
<span class="va">align_summary</span><span class="op">$</span><span class="va">genus</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Dme"</span>, <span class="va">align_summary</span><span class="op">$</span><span class="va">dist</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Drosophila"</span>
<span class="va">align_summary</span><span class="op">$</span><span class="va">genus</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Hum"</span>, <span class="va">align_summary</span><span class="op">$</span><span class="va">dist</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Mammalian"</span>

<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="va">align_summary</span>, <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"align_frac"</span>, <span class="st">"map_frac"</span>, <span class="st">"map2_frac"</span>, <span class="st">"sim"</span><span class="op">)</span><span class="op">)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"– Oki"</span>, <span class="va">df</span><span class="op">$</span><span class="va">dist</span><span class="op">)</span>,<span class="op">]</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">value</span>, <span class="va">name</span>, col<span class="op">=</span> <span class="va">genus</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">name</span>, ncol <span class="op">=</span> <span class="fl">1</span>, scale <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: Removed 1 rows containing missing values (geom_point).</span></code></pre>
<p><img src="LoadGenomicBreaks_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">align_summary</span> |&gt;
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"– Oki"</span>, <span class="va">dist</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">align_frac</span>, <span class="va">sim</span>, col<span class="op">=</span> <span class="va">genus</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">10</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="LoadGenomicBreaks_files/figure-html/unnamed-chunk-2-2.png" width="700"></p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">align_summary</span> |&gt;
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"– Oki"</span>, <span class="va">dist</span><span class="op">)</span><span class="op">)</span> |&gt;
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">map_frac</span>, <span class="va">sim</span>, col<span class="op">=</span> <span class="va">genus</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="LoadGenomicBreaks_files/figure-html/unnamed-chunk-2-3.png" width="700"></p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">genome_sizes</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Aom<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/GenomeInfoDb/man/seqinfo.html" class="external-link">seqlengths</a></span><span class="op">(</span><span class="va">genomes</span><span class="op">$</span><span class="va">Aom</span><span class="op">)</span><span class="op">)</span>, Bar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/GenomeInfoDb/man/seqinfo.html" class="external-link">seqlengths</a></span><span class="op">(</span><span class="va">genomes</span><span class="op">$</span><span class="va">Bar</span><span class="op">)</span><span class="op">)</span>,
                  Oki<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/GenomeInfoDb/man/seqinfo.html" class="external-link">seqlengths</a></span><span class="op">(</span><span class="va">genomes</span><span class="op">$</span><span class="va">Oki</span><span class="op">)</span><span class="op">)</span>, Osa<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/GenomeInfoDb/man/seqinfo.html" class="external-link">seqlengths</a></span><span class="op">(</span><span class="va">genomes</span><span class="op">$</span><span class="va">Osa</span><span class="op">)</span><span class="op">)</span>,
                  Kum<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/GenomeInfoDb/man/seqinfo.html" class="external-link">seqlengths</a></span><span class="op">(</span><span class="va">genomes</span><span class="op">$</span><span class="va">Kum</span><span class="op">)</span><span class="op">)</span>, Nor<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/GenomeInfoDb/man/seqinfo.html" class="external-link">seqlengths</a></span><span class="op">(</span><span class="va">genomes</span><span class="op">$</span><span class="va">Nor</span><span class="op">)</span><span class="op">)</span>,
                  Ply<span class="op">=</span><span class="fl">128639392</span>, Ros<span class="op">=</span><span class="fl">134327879</span>, Sav<span class="op">=</span><span class="fl">177003750</span>, Rob<span class="op">=</span><span class="fl">117529544</span>,
                  Dme<span class="op">=</span><span class="fl">137547960</span>, Dbu<span class="op">=</span><span class="fl">110837441</span>, Dsu<span class="op">=</span><span class="fl">130045071</span>, Dya<span class="op">=</span><span class="fl">136883712</span>
                  <span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">genome_sizes</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">coa</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>pat <span class="op">=</span> <span class="st">"_.*"</span>, rep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">]</span></code></pre></div>
<pre><code><span class="co">##       Oki       Oki       Oki       Oki       Oki       Osa       Osa       Osa </span>
<span class="co">##  64281565  64281565  64281565  64281565  64281565  56625162  56625162  56625162 </span>
<span class="co">##       Osa       Osa       Bar       Bar       Bar       Bar       Bar       Ply </span>
<span class="co">##  56625162  56625162  55793437  55793437  55793437  55793437  55793437 128639392 </span>
<span class="co">##       Ply       Ply       Ply       Rob       Rob       Rob       Rob       Dme </span>
<span class="co">## 128639392 128639392 128639392 117529544 117529544 117529544 117529544 137547960 </span>
<span class="co">##       Dme       Dme       Dme </span>
<span class="co">## 137547960 137547960 137547960</span></code></pre>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dens</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>
  nbreak   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">coa</span>, <span class="va">length</span><span class="op">)</span>,
  nbreak2  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">coa2</span>, <span class="va">length</span><span class="op">)</span>,
  gsize    <span class="op">=</span> <span class="va">genome_sizes</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">coa</span><span class="op">)</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>pat <span class="op">=</span> <span class="st">"_.*"</span>, rep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">]</span>,
  density  <span class="op">=</span> <span class="va">nbreak</span>  <span class="op">/</span> <span class="va">gsize</span> <span class="op">*</span> <span class="fl">1e6</span>,
  density2 <span class="op">=</span> <span class="va">nbreak2</span> <span class="op">/</span> <span class="va">gsize</span> <span class="op">*</span> <span class="fl">1e6</span>,
  pairname <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">coa</span><span class="op">)</span>,
  dist     <span class="op">=</span> <span class="fu">OikScrambling</span><span class="fu">:::</span><span class="fu"><a href="../reference/compDistance.html">compDistance</a></span><span class="op">(</span><span class="va">pairname</span><span class="op">)</span>,
  genus    <span class="op">=</span> <span class="va">dist</span> |&gt;
              <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>pat <span class="op">=</span> <span class="st">"Dme_.*"</span>, rep<span class="op">=</span><span class="st">"Drosophila"</span><span class="op">)</span> |&gt;
              <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>pat <span class="op">=</span> <span class="st">"Int.*"</span>,  rep<span class="op">=</span><span class="st">"Ciona"</span><span class="op">)</span> |&gt;
              <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span>pat <span class="op">=</span> <span class="st">".*[_–].*"</span>,  rep<span class="op">=</span><span class="st">"Oikopleura"</span><span class="op">)</span>
    
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1664</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dens</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">density</span>, <span class="va">genus</span>, col <span class="op">=</span> <span class="va">dist</span>, pch <span class="op">=</span> <span class="va">genus</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span><span class="st">"Density (breakpoints / megabase)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Density of breakpoints in paired comparisons, arranged per genus"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">rainbow</a></span><span class="op">(</span><span class="fl">11</span>, s<span class="op">=</span><span class="fl">.6</span>, v<span class="op">=</span><span class="fl">.9</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/Bimap-envirAPI.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">11</span>,<span class="fl">11</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="LoadGenomicBreaks_files/figure-html/breakpoints_per_Mb-1.png" width="700"></p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1664</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dens</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">density2</span>, <span class="va">genus</span>, col <span class="op">=</span> <span class="va">dist</span>, pch <span class="op">=</span> <span class="va">genus</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span><span class="st">"Density (breakpoints / megabase)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Density of breakpoints (double-coalesced) in paired comparisons, arranged per genus"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">rainbow</a></span><span class="op">(</span><span class="fl">11</span>, s<span class="op">=</span><span class="fl">.6</span>, v<span class="op">=</span><span class="fl">.9</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/Bimap-envirAPI.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">11</span>,<span class="fl">11</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="LoadGenomicBreaks_files/figure-html/breakpoints_per_Mb-2.png" width="700"></p>
</div>
</div>
<div class="section level1">
<h1 id="save-data">Save data<a class="anchor" aria-label="anchor" href="#save-data"></a>
</h1>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">gbs</span>, <span class="va">unal</span>, <span class="va">coa</span>, <span class="va">unmap</span>, <span class="va">unalMap</span>, <span class="va">tra</span>, <span class="va">tra2</span>, <span class="va">coa2</span>, <span class="va">unmap2</span>, <span class="va">wgo</span>, <span class="va">longShort</span>, file <span class="op">=</span> <span class="st">"BreakPoints.Rdata"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/system.html" class="external-link">system</a></span><span class="op">(</span><span class="st">"echo '9f273f099ecbfa44899b6c343d1382f1  BreakPoints.Rdata' | md5sum -c"</span>, intern <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning in system("echo '9f273f099ecbfa44899b6c343d1382f1 BreakPoints.Rdata'</span>
<span class="co">## | md5sum -c", : running command 'echo '9f273f099ecbfa44899b6c343d1382f1</span>
<span class="co">## BreakPoints.Rdata' | md5sum -c' had status 1</span></code></pre>
<pre><code><span class="co">## [1] "BreakPoints.Rdata: FAILED"</span>
<span class="co">## attr(,"status")</span>
<span class="co">## [1] 1</span></code></pre>
</div>
<div class="section level1">
<h1 id="session-information">Session information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h1>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## R version 4.1.2 (2021-11-01)</span>
<span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span>
<span class="co">## Running under: Debian GNU/Linux bookworm/sid</span>
<span class="co">## </span>
<span class="co">## Matrix products: default</span>
<span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0</span>
<span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0</span>
<span class="co">## </span>
<span class="co">## locale:</span>
<span class="co">##  [1] LC_CTYPE=en_GB.UTF-8       LC_NUMERIC=C              </span>
<span class="co">##  [3] LC_TIME=en_GB.UTF-8        LC_COLLATE=en_GB.UTF-8    </span>
<span class="co">##  [5] LC_MONETARY=en_GB.UTF-8    LC_MESSAGES=en_GB.UTF-8   </span>
<span class="co">##  [7] LC_PAPER=en_GB.UTF-8       LC_NAME=C                 </span>
<span class="co">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span>
<span class="co">## [11] LC_MEASUREMENT=en_GB.UTF-8 LC_IDENTIFICATION=C       </span>
<span class="co">## </span>
<span class="co">## attached base packages:</span>
<span class="co">## [1] stats4    stats     graphics  grDevices utils     datasets  methods  </span>
<span class="co">## [8] base     </span>
<span class="co">## </span>
<span class="co">## other attached packages:</span>
<span class="co">##  [1] BSgenome.Odioica.local.Odioica.reference.v3.0_1.0.1</span>
<span class="co">##  [2] BSgenome.Odioica.local.AOM.5_1.0.0                 </span>
<span class="co">##  [3] BSgenome.Odioica.local.KUM.M3_1.0.0                </span>
<span class="co">##  [4] BSgenome.Odioica.local.Bar2.p4_1.0.0               </span>
<span class="co">##  [5] BSgenome.Odioica.local.OSKA2016v1.9_1.0.0          </span>
<span class="co">##  [6] BSgenome.Odioica.local.OKI2018.I69_1.0.0           </span>
<span class="co">##  [7] BSgenome_1.62.0                                    </span>
<span class="co">##  [8] rtracklayer_1.54.0                                 </span>
<span class="co">##  [9] Biostrings_2.62.0                                  </span>
<span class="co">## [10] XVector_0.34.0                                     </span>
<span class="co">## [11] BreakpointsData_3.8.0                              </span>
<span class="co">## [12] ggplot2_3.3.5                                      </span>
<span class="co">## [13] GenomicBreaks_0.12.2                               </span>
<span class="co">## [14] GenomicRanges_1.46.1                               </span>
<span class="co">## [15] GenomeInfoDb_1.30.0                                </span>
<span class="co">## [16] IRanges_2.28.0                                     </span>
<span class="co">## [17] S4Vectors_0.32.3                                   </span>
<span class="co">## [18] BiocGenerics_0.40.0                                </span>
<span class="co">## </span>
<span class="co">## loaded via a namespace (and not attached):</span>
<span class="co">##   [1] backports_1.4.1             Hmisc_4.6-0                </span>
<span class="co">##   [3] BiocFileCache_2.2.0         systemfonts_1.0.3          </span>
<span class="co">##   [5] plyr_1.8.6                  splines_4.1.2              </span>
<span class="co">##   [7] BiocParallel_1.28.3         digest_0.6.29              </span>
<span class="co">##   [9] htmltools_0.5.2             tiff_0.1-10                </span>
<span class="co">##  [11] GO.db_3.14.0                gdata_2.18.0               </span>
<span class="co">##  [13] fansi_0.5.0                 magrittr_2.0.1             </span>
<span class="co">##  [15] checkmate_2.0.0             memoise_2.0.1              </span>
<span class="co">##  [17] cluster_2.1.2               tzdb_0.2.0                 </span>
<span class="co">##  [19] readr_2.1.1                 annotate_1.72.0            </span>
<span class="co">##  [21] matrixStats_0.61.0          R.utils_2.11.0             </span>
<span class="co">##  [23] pkgdown_2.0.1               prettyunits_1.1.1          </span>
<span class="co">##  [25] jpeg_0.1-9                  colorspace_2.0-2           </span>
<span class="co">##  [27] rappdirs_0.3.3              blob_1.2.2                 </span>
<span class="co">##  [29] textshaping_0.3.6           xfun_0.29                  </span>
<span class="co">##  [31] dplyr_1.0.7                 crayon_1.4.2               </span>
<span class="co">##  [33] RCurl_1.98-1.5              jsonlite_1.7.2             </span>
<span class="co">##  [35] lme4_1.1-27.1               survival_3.2-13            </span>
<span class="co">##  [37] glue_1.6.0                  gtable_0.3.0               </span>
<span class="co">##  [39] zlibbioc_1.40.0             DelayedArray_0.20.0        </span>
<span class="co">##  [41] weights_1.0.4               abind_1.4-5                </span>
<span class="co">##  [43] scales_1.1.1                DBI_1.1.2                  </span>
<span class="co">##  [45] Rcpp_1.0.7                  plotrix_3.8-2              </span>
<span class="co">##  [47] progress_1.2.2              genoPlotR_0.8.11           </span>
<span class="co">##  [49] xtable_1.8-4                htmlTable_2.3.0            </span>
<span class="co">##  [51] foreign_0.8-81              bit_4.0.4                  </span>
<span class="co">##  [53] Formula_1.2-4               htmlwidgets_1.5.4          </span>
<span class="co">##  [55] httr_1.4.2                  RColorBrewer_1.1-2         </span>
<span class="co">##  [57] ellipsis_0.3.2              mice_3.14.0                </span>
<span class="co">##  [59] farver_2.1.0                pkgconfig_2.0.3            </span>
<span class="co">##  [61] XML_3.99-0.8                R.methodsS3_1.8.1          </span>
<span class="co">##  [63] dbplyr_2.1.1                nnet_7.3-16                </span>
<span class="co">##  [65] sass_0.4.0                  locfit_1.5-9.4             </span>
<span class="co">##  [67] utf8_1.2.2                  labeling_0.4.2             </span>
<span class="co">##  [69] tidyselect_1.1.1            rlang_0.4.12               </span>
<span class="co">##  [71] reshape2_1.4.4              AnnotationDbi_1.56.2       </span>
<span class="co">##  [73] munsell_0.5.0               tools_4.1.2                </span>
<span class="co">##  [75] cachem_1.0.6                generics_0.1.1             </span>
<span class="co">##  [77] RSQLite_2.2.9               ade4_1.7-18                </span>
<span class="co">##  [79] broom_0.7.10                OikScrambling_0.8.2        </span>
<span class="co">##  [81] evaluate_0.14               stringr_1.4.0              </span>
<span class="co">##  [83] fastmap_1.1.0               fftwtools_0.9-11           </span>
<span class="co">##  [85] yaml_2.2.1                  ragg_1.2.1                 </span>
<span class="co">##  [87] knitr_1.37                  bit64_4.0.5                </span>
<span class="co">##  [89] fs_1.5.2                    purrr_0.3.4                </span>
<span class="co">##  [91] heatmaps_1.18.0             KEGGREST_1.34.0            </span>
<span class="co">##  [93] nlme_3.1-153                R.oo_1.24.0                </span>
<span class="co">##  [95] poweRlaw_0.70.6             xml2_1.3.3                 </span>
<span class="co">##  [97] pracma_2.3.6                biomaRt_2.50.1             </span>
<span class="co">##  [99] compiler_4.1.2              rstudioapi_0.13            </span>
<span class="co">## [101] filelock_1.0.2              curl_4.3.2                 </span>
<span class="co">## [103] png_0.1-7                   tibble_3.1.6               </span>
<span class="co">## [105] bslib_0.3.1                 stringi_1.7.6              </span>
<span class="co">## [107] highr_0.9                   GenomicFeatures_1.46.1     </span>
<span class="co">## [109] desc_1.4.0                  lattice_0.20-45            </span>
<span class="co">## [111] CNEr_1.30.0                 Matrix_1.4-0               </span>
<span class="co">## [113] nloptr_1.2.2.3              vctrs_0.3.8                </span>
<span class="co">## [115] pillar_1.6.4                lifecycle_1.0.1            </span>
<span class="co">## [117] jquerylib_0.1.4             data.table_1.14.2          </span>
<span class="co">## [119] bitops_1.0-7                R6_2.5.1                   </span>
<span class="co">## [121] BiocIO_1.4.0                latticeExtra_0.6-29        </span>
<span class="co">## [123] KernSmooth_2.23-20          gridExtra_2.3              </span>
<span class="co">## [125] boot_1.3-28                 MASS_7.3-54                </span>
<span class="co">## [127] gtools_3.9.2                assertthat_0.2.1           </span>
<span class="co">## [129] SummarizedExperiment_1.24.0 rprojroot_2.0.2            </span>
<span class="co">## [131] rjson_0.2.20                withr_2.4.3                </span>
<span class="co">## [133] GenomicAlignments_1.30.0    Rsamtools_2.10.0           </span>
<span class="co">## [135] GenomeInfoDbData_1.2.7      parallel_4.1.2             </span>
<span class="co">## [137] hms_1.1.1                   EBImage_4.36.0             </span>
<span class="co">## [139] grid_4.1.2                  rpart_4.1-15               </span>
<span class="co">## [141] minqa_1.2.4                 tidyr_1.1.4                </span>
<span class="co">## [143] rmarkdown_2.11              MatrixGenerics_1.6.0       </span>
<span class="co">## [145] Biobase_2.54.0              base64enc_0.1-3            </span>
<span class="co">## [147] restfulr_0.0.13</span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Aleksandra Bliznina, Michael Mansfield, Charles Plessy.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
